<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>PeMS 3, covariance features</title>

<script src="site_libs/header-attrs-2.28/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<script src="site_libs/clipboard-2.0.6/clipboard.min.js"></script>
<link href="site_libs/xaringanExtra-clipboard-0.2.6/xaringanExtra-clipboard.css" rel="stylesheet" />
<script src="site_libs/xaringanExtra-clipboard-0.2.6/xaringanExtra-clipboard.js"></script>
<script>window.xaringanExtraClipboard(null, {"button":"<i class=\"fa-solid fa-clipboard\" style=\"color: #00008B\"><\/i>","success":"<i class=\"fa fa-check\" style=\"color: #90BE6D\"><\/i>","error":"<i class=\"fa fa-times-circle\" style=\"color: #F94144\"><\/i>"})</script>
<link href="site_libs/font-awesome-6.4.2/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>


<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>

<style type="text/css">
/* for pandoc --citeproc since 2.11 */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">GWMF</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    PeMS
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="pems_repl1.html">PeMS 1</a>
    </li>
    <li>
      <a href="pems_repl2.html">PeMS 2</a>
    </li>
    <li>
      <a href="pems_repl3.html">PeMS 3</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Model Properties
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="model_properties1.html">Model Properties 1</a>
    </li>
    <li>
      <a href="model_properties2.html">Model Properties 2</a>
    </li>
  </ul>
</li>
<li>
  <a href="basis_functions.html">Basis Functions</a>
</li>
<li>
  <a href="approximation.html">Approximation</a>
</li>
<li>
  <a href="numerical_error.html">Numerical Error</a>
</li>
<li>
  <a href="convergence_rates.html">Convergence Rates</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/leninrafaelrierasegura/GWMF">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">PeMS 3, covariance features</h1>
<h4 class="date">Created: 05-07-2024. Last modified: 14-10-2024.</h4>

</div>


<style type="text/css">
body .main-container {
  max-width: 100% !important;
  width: 100% !important;
}
body {
  max-width: 100% !important;
}

body, td {
   font-size: 16px;
}
code.r{
  font-size: 14px;
}
pre {
  font-size: 14px
}
.custom-box {
  background-color: #f5f7fa; /* Light grey-blue background */
  border-color: #e1e8ed; /* Light border color */
  color: #2c3e50; /* Dark text color */
  padding: 15px; /* Padding inside the box */
  border-radius: 5px; /* Rounded corners */
  margin-bottom: 20px; /* Spacing below the box */
}
.caption {
  margin: auto;
  text-align: center;
  margin-bottom: 20px; /* Spacing below the box */
}
</style>
<p>Go back to the <a href="about.html">About page</a>.</p>
<p>This vignette uses the parameters stored in <a
href="https://github.com/leninrafaelrierasegura/GWMF/blob/main/data_files/pems_repl2_results.RData"><strong><code>pems_repl2_results.RData</code></strong></a>,
which was created in <a href="pems_repl2.html">pems_repl2.html</a>, to
compute some covariance features.</p>
<p>Let us set some global options for all code chunks in this
document.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="co"># Set seed for reproducibility</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1982</span>) </span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="co"># Set global options for all code chunks</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>  <span class="co"># Disable messages printed by R code chunks</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>  <span class="at">message =</span> <span class="cn">FALSE</span>,    </span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>  <span class="co"># Disable warnings printed by R code chunks</span></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>  <span class="at">warning =</span> <span class="cn">FALSE</span>,    </span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>  <span class="co"># Show R code within code chunks in output</span></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a>  <span class="at">echo =</span> <span class="cn">TRUE</span>,        </span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a>  <span class="co"># Include both R code and its results in output</span></span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a>  <span class="at">include =</span> <span class="cn">TRUE</span>,     </span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a>  <span class="co"># Evaluate R code chunks</span></span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a>  <span class="at">eval =</span> <span class="cn">TRUE</span>,       </span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a>  <span class="co"># Enable caching of R code chunks for faster rendering</span></span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a>  <span class="at">cache =</span> <span class="cn">FALSE</span>,      </span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a>  <span class="co"># Align figures in the center of the output</span></span>
<span id="cb1-18"><a href="#cb1-18" tabindex="-1"></a>  <span class="at">fig.align =</span> <span class="st">&quot;center&quot;</span>,</span>
<span id="cb1-19"><a href="#cb1-19" tabindex="-1"></a>  <span class="co"># Enable retina display for high-resolution figures</span></span>
<span id="cb1-20"><a href="#cb1-20" tabindex="-1"></a>  <span class="at">retina =</span> <span class="dv">2</span>,</span>
<span id="cb1-21"><a href="#cb1-21" tabindex="-1"></a>  <span class="co"># Show errors in the output instead of stopping rendering</span></span>
<span id="cb1-22"><a href="#cb1-22" tabindex="-1"></a>  <span class="at">error =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1-23"><a href="#cb1-23" tabindex="-1"></a>  <span class="co"># Do not collapse code and output into a single block</span></span>
<span id="cb1-24"><a href="#cb1-24" tabindex="-1"></a>  <span class="at">collapse =</span> <span class="cn">FALSE</span></span>
<span id="cb1-25"><a href="#cb1-25" tabindex="-1"></a>)</span></code></pre></div>
<p>Below we load the necessary libraries.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">library</span>(INLA)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="fu">library</span>(inlabru)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="fu">library</span>(rSPDE)</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="fu">library</span>(MetricGraph)</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a><span class="fu">library</span>(ggpubr) <span class="co">#annotate_figure()</span></span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a><span class="fu">library</span>(grid) <span class="co">#textGrob()</span></span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a><span class="fu">library</span>(ggmap)</span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a></span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a><span class="fu">library</span>(OpenStreetMap)</span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a></span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a></span>
<span id="cb2-21"><a href="#cb2-21" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb2-22"><a href="#cb2-22" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb2-23"><a href="#cb2-23" tabindex="-1"></a></span>
<span id="cb2-24"><a href="#cb2-24" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb2-25"><a href="#cb2-25" tabindex="-1"></a><span class="fu">library</span>(rmarkdown)</span>
<span id="cb2-26"><a href="#cb2-26" tabindex="-1"></a><span class="fu">library</span>(grateful) <span class="co"># Cite all loaded packages</span></span></code></pre></div>
<p>Below we define the function <code>captioner()</code> to generate
captions for the figures and the function
<code>process_model_results()</code> to extract the summary of the
parameters of the model.</p>
<p>Below we also define function <code>compute_pcr()</code>, which
computes the practical correlation. It receives the output of the <a
href="https://davidbolin.github.io/rSPDE/reference/spde.matern.operators.html"><code>rSPDE::spde.matern.operators()</code></a>
function (when evaluated on compatible parameters) and a threshold
<code>cor_threshold</code>. Using the correlation matrix and the
geodesic distance matrix, for each point in the mesh, it computes the
practical correlation range as the minimum geodesic distance such that
the correlation is below a given threshold <code>cor_threshold</code>
(usually defined as 0.1). The function returns a vector with the
practical correlation range for each point in the mesh.</p>
<div style="color: blue;">
<hr />
<p><strong>Press the Show button below to reveal the code.</strong></p>
<hr />
</div>
<div class="sourceCode" id="cb3"><pre
class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># Start the figure counter</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>fig_count <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="co"># Define the captioner function</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>captioner <span class="ot">&lt;-</span> <span class="cf">function</span>(caption) {</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>  fig_count <span class="ot">&lt;&lt;-</span> fig_count <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>  <span class="fu">paste0</span>(<span class="st">&quot;Figure &quot;</span>, fig_count, <span class="st">&quot;: &quot;</span>, caption)</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>}</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>process_model_results <span class="ot">&lt;-</span> <span class="cf">function</span>(fit, model) {</span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>  fit_spde <span class="ot">&lt;-</span> <span class="fu">rspde.result</span>(fit, <span class="st">&quot;field&quot;</span>, model, <span class="at">parameterization =</span> <span class="st">&quot;spde&quot;</span>)</span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a>  fit_matern <span class="ot">&lt;-</span> <span class="fu">rspde.result</span>(fit, <span class="st">&quot;field&quot;</span>, model, <span class="at">parameterization =</span> <span class="st">&quot;matern&quot;</span>)</span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a>  df_for_plot_spde <span class="ot">&lt;-</span> <span class="fu">gg_df</span>(fit_spde)</span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a>  df_for_plot_matern <span class="ot">&lt;-</span> <span class="fu">gg_df</span>(fit_matern)</span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a>  param_spde <span class="ot">&lt;-</span> <span class="fu">summary</span>(fit_spde)</span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a>  param_matern <span class="ot">&lt;-</span> <span class="fu">summary</span>(fit_matern)</span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a>  param_fixed <span class="ot">&lt;-</span> fit<span class="sc">$</span>summary.fixed[,<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>]</span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a>  marginal.posterior.sigma_e <span class="ot">=</span> <span class="fu">inla.tmarginal</span>(</span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a>    <span class="at">fun =</span> <span class="cf">function</span>(x) <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">/</span><span class="dv">2</span>), </span>
<span id="cb3-18"><a href="#cb3-18" tabindex="-1"></a>    <span class="at">marginal =</span> fit[[<span class="st">&quot;internal.marginals.hyperpar&quot;</span>]][[<span class="st">&quot;Log precision for the Gaussian observations&quot;</span>]])</span>
<span id="cb3-19"><a href="#cb3-19" tabindex="-1"></a>  quant.sigma_e <span class="ot">&lt;-</span> <span class="fu">capture.output</span>({result_tmp <span class="ot">&lt;-</span> <span class="fu">inla.zmarginal</span>(marginal.posterior.sigma_e)}, <span class="at">file =</span> <span class="st">&quot;/dev/null&quot;</span>) </span>
<span id="cb3-20"><a href="#cb3-20" tabindex="-1"></a>  quant.sigma_e <span class="ot">&lt;-</span> result_tmp</span>
<span id="cb3-21"><a href="#cb3-21" tabindex="-1"></a>  statistics.sigma_e <span class="ot">&lt;-</span> <span class="fu">unlist</span>(quant.sigma_e)[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">7</span>)]</span>
<span id="cb3-22"><a href="#cb3-22" tabindex="-1"></a>  mode.sigma_e <span class="ot">&lt;-</span> <span class="fu">inla.mmarginal</span>(marginal.posterior.sigma_e)</span>
<span id="cb3-23"><a href="#cb3-23" tabindex="-1"></a>  allparams <span class="ot">&lt;-</span> <span class="fu">rbind</span>(param_fixed, param_spde, param_matern, <span class="fu">c</span>(statistics.sigma_e, mode.sigma_e))</span>
<span id="cb3-24"><a href="#cb3-24" tabindex="-1"></a>  <span class="fu">rownames</span>(allparams)[<span class="fu">nrow</span>(allparams)] <span class="ot">&lt;-</span> <span class="st">&quot;sigma_e&quot;</span></span>
<span id="cb3-25"><a href="#cb3-25" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">allparams =</span> allparams, <span class="at">df_for_plot_spde =</span> df_for_plot_spde, <span class="at">df_for_plot_matern =</span> df_for_plot_matern))</span>
<span id="cb3-26"><a href="#cb3-26" tabindex="-1"></a>}</span>
<span id="cb3-27"><a href="#cb3-27" tabindex="-1"></a>compute_pcr <span class="ot">&lt;-</span> <span class="cf">function</span>(op, cor_threshold) {</span>
<span id="cb3-28"><a href="#cb3-28" tabindex="-1"></a>  <span class="co"># Compute the covariance matrix</span></span>
<span id="cb3-29"><a href="#cb3-29" tabindex="-1"></a>  cov_matrix <span class="ot">&lt;-</span> op<span class="sc">$</span><span class="fu">covariance_mesh</span>() </span>
<span id="cb3-30"><a href="#cb3-30" tabindex="-1"></a>  <span class="co"># Compute the correlation matrix</span></span>
<span id="cb3-31"><a href="#cb3-31" tabindex="-1"></a>  cor_matrix <span class="ot">&lt;-</span><span class="fu">cov2cor</span>(cov_matrix)</span>
<span id="cb3-32"><a href="#cb3-32" tabindex="-1"></a>  <span class="co"># Compute the geodesic distance matrix</span></span>
<span id="cb3-33"><a href="#cb3-33" tabindex="-1"></a>  op<span class="sc">$</span>graph<span class="sc">$</span><span class="fu">compute_geodist_mesh</span>() </span>
<span id="cb3-34"><a href="#cb3-34" tabindex="-1"></a>  <span class="co"># Extract the geodesic distance matrix</span></span>
<span id="cb3-35"><a href="#cb3-35" tabindex="-1"></a>  dist_matrix <span class="ot">&lt;-</span> op<span class="sc">$</span>graph<span class="sc">$</span>mesh<span class="sc">$</span>geo_dist </span>
<span id="cb3-36"><a href="#cb3-36" tabindex="-1"></a>  <span class="co"># Initialize the vector to store the practical correlation range</span></span>
<span id="cb3-37"><a href="#cb3-37" tabindex="-1"></a>  pcr <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">dim</span>(cor_matrix)[<span class="dv">1</span>]) </span>
<span id="cb3-38"><a href="#cb3-38" tabindex="-1"></a>  </span>
<span id="cb3-39"><a href="#cb3-39" tabindex="-1"></a>  process_row <span class="ot">&lt;-</span> <span class="cf">function</span>(row_index) {</span>
<span id="cb3-40"><a href="#cb3-40" tabindex="-1"></a>    <span class="co"># For each row_index, create an auxiliary matrix aux_mat with the correlation and geodesic distance</span></span>
<span id="cb3-41"><a href="#cb3-41" tabindex="-1"></a>    aux_mat <span class="ot">&lt;-</span> <span class="fu">cbind</span>(cor_matrix[row_index, ], dist_matrix[row_index, ]) </span>
<span id="cb3-42"><a href="#cb3-42" tabindex="-1"></a>    <span class="co"># Order the auxiliary matrix by the geodesic distance</span></span>
<span id="cb3-43"><a href="#cb3-43" tabindex="-1"></a>    ordered_aux_mat <span class="ot">&lt;-</span> aux_mat[<span class="fu">order</span>(aux_mat[, <span class="dv">2</span>]), ] </span>
<span id="cb3-44"><a href="#cb3-44" tabindex="-1"></a>    <span class="co"># Filter the auxiliary ordered matrix by the correlation threshold</span></span>
<span id="cb3-45"><a href="#cb3-45" tabindex="-1"></a>    filtered_aux_mat <span class="ot">&lt;-</span> ordered_aux_mat[ordered_aux_mat[,<span class="dv">1</span>] <span class="sc">&lt;</span> cor_threshold, ] </span>
<span id="cb3-46"><a href="#cb3-46" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(filtered_aux_mat) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb3-47"><a href="#cb3-47" tabindex="-1"></a>      <span class="co"># Return the minimum geodesic distance such that the correlation is below the threshold</span></span>
<span id="cb3-48"><a href="#cb3-48" tabindex="-1"></a>      <span class="fu">return</span>(filtered_aux_mat[<span class="dv">1</span>, <span class="dv">2</span>]) </span>
<span id="cb3-49"><a href="#cb3-49" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb3-50"><a href="#cb3-50" tabindex="-1"></a>      <span class="co"># If the condition is not satisfied, record the minimum correlation value and return an error message</span></span>
<span id="cb3-51"><a href="#cb3-51" tabindex="-1"></a>      min <span class="ot">&lt;-</span> <span class="fu">min</span>(aux_mat[, <span class="dv">1</span>])</span>
<span id="cb3-52"><a href="#cb3-52" tabindex="-1"></a>      <span class="fu">stop</span>(<span class="fu">paste0</span>(<span class="st">&quot;The condition cor_matrix[row_index, ] &lt; cor_threshold is not satisfied for row_index = &quot;</span>, </span>
<span id="cb3-53"><a href="#cb3-53" tabindex="-1"></a>                  row_index, <span class="st">&quot;. Increase cor_threshold. The minimum value of cor_matrix[row_index, ] is &quot;</span>,</span>
<span id="cb3-54"><a href="#cb3-54" tabindex="-1"></a>                  min))</span>
<span id="cb3-55"><a href="#cb3-55" tabindex="-1"></a>    }</span>
<span id="cb3-56"><a href="#cb3-56" tabindex="-1"></a>  }</span>
<span id="cb3-57"><a href="#cb3-57" tabindex="-1"></a>  </span>
<span id="cb3-58"><a href="#cb3-58" tabindex="-1"></a>  pcr <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(cor_matrix)[<span class="dv">1</span>], process_row)</span>
<span id="cb3-59"><a href="#cb3-59" tabindex="-1"></a>  </span>
<span id="cb3-60"><a href="#cb3-60" tabindex="-1"></a>  <span class="fu">return</span>(pcr)</span>
<span id="cb3-61"><a href="#cb3-61" tabindex="-1"></a>}</span></code></pre></div>
<p>We first load <code>pems_repl2_results.RData</code> (which contains a
list <code>list_to_save</code>) and extract its content.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># Load the data</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="fu">load</span>(<span class="fu">here</span>(<span class="st">&quot;data_files/pems_repl2_results.RData&quot;</span>))</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="co"># Extract its content</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>graph <span class="ot">&lt;-</span> list_to_save<span class="sc">$</span>graph</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>B.tau <span class="ot">&lt;-</span> list_to_save<span class="sc">$</span>B.tau</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>B.kappa <span class="ot">&lt;-</span> list_to_save<span class="sc">$</span>B.kappa</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="co"># Each of the objects below is a matrix with two columns, the first column is the mean and the second column is the mode</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="co"># Refer to pems_repl2.html for more details about their content</span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>mean_and_mode_params_statnu0<span class="fl">.5</span> <span class="ot">&lt;-</span> list_to_save<span class="sc">$</span>mean_and_mode_params_statnu0<span class="fl">.5</span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a>mean_and_mode_params_nonstatnu0<span class="fl">.5</span> <span class="ot">&lt;-</span> list_to_save<span class="sc">$</span>mean_and_mode_params_nonstatnu0<span class="fl">.5</span></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a>mean_and_mode_params_statnu1<span class="fl">.5</span> <span class="ot">&lt;-</span> list_to_save<span class="sc">$</span>mean_and_mode_params_statnu1<span class="fl">.5</span></span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a>mean_and_mode_params_nonstatnu1<span class="fl">.5</span> <span class="ot">&lt;-</span> list_to_save<span class="sc">$</span>mean_and_mode_params_nonstatnu1<span class="fl">.5</span></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a>mean_and_mode_params_statnuest <span class="ot">&lt;-</span> list_to_save<span class="sc">$</span>mean_and_mode_params_statnuest</span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a>mean_and_mode_params_nonstatnuest <span class="ot">&lt;-</span> list_to_save<span class="sc">$</span>mean_and_mode_params_nonstatnuest</span></code></pre></div>
<p>Below we define the correlation threshold to compute the practical
correlation range.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co"># Define correlation threshold</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>cor_threshold <span class="ot">&lt;-</span> <span class="fl">0.7</span> </span></code></pre></div>
<div id="case-nu-0.5" class="section level1">
<h1>Case <span class="math inline">\(\nu = 0.5\)</span></h1>
<p>Below we consider the parameters obtained for the stationary model
with <span class="math inline">\(\nu = 0.5\)</span>.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>tau_statnu0<span class="fl">.5</span> <span class="ot">&lt;-</span> mean_and_mode_params_statnu0<span class="fl">.5</span>[<span class="dv">3</span>,<span class="dv">1</span>]</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>kappa_statnu0<span class="fl">.5</span> <span class="ot">&lt;-</span> mean_and_mode_params_statnu0<span class="fl">.5</span>[<span class="dv">4</span>,<span class="dv">1</span>]</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>op_statnu0<span class="fl">.5</span> <span class="ot">&lt;-</span> rSPDE<span class="sc">::</span><span class="fu">matern.operators</span>(<span class="at">graph =</span> graph,</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>                                            <span class="at">parameterization =</span> <span class="st">&quot;spde&quot;</span>,</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>                                            <span class="at">tau =</span> tau_statnu0<span class="fl">.5</span>,</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>                                            <span class="at">kappa =</span> kappa_statnu0<span class="fl">.5</span>,</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>                                            <span class="at">alpha =</span> <span class="dv">1</span>)</span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a><span class="co"># Precision matrix</span></span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a>Q_statnu0<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">precision</span>(op_statnu0<span class="fl">.5</span>)</span></code></pre></div>
<pre><code>## Error in matern.operators(kappa = new_object$kappa, tau = new_object$tau, : unused argument (fem_mesh_matrices = new_object$fem_mesh_matrices)</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>est_sigma_statnu0<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(INLA<span class="sc">::</span><span class="fu">inla.qinv</span>(Q_statnu0<span class="fl">.5</span>))) </span></code></pre></div>
<pre><code>## Error in h(simpleError(msg, call)): error in evaluating the argument &#39;x&#39; in selecting a method for function &#39;diag&#39;: object &#39;Q_statnu0.5&#39; not found</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>est_range_statnu0<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">compute_pcr</span>(op_statnu0<span class="fl">.5</span>, cor_threshold)</span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="co"># Create a plot of the standard deviation</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>s <span class="ot">&lt;-</span> graph<span class="sc">$</span><span class="fu">plot_function</span>(<span class="at">X =</span> est_sigma_statnu0<span class="fl">.5</span>, <span class="at">vertex_size =</span> <span class="dv">0</span>, <span class="at">plotly =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Standard deviation&quot;</span>) <span class="sc">+</span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">&quot;Palatino&quot;</span>))</span></code></pre></div>
<pre><code>## Error in eval(expr, envir, enclos): object &#39;est_sigma_statnu0.5&#39; not found</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="co"># Create a plot of the practical correlation range</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>r <span class="ot">&lt;-</span> graph<span class="sc">$</span><span class="fu">plot_function</span>(<span class="at">X =</span> est_range_statnu0<span class="fl">.5</span>, <span class="at">vertex_size =</span> <span class="dv">0</span>, <span class="at">plotly =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Practical correlation range&quot;</span>) <span class="sc">+</span></span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">&quot;Palatino&quot;</span>))</span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>sr <span class="ot">&lt;-</span> s <span class="sc">+</span> r</span></code></pre></div>
<pre><code>## Error in eval(expr, envir, enclos): object &#39;s&#39; not found</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="fu">print</span>(sr)</span></code></pre></div>
<pre><code>## Error in h(simpleError(msg, call)): error in evaluating the argument &#39;x&#39; in selecting a method for function &#39;print&#39;: object &#39;sr&#39; not found</code></pre>
<p>Below we consider the parameters obtained for the non-stationary
model with <span class="math inline">\(\nu = 0.5\)</span>.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>theta_nonstatnu0<span class="fl">.5</span> <span class="ot">&lt;-</span> mean_and_mode_params_nonstatnu0<span class="fl">.5</span>[<span class="dv">3</span><span class="sc">:</span><span class="dv">6</span>,<span class="dv">1</span>]</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>op_nonstatnu0<span class="fl">.5</span> <span class="ot">&lt;-</span> rSPDE<span class="sc">::</span><span class="fu">spde.matern.operators</span>(<span class="at">graph =</span> graph,</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>                                            <span class="at">parameterization =</span> <span class="st">&quot;spde&quot;</span>,</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>                                            <span class="at">B.tau =</span> B.tau,</span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>                                            <span class="at">B.kappa =</span> B.kappa,</span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a>                                            <span class="at">theta =</span> theta_nonstatnu0<span class="fl">.5</span>,</span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a>                                            <span class="at">alpha =</span> <span class="dv">1</span>)</span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a></span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a></span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a><span class="co"># Precision matrix</span></span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a>Q_nonstatnu0<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">precision</span>(op_nonstatnu0<span class="fl">.5</span>)</span>
<span id="cb17-12"><a href="#cb17-12" tabindex="-1"></a>est_sigma_nonstatnu0<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(INLA<span class="sc">::</span><span class="fu">inla.qinv</span>(Q_nonstatnu0<span class="fl">.5</span>))) </span>
<span id="cb17-13"><a href="#cb17-13" tabindex="-1"></a>est_range_nonstatnu0<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">compute_pcr</span>(op_nonstatnu0<span class="fl">.5</span>, cor_threshold)</span>
<span id="cb17-14"><a href="#cb17-14" tabindex="-1"></a></span>
<span id="cb17-15"><a href="#cb17-15" tabindex="-1"></a>est_tau_nonstatnu0<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">exp</span>(B.tau[,<span class="sc">-</span><span class="dv">1</span>]<span class="sc">%*%</span>theta_nonstatnu0<span class="fl">.5</span>)</span>
<span id="cb17-16"><a href="#cb17-16" tabindex="-1"></a>est_kappa_nonstatnu0<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">exp</span>(B.kappa[,<span class="sc">-</span><span class="dv">1</span>]<span class="sc">%*%</span>theta_nonstatnu0<span class="fl">.5</span>)</span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="co"># Create a plot of the standard deviation</span></span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>s <span class="ot">&lt;-</span> graph<span class="sc">$</span><span class="fu">plot_function</span>(<span class="at">X =</span> est_sigma_nonstatnu0<span class="fl">.5</span>, <span class="at">vertex_size =</span> <span class="dv">0</span>, <span class="at">plotly =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Standard deviation&quot;</span>) <span class="sc">+</span></span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">&quot;Palatino&quot;</span>))</span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a><span class="co"># Create a plot of the practical correlation range</span></span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a>r <span class="ot">&lt;-</span> graph<span class="sc">$</span><span class="fu">plot_function</span>(<span class="at">X =</span> est_range_nonstatnu0<span class="fl">.5</span>, <span class="at">vertex_size =</span> <span class="dv">0</span>, <span class="at">plotly =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Practical correlation range&quot;</span>) <span class="sc">+</span></span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">&quot;Palatino&quot;</span>))</span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a>u <span class="ot">&lt;-</span> graph<span class="sc">$</span><span class="fu">plot_function</span>(<span class="at">X =</span> est_tau_nonstatnu0<span class="fl">.5</span>, <span class="at">vertex_size =</span> <span class="dv">0</span>, <span class="at">plotly =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Model for tau&quot;</span>) <span class="sc">+</span></span>
<span id="cb18-13"><a href="#cb18-13" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb18-14"><a href="#cb18-14" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">&quot;Palatino&quot;</span>))</span>
<span id="cb18-15"><a href="#cb18-15" tabindex="-1"></a><span class="co"># Create a plot of the practical correlation range</span></span>
<span id="cb18-16"><a href="#cb18-16" tabindex="-1"></a>k <span class="ot">&lt;-</span> graph<span class="sc">$</span><span class="fu">plot_function</span>(<span class="at">X =</span> est_kappa_nonstatnu0<span class="fl">.5</span>, <span class="at">vertex_size =</span> <span class="dv">0</span>, <span class="at">plotly =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb18-17"><a href="#cb18-17" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Model for kappa&quot;</span>) <span class="sc">+</span></span>
<span id="cb18-18"><a href="#cb18-18" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb18-19"><a href="#cb18-19" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">&quot;Palatino&quot;</span>))</span>
<span id="cb18-20"><a href="#cb18-20" tabindex="-1"></a>sruk <span class="ot">&lt;-</span> (s <span class="sc">+</span> r) <span class="sc">/</span> (u <span class="sc">+</span> k)</span>
<span id="cb18-21"><a href="#cb18-21" tabindex="-1"></a><span class="fu">print</span>(sruk)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="pems_repl3_files/figure-html/unnamed-chunk-10-1.png" alt="Figure 2: Standard deviation, practical correlation range, the model for tau, and the model for kappa for the non-stationary model with $\nu = 0.5$." width="885.12" />
<p class="caption">
Figure 2: Standard deviation, practical correlation range, the model for
tau, and the model for kappa for the non-stationary model with <span
class="math inline">\(\nu = 0.5\)</span>.
</p>
</div>
</div>
<div id="case-nu-1.5" class="section level1">
<h1>Case <span class="math inline">\(\nu = 1.5\)</span></h1>
<p>Below we consider the parameters obtained for the stationary model
with <span class="math inline">\(\nu = 1.5\)</span>.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>tau_statnu1<span class="fl">.5</span> <span class="ot">&lt;-</span> mean_and_mode_params_statnu1<span class="fl">.5</span>[<span class="dv">3</span>,<span class="dv">1</span>]</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>kappa_statnu1<span class="fl">.5</span> <span class="ot">&lt;-</span> mean_and_mode_params_statnu1<span class="fl">.5</span>[<span class="dv">4</span>,<span class="dv">1</span>]</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>op_statnu1<span class="fl">.5</span> <span class="ot">&lt;-</span> rSPDE<span class="sc">::</span><span class="fu">matern.operators</span>(<span class="at">graph =</span> graph,</span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a>                                        <span class="at">parameterization =</span> <span class="st">&quot;spde&quot;</span>,</span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a>                                        <span class="at">tau =</span> tau_statnu1<span class="fl">.5</span>,</span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a>                                        <span class="at">kappa =</span> kappa_statnu1<span class="fl">.5</span>,</span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a>                                        <span class="at">alpha =</span> <span class="dv">2</span>)</span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a></span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a></span>
<span id="cb19-10"><a href="#cb19-10" tabindex="-1"></a><span class="co"># Precision matrix</span></span>
<span id="cb19-11"><a href="#cb19-11" tabindex="-1"></a>Q_statnu1<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">precision</span>(op_statnu1<span class="fl">.5</span>)</span></code></pre></div>
<pre><code>## Error in matern.operators(kappa = new_object$kappa, tau = new_object$tau, : unused argument (fem_mesh_matrices = new_object$fem_mesh_matrices)</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>est_sigma_statnu1<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(INLA<span class="sc">::</span><span class="fu">inla.qinv</span>(Q_statnu1<span class="fl">.5</span>))) </span></code></pre></div>
<pre><code>## Error in h(simpleError(msg, call)): error in evaluating the argument &#39;x&#39; in selecting a method for function &#39;diag&#39;: object &#39;Q_statnu1.5&#39; not found</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a>est_range_statnu1<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">compute_pcr</span>(op_statnu1<span class="fl">.5</span>, cor_threshold)</span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="co"># Create a plot of the standard deviation</span></span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a>s <span class="ot">&lt;-</span> graph<span class="sc">$</span><span class="fu">plot_function</span>(<span class="at">X =</span> est_sigma_statnu1<span class="fl">.5</span>, <span class="at">vertex_size =</span> <span class="dv">0</span>, <span class="at">plotly =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Standard deviation&quot;</span>) <span class="sc">+</span></span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">&quot;Palatino&quot;</span>))</span></code></pre></div>
<pre><code>## Error in eval(expr, envir, enclos): object &#39;est_sigma_statnu1.5&#39; not found</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="co"># Create a plot of the practical correlation range</span></span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a>r <span class="ot">&lt;-</span> graph<span class="sc">$</span><span class="fu">plot_function</span>(<span class="at">X =</span> est_range_statnu1<span class="fl">.5</span>, <span class="at">vertex_size =</span> <span class="dv">0</span>, <span class="at">plotly =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Practical correlation range&quot;</span>) <span class="sc">+</span></span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">&quot;Palatino&quot;</span>))</span>
<span id="cb26-6"><a href="#cb26-6" tabindex="-1"></a>sr <span class="ot">&lt;-</span> s <span class="sc">+</span> r</span>
<span id="cb26-7"><a href="#cb26-7" tabindex="-1"></a><span class="fu">print</span>(sr)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="pems_repl3_files/figure-html/unnamed-chunk-12-1.png" alt="Figure 3: Standard deviation and practical correlation range for the stationary model with $\nu = 1.5$." width="885.12" />
<p class="caption">
Figure 3: Standard deviation and practical correlation range for the
stationary model with <span class="math inline">\(\nu = 1.5\)</span>.
</p>
</div>
<p>Below we consider the parameters obtained for the non-stationary
model with <span class="math inline">\(\nu = 1.5\)</span>.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a>theta_nonstatnu1<span class="fl">.5</span> <span class="ot">&lt;-</span> mean_and_mode_params_nonstatnu1<span class="fl">.5</span>[<span class="dv">3</span><span class="sc">:</span><span class="dv">6</span>,<span class="dv">1</span>]</span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a>op_nonstatnu1<span class="fl">.5</span> <span class="ot">&lt;-</span> rSPDE<span class="sc">::</span><span class="fu">spde.matern.operators</span>(<span class="at">graph =</span> graph,</span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a>                                                <span class="at">parameterization =</span> <span class="st">&quot;spde&quot;</span>,</span>
<span id="cb27-4"><a href="#cb27-4" tabindex="-1"></a>                                                <span class="at">B.tau =</span> B.tau,</span>
<span id="cb27-5"><a href="#cb27-5" tabindex="-1"></a>                                                <span class="at">B.kappa =</span> B.kappa,</span>
<span id="cb27-6"><a href="#cb27-6" tabindex="-1"></a>                                                <span class="at">theta =</span> theta_nonstatnu1<span class="fl">.5</span>,</span>
<span id="cb27-7"><a href="#cb27-7" tabindex="-1"></a>                                                <span class="at">alpha =</span> <span class="dv">2</span>)</span>
<span id="cb27-8"><a href="#cb27-8" tabindex="-1"></a></span>
<span id="cb27-9"><a href="#cb27-9" tabindex="-1"></a></span>
<span id="cb27-10"><a href="#cb27-10" tabindex="-1"></a><span class="co"># Precision matrix</span></span>
<span id="cb27-11"><a href="#cb27-11" tabindex="-1"></a>Q_nonstatnu1<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">precision</span>(op_nonstatnu1<span class="fl">.5</span>)</span>
<span id="cb27-12"><a href="#cb27-12" tabindex="-1"></a>est_sigma_nonstatnu1<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(INLA<span class="sc">::</span><span class="fu">inla.qinv</span>(Q_nonstatnu1<span class="fl">.5</span>))) </span>
<span id="cb27-13"><a href="#cb27-13" tabindex="-1"></a>est_range_nonstatnu1<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">compute_pcr</span>(op_nonstatnu1<span class="fl">.5</span>, cor_threshold)</span>
<span id="cb27-14"><a href="#cb27-14" tabindex="-1"></a></span>
<span id="cb27-15"><a href="#cb27-15" tabindex="-1"></a>est_tau_nonstatnu1<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">exp</span>(B.tau[,<span class="sc">-</span><span class="dv">1</span>]<span class="sc">%*%</span>theta_nonstatnu1<span class="fl">.5</span>)</span>
<span id="cb27-16"><a href="#cb27-16" tabindex="-1"></a>est_kappa_nonstatnu1<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">exp</span>(B.kappa[,<span class="sc">-</span><span class="dv">1</span>]<span class="sc">%*%</span>theta_nonstatnu1<span class="fl">.5</span>)</span></code></pre></div>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="co"># Create a plot of the standard deviation</span></span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a>s <span class="ot">&lt;-</span> graph<span class="sc">$</span><span class="fu">plot_function</span>(<span class="at">X =</span> est_sigma_nonstatnu1<span class="fl">.5</span>, <span class="at">vertex_size =</span> <span class="dv">0</span>, <span class="at">plotly =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Standard deviation&quot;</span>) <span class="sc">+</span></span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb28-5"><a href="#cb28-5" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">&quot;Palatino&quot;</span>))</span>
<span id="cb28-6"><a href="#cb28-6" tabindex="-1"></a><span class="co"># Create a plot of the practical correlation range</span></span>
<span id="cb28-7"><a href="#cb28-7" tabindex="-1"></a>r <span class="ot">&lt;-</span> graph<span class="sc">$</span><span class="fu">plot_function</span>(<span class="at">X =</span> est_range_nonstatnu1<span class="fl">.5</span>, <span class="at">vertex_size =</span> <span class="dv">0</span>, <span class="at">plotly =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb28-8"><a href="#cb28-8" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Practical correlation range&quot;</span>) <span class="sc">+</span></span>
<span id="cb28-9"><a href="#cb28-9" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb28-10"><a href="#cb28-10" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">&quot;Palatino&quot;</span>))</span>
<span id="cb28-11"><a href="#cb28-11" tabindex="-1"></a>u <span class="ot">&lt;-</span> graph<span class="sc">$</span><span class="fu">plot_function</span>(<span class="at">X =</span> est_tau_nonstatnu1<span class="fl">.5</span>, <span class="at">vertex_size =</span> <span class="dv">0</span>, <span class="at">plotly =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb28-12"><a href="#cb28-12" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Model for tau&quot;</span>) <span class="sc">+</span></span>
<span id="cb28-13"><a href="#cb28-13" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb28-14"><a href="#cb28-14" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">&quot;Palatino&quot;</span>))</span>
<span id="cb28-15"><a href="#cb28-15" tabindex="-1"></a><span class="co"># Create a plot of the practical correlation range</span></span>
<span id="cb28-16"><a href="#cb28-16" tabindex="-1"></a>k <span class="ot">&lt;-</span> graph<span class="sc">$</span><span class="fu">plot_function</span>(<span class="at">X =</span> est_kappa_nonstatnu1<span class="fl">.5</span>, <span class="at">vertex_size =</span> <span class="dv">0</span>, <span class="at">plotly =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb28-17"><a href="#cb28-17" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Model for kappa&quot;</span>) <span class="sc">+</span></span>
<span id="cb28-18"><a href="#cb28-18" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb28-19"><a href="#cb28-19" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">&quot;Palatino&quot;</span>))</span>
<span id="cb28-20"><a href="#cb28-20" tabindex="-1"></a>sruk <span class="ot">&lt;-</span> (s <span class="sc">+</span> r) <span class="sc">/</span> (u <span class="sc">+</span> k)</span>
<span id="cb28-21"><a href="#cb28-21" tabindex="-1"></a><span class="fu">print</span>(sruk)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="pems_repl3_files/figure-html/unnamed-chunk-14-1.png" alt="Figure 4: Standard deviation, practical correlation range, the model for tau, and the model for kappa for the non-stationary model with $\nu = 1.5$." width="885.12" />
<p class="caption">
Figure 4: Standard deviation, practical correlation range, the model for
tau, and the model for kappa for the non-stationary model with <span
class="math inline">\(\nu = 1.5\)</span>.
</p>
</div>
</div>
<div id="case-nu-estimated" class="section level1">
<h1>Case <span class="math inline">\(\nu\)</span> estimated</h1>
<p>Below we consider the parameters obtained for the stationary model
with <span class="math inline">\(\nu\)</span> estimated.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a>tau_statnuest <span class="ot">&lt;-</span> mean_and_mode_params_statnuest[<span class="dv">3</span>,<span class="dv">1</span>]</span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a>kappa_statnuest <span class="ot">&lt;-</span> mean_and_mode_params_statnuest[<span class="dv">4</span>,<span class="dv">1</span>]</span>
<span id="cb29-3"><a href="#cb29-3" tabindex="-1"></a>nu_statnuest <span class="ot">&lt;-</span> mean_and_mode_params_statnuest[<span class="dv">5</span>,<span class="dv">1</span>]</span>
<span id="cb29-4"><a href="#cb29-4" tabindex="-1"></a>op_statnuest <span class="ot">&lt;-</span> rSPDE<span class="sc">::</span><span class="fu">matern.operators</span>(<span class="at">graph =</span> graph,</span>
<span id="cb29-5"><a href="#cb29-5" tabindex="-1"></a>                                        <span class="at">parameterization =</span> <span class="st">&quot;spde&quot;</span>,</span>
<span id="cb29-6"><a href="#cb29-6" tabindex="-1"></a>                                        <span class="at">tau =</span> tau_statnuest,</span>
<span id="cb29-7"><a href="#cb29-7" tabindex="-1"></a>                                        <span class="at">kappa =</span> kappa_statnuest,</span>
<span id="cb29-8"><a href="#cb29-8" tabindex="-1"></a>                                        <span class="at">alpha =</span> <span class="fl">0.5</span> <span class="sc">+</span> nu_statnuest)</span>
<span id="cb29-9"><a href="#cb29-9" tabindex="-1"></a></span>
<span id="cb29-10"><a href="#cb29-10" tabindex="-1"></a></span>
<span id="cb29-11"><a href="#cb29-11" tabindex="-1"></a><span class="co"># Precision matrix</span></span>
<span id="cb29-12"><a href="#cb29-12" tabindex="-1"></a>Q_statnuest <span class="ot">&lt;-</span> <span class="fu">precision</span>(op_statnuest)</span></code></pre></div>
<pre><code>## Error in matern.operators(kappa = new_object$kappa, tau = new_object$tau, : unused argument (fem_mesh_matrices = new_object$fem_mesh_matrices)</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a>est_sigma_statnuest <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(INLA<span class="sc">::</span><span class="fu">inla.qinv</span>(Q_statnuest))) </span></code></pre></div>
<pre><code>## Error in h(simpleError(msg, call)): error in evaluating the argument &#39;x&#39; in selecting a method for function &#39;diag&#39;: object &#39;Q_statnuest&#39; not found</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a>est_range_statnuest <span class="ot">&lt;-</span> <span class="fu">compute_pcr</span>(op_statnuest, cor_threshold)</span></code></pre></div>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a><span class="co"># Create a plot of the standard deviation</span></span>
<span id="cb34-2"><a href="#cb34-2" tabindex="-1"></a>s <span class="ot">&lt;-</span> graph<span class="sc">$</span><span class="fu">plot_function</span>(<span class="at">X =</span> est_sigma_statnuest, <span class="at">vertex_size =</span> <span class="dv">0</span>, <span class="at">plotly =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb34-3"><a href="#cb34-3" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Standard deviation&quot;</span>) <span class="sc">+</span></span>
<span id="cb34-4"><a href="#cb34-4" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb34-5"><a href="#cb34-5" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">&quot;Palatino&quot;</span>))</span></code></pre></div>
<pre><code>## Error in eval(expr, envir, enclos): object &#39;est_sigma_statnuest&#39; not found</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a><span class="co"># Create a plot of the practical correlation range</span></span>
<span id="cb36-2"><a href="#cb36-2" tabindex="-1"></a>r <span class="ot">&lt;-</span> graph<span class="sc">$</span><span class="fu">plot_function</span>(<span class="at">X =</span> est_range_statnuest, <span class="at">vertex_size =</span> <span class="dv">0</span>, <span class="at">plotly =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb36-3"><a href="#cb36-3" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Practical correlation range&quot;</span>) <span class="sc">+</span></span>
<span id="cb36-4"><a href="#cb36-4" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb36-5"><a href="#cb36-5" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">&quot;Palatino&quot;</span>))</span>
<span id="cb36-6"><a href="#cb36-6" tabindex="-1"></a>sr <span class="ot">&lt;-</span> s <span class="sc">+</span> r</span>
<span id="cb36-7"><a href="#cb36-7" tabindex="-1"></a><span class="fu">print</span>(sr)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="pems_repl3_files/figure-html/unnamed-chunk-16-1.png" alt="Figure 5: Standard deviation and practical correlation range for the stationary model with $\nu$ estimated." width="885.12" />
<p class="caption">
Figure 5: Standard deviation and practical correlation range for the
stationary model with <span class="math inline">\(\nu\)</span>
estimated.
</p>
</div>
<p>Below we consider the parameters obtained for the non-stationary
model with <span class="math inline">\(\nu = est\)</span>.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a>theta_nonstatnuest <span class="ot">&lt;-</span> mean_and_mode_params_nonstatnuest[<span class="dv">3</span><span class="sc">:</span><span class="dv">6</span>,<span class="dv">1</span>]</span>
<span id="cb37-2"><a href="#cb37-2" tabindex="-1"></a>nu_nonstatnuest <span class="ot">&lt;-</span> mean_and_mode_params_nonstatnuest[<span class="dv">7</span>,<span class="dv">1</span>]</span>
<span id="cb37-3"><a href="#cb37-3" tabindex="-1"></a>op_nonstatnuest <span class="ot">&lt;-</span> rSPDE<span class="sc">::</span><span class="fu">spde.matern.operators</span>(<span class="at">graph =</span> graph,</span>
<span id="cb37-4"><a href="#cb37-4" tabindex="-1"></a>                                                <span class="at">parameterization =</span> <span class="st">&quot;spde&quot;</span>,</span>
<span id="cb37-5"><a href="#cb37-5" tabindex="-1"></a>                                                <span class="at">B.tau =</span> B.tau,</span>
<span id="cb37-6"><a href="#cb37-6" tabindex="-1"></a>                                                <span class="at">B.kappa =</span> B.kappa,</span>
<span id="cb37-7"><a href="#cb37-7" tabindex="-1"></a>                                                <span class="at">theta =</span> theta_nonstatnuest,</span>
<span id="cb37-8"><a href="#cb37-8" tabindex="-1"></a>                                                <span class="at">alpha =</span> <span class="fl">0.5</span> <span class="sc">+</span> nu_nonstatnuest)</span>
<span id="cb37-9"><a href="#cb37-9" tabindex="-1"></a></span>
<span id="cb37-10"><a href="#cb37-10" tabindex="-1"></a></span>
<span id="cb37-11"><a href="#cb37-11" tabindex="-1"></a><span class="co"># Precision matrix</span></span>
<span id="cb37-12"><a href="#cb37-12" tabindex="-1"></a>Q_nonstatnuest <span class="ot">&lt;-</span> <span class="fu">precision</span>(op_nonstatnuest)</span>
<span id="cb37-13"><a href="#cb37-13" tabindex="-1"></a>est_sigma_nonstatnuest <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(INLA<span class="sc">::</span><span class="fu">inla.qinv</span>(Q_nonstatnuest))) </span>
<span id="cb37-14"><a href="#cb37-14" tabindex="-1"></a>est_range_nonstatnuest <span class="ot">&lt;-</span> <span class="fu">compute_pcr</span>(op_nonstatnuest, cor_threshold)</span></code></pre></div>
<pre><code>## Error in .solve.checkCondBound(a@U, tol): &#39;a&#39; is computationally singular, min(d)/max(d)=3.53039e-17, d=abs(diag(U))</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a>est_tau_nonstatnuest <span class="ot">&lt;-</span> <span class="fu">exp</span>(B.tau[,<span class="sc">-</span><span class="dv">1</span>]<span class="sc">%*%</span>theta_nonstatnuest)</span>
<span id="cb39-2"><a href="#cb39-2" tabindex="-1"></a>est_kappa_nonstatnuest <span class="ot">&lt;-</span> <span class="fu">exp</span>(B.kappa[,<span class="sc">-</span><span class="dv">1</span>]<span class="sc">%*%</span>theta_nonstatnuest)</span></code></pre></div>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" tabindex="-1"></a><span class="co"># Create a plot of the standard deviation</span></span>
<span id="cb40-2"><a href="#cb40-2" tabindex="-1"></a>s <span class="ot">&lt;-</span> graph<span class="sc">$</span><span class="fu">plot_function</span>(<span class="at">X =</span> est_sigma_nonstatnuest, <span class="at">vertex_size =</span> <span class="dv">0</span>, <span class="at">plotly =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb40-3"><a href="#cb40-3" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Standard deviation&quot;</span>) <span class="sc">+</span></span>
<span id="cb40-4"><a href="#cb40-4" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb40-5"><a href="#cb40-5" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">&quot;Palatino&quot;</span>))</span></code></pre></div>
<pre><code>## Error in graph$plot_function(X = est_sigma_nonstatnuest, vertex_size = 0, : X does not have the correct size (the possible sizes are 9007, 9698 and 9698)</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" tabindex="-1"></a><span class="co"># Create a plot of the practical correlation range</span></span>
<span id="cb42-2"><a href="#cb42-2" tabindex="-1"></a>r <span class="ot">&lt;-</span> graph<span class="sc">$</span><span class="fu">plot_function</span>(<span class="at">X =</span> est_range_nonstatnuest, <span class="at">vertex_size =</span> <span class="dv">0</span>, <span class="at">plotly =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb42-3"><a href="#cb42-3" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Practical correlation range&quot;</span>) <span class="sc">+</span></span>
<span id="cb42-4"><a href="#cb42-4" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb42-5"><a href="#cb42-5" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">&quot;Palatino&quot;</span>))</span></code></pre></div>
<pre><code>## Error in eval(expr, envir, enclos): object &#39;est_range_nonstatnuest&#39; not found</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" tabindex="-1"></a>u <span class="ot">&lt;-</span> graph<span class="sc">$</span><span class="fu">plot_function</span>(<span class="at">X =</span> est_tau_nonstatnuest, <span class="at">vertex_size =</span> <span class="dv">0</span>, <span class="at">plotly =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb44-2"><a href="#cb44-2" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Model for tau&quot;</span>) <span class="sc">+</span></span>
<span id="cb44-3"><a href="#cb44-3" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb44-4"><a href="#cb44-4" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">&quot;Palatino&quot;</span>))</span>
<span id="cb44-5"><a href="#cb44-5" tabindex="-1"></a><span class="co"># Create a plot of the practical correlation range</span></span>
<span id="cb44-6"><a href="#cb44-6" tabindex="-1"></a>k <span class="ot">&lt;-</span> graph<span class="sc">$</span><span class="fu">plot_function</span>(<span class="at">X =</span> est_kappa_nonstatnuest, <span class="at">vertex_size =</span> <span class="dv">0</span>, <span class="at">plotly =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb44-7"><a href="#cb44-7" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Model for kappa&quot;</span>) <span class="sc">+</span></span>
<span id="cb44-8"><a href="#cb44-8" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb44-9"><a href="#cb44-9" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">&quot;Palatino&quot;</span>))</span>
<span id="cb44-10"><a href="#cb44-10" tabindex="-1"></a>sruk <span class="ot">&lt;-</span> (s <span class="sc">+</span> r) <span class="sc">/</span> (u <span class="sc">+</span> k)</span>
<span id="cb44-11"><a href="#cb44-11" tabindex="-1"></a><span class="fu">print</span>(sruk)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="pems_repl3_files/figure-html/unnamed-chunk-18-1.png" alt="Figure 6: Standard deviation, practical correlation range, the model for tau, and the model for kappa for the non-stationary model with $\nu$ estimated." width="885.12" />
<p class="caption">
Figure 6: Standard deviation, practical correlation range, the model for
tau, and the model for kappa for the non-stationary model with <span
class="math inline">\(\nu\)</span> estimated.
</p>
</div>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a>list_pems_repl3 <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">est_sigma_statnu0.5 =</span> est_sigma_statnu0<span class="fl">.5</span>,</span>
<span id="cb45-2"><a href="#cb45-2" tabindex="-1"></a>                        <span class="at">est_range_statnu0.5 =</span> est_range_statnu0<span class="fl">.5</span>,</span>
<span id="cb45-3"><a href="#cb45-3" tabindex="-1"></a>                        <span class="at">est_sigma_nonstatnu0.5 =</span> est_sigma_nonstatnu0<span class="fl">.5</span>,</span>
<span id="cb45-4"><a href="#cb45-4" tabindex="-1"></a>                        <span class="at">est_range_nonstatnu0.5 =</span> est_range_nonstatnu0<span class="fl">.5</span>,</span>
<span id="cb45-5"><a href="#cb45-5" tabindex="-1"></a>                        <span class="at">est_tau_nonstatnu0.5 =</span> est_tau_nonstatnu0<span class="fl">.5</span>,</span>
<span id="cb45-6"><a href="#cb45-6" tabindex="-1"></a>                        <span class="at">est_kappa_nonstatnu0.5 =</span> est_kappa_nonstatnu0<span class="fl">.5</span>,</span>
<span id="cb45-7"><a href="#cb45-7" tabindex="-1"></a>                        <span class="at">est_sigma_statnu1.5 =</span> est_sigma_statnu1<span class="fl">.5</span>,</span>
<span id="cb45-8"><a href="#cb45-8" tabindex="-1"></a>                        <span class="at">est_range_statnu1.5 =</span> est_range_statnu1<span class="fl">.5</span>,</span>
<span id="cb45-9"><a href="#cb45-9" tabindex="-1"></a>                        <span class="at">est_sigma_nonstatnu1.5 =</span> est_sigma_nonstatnu1<span class="fl">.5</span>,</span>
<span id="cb45-10"><a href="#cb45-10" tabindex="-1"></a>                        <span class="at">est_range_nonstatnu1.5 =</span> est_range_nonstatnu1<span class="fl">.5</span>,</span>
<span id="cb45-11"><a href="#cb45-11" tabindex="-1"></a>                        <span class="at">est_tau_nonstatnu1.5 =</span> est_tau_nonstatnu1<span class="fl">.5</span>,</span>
<span id="cb45-12"><a href="#cb45-12" tabindex="-1"></a>                        <span class="at">est_kappa_nonstatnu1.5 =</span> est_kappa_nonstatnu1<span class="fl">.5</span>,</span>
<span id="cb45-13"><a href="#cb45-13" tabindex="-1"></a>                        <span class="at">est_sigma_statnuest =</span> est_sigma_statnuest,</span>
<span id="cb45-14"><a href="#cb45-14" tabindex="-1"></a>                        <span class="at">est_range_statnuest =</span> est_range_statnuest,</span>
<span id="cb45-15"><a href="#cb45-15" tabindex="-1"></a>                        <span class="at">est_sigma_nonstatnuest =</span> est_sigma_nonstatnuest,</span>
<span id="cb45-16"><a href="#cb45-16" tabindex="-1"></a>                        <span class="at">est_range_nonstatnuest =</span> est_range_nonstatnuest,</span>
<span id="cb45-17"><a href="#cb45-17" tabindex="-1"></a>                        <span class="at">est_tau_nonstatnuest =</span> est_tau_nonstatnuest,</span>
<span id="cb45-18"><a href="#cb45-18" tabindex="-1"></a>                        <span class="at">est_kappa_nonstatnuest =</span> est_kappa_nonstatnuest,</span>
<span id="cb45-19"><a href="#cb45-19" tabindex="-1"></a>                        <span class="at">graph =</span> graph)</span></code></pre></div>
<pre><code>## Error in eval(expr, envir, enclos): object &#39;est_sigma_statnu0.5&#39; not found</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" tabindex="-1"></a><span class="co"># Save the results</span></span>
<span id="cb47-2"><a href="#cb47-2" tabindex="-1"></a><span class="fu">save</span>(list_pems_repl3, <span class="at">file =</span> <span class="fu">here</span>(<span class="st">&quot;data_files/pems_repl3_results.RData&quot;</span>))</span></code></pre></div>
<pre><code>## Error in save(list_pems_repl3, file = here(&quot;data_files/pems_repl3_results.RData&quot;)): object &#39;list_pems_repl3&#39; not found</code></pre>
</div>
<div id="references" class="section level1">
<h1>References</h1>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" tabindex="-1"></a><span class="fu">cite_packages</span>(<span class="at">output =</span> <span class="st">&quot;paragraph&quot;</span>, <span class="at">out.dir =</span> <span class="st">&quot;.&quot;</span>)</span></code></pre></div>
<p>We used R version 4.4.1 <span class="citation">(R Core Team
2024)</span> and the following R packages: cowplot v. 1.1.3 <span
class="citation">(Wilke 2024)</span>, ggmap v. 4.0.0.900 <span
class="citation">(Kahle and Wickham 2013)</span>, ggpubr v. 0.6.0 <span
class="citation">(Kassambara 2023)</span>, ggtext v. 0.1.2 <span
class="citation">(Wilke and Wiernik 2022)</span>, here v. 1.0.1 <span
class="citation">(Mller 2020)</span>, htmltools v. 0.5.8.1 <span
class="citation">(Cheng et al. 2024)</span>, INLA v. 24.10.7.2 <span
class="citation">(Rue, Martino, and Chopin 2009; Lindgren, Rue, and
Lindstrm 2011; Martins et al. 2013; Lindgren and Rue 2015; De Coninck
et al. 2016; Rue et al. 2017; Verbosio et al. 2017; Bakka et al. 2018;
Kourounis, Fuchs, and Schenk 2018)</span>, inlabru v. 2.11.1.9004 <span
class="citation">(Yuan et al. 2017; Bachl et al. 2019)</span>, knitr v.
1.48 <span class="citation">(Xie 2014, 2015, 2024)</span>, latex2exp v.
0.9.6 <span class="citation">(Meschiari 2022)</span>, Matrix v. 1.6.5
<span class="citation">(Bates, Maechler, and Jagan 2024)</span>,
MetricGraph v. 1.3.0.9000 <span class="citation">(Bolin, Simas, and
Wallin 2023b, 2023a, 2023c, 2024; Bolin et al. 2024)</span>,
OpenStreetMap v. 0.4.0 <span class="citation">(Fellows and JMapViewer
library by Jan Peter Stotz 2023)</span>, patchwork v. 1.2.0 <span
class="citation">(Pedersen 2024)</span>, plotly v. 4.10.4 <span
class="citation">(Sievert 2020)</span>, plotrix v. 3.8.4 <span
class="citation">(J 2006)</span>, reshape2 v. 1.4.4 <span
class="citation">(Wickham 2007)</span>, rmarkdown v. 2.28 <span
class="citation">(Xie, Allaire, and Grolemund 2018; Xie, Dervieux, and
Riederer 2020; Allaire et al. 2024)</span>, rSPDE v. 2.3.3.9000 <span
class="citation">(Bolin and Kirchner 2020; Bolin and Simas 2023; Bolin,
Simas, and Xiong 2024)</span>, scales v. 1.3.0 <span
class="citation">(Wickham, Pedersen, and Seidel 2023)</span>, sf v.
1.0.17 <span class="citation">(Pebesma 2018; Pebesma and Bivand
2023)</span>, tidyverse v. 2.0.0 <span class="citation">(Wickham et al.
2019)</span>, viridis v. 0.6.4 <span class="citation">(Garnier et al.
2023)</span>, xaringanExtra v. 0.8.0 <span class="citation">(Aden-Buie
and Warkentin 2024)</span>.</p>
<div id="refs" class="references csl-bib-body hanging-indent"
entry-spacing="0">
<div id="ref-xaringanExtra" class="csl-entry">
Aden-Buie, Garrick, and Matthew T. Warkentin. 2024. <em><span
class="nocase">xaringanExtra</span>: Extras and Extensions for
<span><span class="nocase">xaringan</span></span> Slides</em>. <a
href="https://CRAN.R-project.org/package=xaringanExtra">https://CRAN.R-project.org/package=xaringanExtra</a>.
</div>
<div id="ref-rmarkdown2024" class="csl-entry">
Allaire, JJ, Yihui Xie, Christophe Dervieux, Jonathan McPherson, Javier
Luraschi, Kevin Ushey, Aron Atkins, et al. 2024. <em><span
class="nocase">rmarkdown</span>: Dynamic Documents for r</em>. <a
href="https://github.com/rstudio/rmarkdown">https://github.com/rstudio/rmarkdown</a>.
</div>
<div id="ref-inlabru2019" class="csl-entry">
Bachl, Fabian E., Finn Lindgren, David L. Borchers, and Janine B.
Illian. 2019. <span><span class="nocase">inlabru</span>: An
<span>R</span> Package for <span>Bayesian</span> Spatial Modelling from
Ecological Survey Data.</span> <em>Methods in Ecology and
Evolution</em> 10: 76066. <a
href="https://doi.org/10.1111/2041-210X.13168">https://doi.org/10.1111/2041-210X.13168</a>.
</div>
<div id="ref-INLA2018f" class="csl-entry">
Bakka, Haakon, Hvard Rue, Geir-Arne Fuglstad, Andrea I. Riebler, David
Bolin, Janine Illian, Elias Krainski, Daniel P. Simpson, and Finn K.
Lindgren. 2018. <span>Spatial Modelling with <span>INLA</span>:
<span>A</span> Review.</span> <em>WIRES (Invited Extended Review)</em>
xx (Feb): xx. <a
href="http://arxiv.org/abs/1802.06350">http://arxiv.org/abs/1802.06350</a>.
</div>
<div id="ref-Matrix" class="csl-entry">
Bates, Douglas, Martin Maechler, and Mikael Jagan. 2024.
<em><span>Matrix</span>: Sparse and Dense Matrix Classes and
Methods</em>. <a
href="https://CRAN.R-project.org/package=Matrix">https://CRAN.R-project.org/package=Matrix</a>.
</div>
<div id="ref-rSPDE2020" class="csl-entry">
Bolin, David, and Kristin Kirchner. 2020. <span>The Rational
<span>SPDE</span> Approach for <span>Gaussian</span> Random Fields with
General Smoothness.</span> <em>Journal of Computational and Graphical
Statistics</em> 29 (2): 27485. <a
href="https://doi.org/10.1080/10618600.2019.1665537">https://doi.org/10.1080/10618600.2019.1665537</a>.
</div>
<div id="ref-MetricGraph2024c" class="csl-entry">
Bolin, David, Mihly Kovcs, Vivek Kumar, and Alexandre B. Simas. 2024.
<span>Regularity and Numerical Approximation of Fractional Elliptic
Differential Equations on Compact Metric Graphs.</span> <em>Mathematics
of Computation</em> 93 (349): 243972. <a
href="https://doi.org/10.1090/mcom/3929">https://doi.org/10.1090/mcom/3929</a>.
</div>
<div id="ref-rSPDE2023" class="csl-entry">
Bolin, David, and Alexandre B. Simas. 2023. <em><span
class="nocase">rSPDE</span>: Rational Approximations of Fractional
Stochastic Partial Differential Equations</em>. <a
href="https://CRAN.R-project.org/package=rSPDE">https://CRAN.R-project.org/package=rSPDE</a>.
</div>
<div id="ref-MetricGraph2023d" class="csl-entry">
Bolin, David, Alexandre B. Simas, and Jonas Wallin. 2023a. <span>Markov
Properties of Gaussian Random Fields on Compact Metric Graphs.</span>
<em>arXiv Preprint arXiv:2304.03190</em>. <a
href="https://doi.org/10.48550/arXiv.2304.03190">https://doi.org/10.48550/arXiv.2304.03190</a>.
</div>
<div id="ref-MetricGraph2023a" class="csl-entry">
. 2023b. <em><span>MetricGraph</span>: Random Fields on Metric
Graphs</em>. <a
href="https://CRAN.R-project.org/package=MetricGraph">https://CRAN.R-project.org/package=MetricGraph</a>.
</div>
<div id="ref-MetricGraph2023e" class="csl-entry">
. 2023c. <span>Statistical Inference for Gaussian Whittle-Matrn
Fields on Metric Graphs.</span> <em>arXiv Preprint
arXiv:2304.10372</em>. <a
href="https://doi.org/10.48550/arXiv.2304.10372">https://doi.org/10.48550/arXiv.2304.10372</a>.
</div>
<div id="ref-MetricGraph2024b" class="csl-entry">
. 2024. <span>Gaussian Whittle-Matrn Fields on Metric
Graphs.</span> <em>Bernoulli</em> 30 (2): 161139. <a
href="https://doi.org/10.3150/23-BEJ1647">https://doi.org/10.3150/23-BEJ1647</a>.
</div>
<div id="ref-rSPDE2024" class="csl-entry">
Bolin, David, Alexandre B. Simas, and Zhen Xiong. 2024.
<span>Covariance-Based Rational Approximations of Fractional SPDEs for
Computationally Efficient Bayesian Inference.</span> <em>Journal of
Computational and Graphical Statistics</em> 33 (1): 6474. <a
href="https://doi.org/10.1080/10618600.2023.2231051">https://doi.org/10.1080/10618600.2023.2231051</a>.
</div>
<div id="ref-htmltools" class="csl-entry">
Cheng, Joe, Carson Sievert, Barret Schloerke, Winston Chang, Yihui Xie,
and Jeff Allen. 2024. <em><span class="nocase">htmltools</span>: Tools
for HTML</em>. <a
href="https://CRAN.R-project.org/package=htmltools">https://CRAN.R-project.org/package=htmltools</a>.
</div>
<div id="ref-INLA2016g" class="csl-entry">
De Coninck, Arne, Bernard De Baets, Drosos Kourounis, Fabio Verbosio,
Olaf Schenk, Steven Maenhout, and Jan Fostier. 2016.
<span><span>Needles</span>: Toward Large-Scale Genomic Prediction with
Marker-by-Environment Interaction.</span> <em>Genetics</em> 203 (1):
54355. <a
href="https://doi.org/10.1534/genetics.115.179887">https://doi.org/10.1534/genetics.115.179887</a>.
</div>
<div id="ref-OpenStreetMap" class="csl-entry">
Fellows, Ian, and using the JMapViewer library by Jan Peter Stotz. 2023.
<em><span>OpenStreetMap</span>: Access to Open Street Map Raster
Images</em>. <a
href="https://CRAN.R-project.org/package=OpenStreetMap">https://CRAN.R-project.org/package=OpenStreetMap</a>.
</div>
<div id="ref-viridis" class="csl-entry">
Garnier, Simon, Ross, Noam, Rudis, Robert, Camargo, et al. 2023.
<em><span class="nocase">viridis(Lite)</span> - Colorblind-Friendly
Color Maps for r</em>. <a
href="https://doi.org/10.5281/zenodo.4679423">https://doi.org/10.5281/zenodo.4679423</a>.
</div>
<div id="ref-plotrix" class="csl-entry">
J, Lemon. 2006. <span><span>Plotrix</span>: A Package in the Red Light
District of r.</span> <em>R-News</em> 6 (4): 812.
</div>
<div id="ref-ggmap" class="csl-entry">
Kahle, David, and Hadley Wickham. 2013. <span><span
class="nocase">ggmap</span>: Spatial Visualization with Ggplot2.</span>
<em>The R Journal</em> 5 (1): 14461. <a
href="https://journal.r-project.org/archive/2013-1/kahle-wickham.pdf">https://journal.r-project.org/archive/2013-1/kahle-wickham.pdf</a>.
</div>
<div id="ref-ggpubr" class="csl-entry">
Kassambara, Alboukadel. 2023. <em><span class="nocase">ggpubr</span>:
<span><span class="nocase">ggplot2</span></span> Based Publication
Ready Plots</em>. <a
href="https://CRAN.R-project.org/package=ggpubr">https://CRAN.R-project.org/package=ggpubr</a>.
</div>
<div id="ref-INLA2018i" class="csl-entry">
Kourounis, D., A. Fuchs, and O. Schenk. 2018. <span>Towards the Next
Generation of Multiperiod Optimal Power Flow Solvers.</span> <em>IEEE
Transactions on Power Systems</em> PP (99): 110. <a
href="https://doi.org/10.1109/TPWRS.2017.2789187">https://doi.org/10.1109/TPWRS.2017.2789187</a>.
</div>
<div id="ref-INLA2015d" class="csl-entry">
Lindgren, Finn, and Hvard Rue. 2015. <span>Bayesian Spatial Modelling
with <span>R</span>-<span>INLA</span>.</span> <em>Journal of
Statistical Software</em> 63 (19): 125. <a
href="http://www.jstatsoft.org/v63/i19/">http://www.jstatsoft.org/v63/i19/</a>.
</div>
<div id="ref-INLA2011c" class="csl-entry">
Lindgren, Finn, Hvard Rue, and Johan Lindstrm. 2011. <span>An
Explicit Link Between <span>Gaussian</span> Fields and
<span>Gaussian</span> <span>Markov</span> Random Fields: The Stochastic
Partial Differential Equation Approach (with Discussion).</span>
<em>Journal of the Royal Statistical Society B</em> 73 (4): 42398.
</div>
<div id="ref-INLA2013b" class="csl-entry">
Martins, Thiago G., Daniel Simpson, Finn Lindgren, and Hvard Rue. 2013.
<span>Bayesian Computing with <span>INLA</span>: <span>N</span>ew
Features.</span> <em>Computational Statistics and Data Analysis</em>
67: 6883.
</div>
<div id="ref-latex2exp" class="csl-entry">
Meschiari, Stefano. 2022. <em>Latex2exp: Use LaTeX Expressions in
Plots</em>. <a
href="https://CRAN.R-project.org/package=latex2exp">https://CRAN.R-project.org/package=latex2exp</a>.
</div>
<div id="ref-here" class="csl-entry">
Mller, Kirill. 2020. <em><span class="nocase">here</span>: A Simpler
Way to Find Your Files</em>. <a
href="https://CRAN.R-project.org/package=here">https://CRAN.R-project.org/package=here</a>.
</div>
<div id="ref-sf2018" class="csl-entry">
Pebesma, Edzer. 2018. <span><span class="nocase">Simple Features for R:
Standardized Support for Spatial Vector Data</span>.</span>
<em><span>The R Journal</span></em> 10 (1): 43946. <a
href="https://doi.org/10.32614/RJ-2018-009">https://doi.org/10.32614/RJ-2018-009</a>.
</div>
<div id="ref-sf2023" class="csl-entry">
Pebesma, Edzer, and Roger Bivand. 2023. <em><span class="nocase">Spatial
Data Science: With applications in R</span></em>. <span>Chapman and
Hall/CRC</span>. <a
href="https://doi.org/10.1201/9780429459016">https://doi.org/10.1201/9780429459016</a>.
</div>
<div id="ref-patchwork" class="csl-entry">
Pedersen, Thomas Lin. 2024. <em><span class="nocase">patchwork</span>:
The Composer of Plots</em>. <a
href="https://CRAN.R-project.org/package=patchwork">https://CRAN.R-project.org/package=patchwork</a>.
</div>
<div id="ref-base" class="csl-entry">
R Core Team. 2024. <em><span>R</span>: A Language and Environment for
Statistical Computing</em>. Vienna, Austria: R Foundation for
Statistical Computing. <a
href="https://www.R-project.org/">https://www.R-project.org/</a>.
</div>
<div id="ref-INLA2009a" class="csl-entry">
Rue, Hvard, Sara Martino, and Nicholas Chopin. 2009. <span>Approximate
<span>Bayesian</span> Inference for Latent <span>Gaussian</span> Models
Using Integrated Nested <span>Laplace</span> Approximations (with
Discussion).</span> <em>Journal of the Royal Statistical Society B</em>
71: 31992.
</div>
<div id="ref-INLA2017e" class="csl-entry">
Rue, Hvard, Andrea I. Riebler, Sigrunn H. Srbye, Janine B. Illian,
Daniel P. Simpson, and Finn K. Lindgren. 2017. <span>Bayesian Computing
with <span>INLA</span>: <span>A</span> Review.</span> <em>Annual
Reviews of Statistics and Its Applications</em> 4 (March): 395421. <a
href="http://arxiv.org/abs/1604.00860">http://arxiv.org/abs/1604.00860</a>.
</div>
<div id="ref-plotly" class="csl-entry">
Sievert, Carson. 2020. <em>Interactive Web-Based Data Visualization with
r, Plotly, and Shiny</em>. Chapman; Hall/CRC. <a
href="https://plotly-r.com">https://plotly-r.com</a>.
</div>
<div id="ref-INLA2017h" class="csl-entry">
Verbosio, Fabio, Arne De Coninck, Drosos Kourounis, and Olaf Schenk.
2017. <span>Enhancing the Scalability of Selected Inversion
Factorization Algorithms in Genomic Prediction.</span> <em>Journal of
Computational Science</em> 22 (Supplement C): 99108. <a
href="https://doi.org/10.1016/j.jocs.2017.08.013">https://doi.org/10.1016/j.jocs.2017.08.013</a>.
</div>
<div id="ref-reshape2" class="csl-entry">
Wickham, Hadley. 2007. <span>Reshaping Data with the <span
class="nocase">reshape</span> Package.</span> <em>Journal of
Statistical Software</em> 21 (12): 120. <a
href="http://www.jstatsoft.org/v21/i12/">http://www.jstatsoft.org/v21/i12/</a>.
</div>
<div id="ref-tidyverse" class="csl-entry">
Wickham, Hadley, Mara Averick, Jennifer Bryan, Winston Chang, Lucy
DAgostino McGowan, Romain Franois, Garrett Grolemund, et al. 2019.
<span>Welcome to the <span class="nocase">tidyverse</span>.</span>
<em>Journal of Open Source Software</em> 4 (43): 1686. <a
href="https://doi.org/10.21105/joss.01686">https://doi.org/10.21105/joss.01686</a>.
</div>
<div id="ref-scales" class="csl-entry">
Wickham, Hadley, Thomas Lin Pedersen, and Dana Seidel. 2023. <em><span
class="nocase">scales</span>: Scale Functions for Visualization</em>. <a
href="https://CRAN.R-project.org/package=scales">https://CRAN.R-project.org/package=scales</a>.
</div>
<div id="ref-cowplot" class="csl-entry">
Wilke, Claus O. 2024. <em><span class="nocase">cowplot</span>:
Streamlined Plot Theme and Plot Annotations for <span><span
class="nocase">ggplot2</span></span></em>. <a
href="https://CRAN.R-project.org/package=cowplot">https://CRAN.R-project.org/package=cowplot</a>.
</div>
<div id="ref-ggtext" class="csl-entry">
Wilke, Claus O., and Brenton M. Wiernik. 2022. <em><span
class="nocase">ggtext</span>: Improved Text Rendering Support for
<span><span class="nocase">ggplot2</span></span></em>. <a
href="https://CRAN.R-project.org/package=ggtext">https://CRAN.R-project.org/package=ggtext</a>.
</div>
<div id="ref-knitr2014" class="csl-entry">
Xie, Yihui. 2014. <span><span class="nocase">knitr</span>: A
Comprehensive Tool for Reproducible Research in <span>R</span>.</span>
In <em>Implementing Reproducible Computational Research</em>, edited by
Victoria Stodden, Friedrich Leisch, and Roger D. Peng. Chapman;
Hall/CRC.
</div>
<div id="ref-knitr2015" class="csl-entry">
. 2015. <em>Dynamic Documents with <span>R</span> and Knitr</em>. 2nd
ed. Boca Raton, Florida: Chapman; Hall/CRC. <a
href="https://yihui.org/knitr/">https://yihui.org/knitr/</a>.
</div>
<div id="ref-knitr2024" class="csl-entry">
. 2024. <em><span class="nocase">knitr</span>: A General-Purpose
Package for Dynamic Report Generation in r</em>. <a
href="https://yihui.org/knitr/">https://yihui.org/knitr/</a>.
</div>
<div id="ref-rmarkdown2018" class="csl-entry">
Xie, Yihui, J. J. Allaire, and Garrett Grolemund. 2018. <em>R Markdown:
The Definitive Guide</em>. Boca Raton, Florida: Chapman; Hall/CRC. <a
href="https://bookdown.org/yihui/rmarkdown">https://bookdown.org/yihui/rmarkdown</a>.
</div>
<div id="ref-rmarkdown2020" class="csl-entry">
Xie, Yihui, Christophe Dervieux, and Emily Riederer. 2020. <em>R
Markdown Cookbook</em>. Boca Raton, Florida: Chapman; Hall/CRC. <a
href="https://bookdown.org/yihui/rmarkdown-cookbook">https://bookdown.org/yihui/rmarkdown-cookbook</a>.
</div>
<div id="ref-inlabru2017" class="csl-entry">
Yuan, Yuan, Bachl, Fabian E., Lindgren, Finn, Borchers, et al. 2017.
<span>Point Process Models for Spatio-Temporal Distance Sampling Data
from a Large-Scale Survey of Blue Whales.</span> <em>Ann. Appl.
Stat.</em> 11 (4): 227097. <a
href="https://doi.org/10.1214/17-AOAS1078">https://doi.org/10.1214/17-AOAS1078</a>.
</div>
</div>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiUGVNUyAzLCBjb3ZhcmlhbmNlIGZlYXR1cmVzIgpkYXRlOiAiQ3JlYXRlZDogMDUtMDctMjAyNC4gTGFzdCBtb2RpZmllZDogYHIgZm9ybWF0KFN5cy50aW1lKCksICclZC0lbS0lWS4nKWAiCm91dHB1dDoKICBodG1sX2RvY3VtZW50OgogICAgbWF0aGpheDogImh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9ucG0vbWF0aGpheEAzL2VzNS90ZXgtbW1sLWNodG1sLmpzIgogICAgaGlnaGxpZ2h0OiBweWdtZW50cwogICAgdGhlbWU6IGZsYXRseQogICAgY29kZV9mb2xkaW5nOiBzaG93ICMgY2xhc3Muc291cmNlID0gImZvbGQtaGlkZSIgdG8gaGlkZSBjb2RlIGFuZCBhZGQgYSBidXR0b24gdG8gc2hvdyBpdAogICAgZGZfcHJpbnQ6IHBhZ2VkCiAgICB0b2M6IHRydWUKICAgIHRvY19mbG9hdDoKICAgICAgY29sbGFwc2VkOiB0cnVlCiAgICAgIHNtb290aF9zY3JvbGw6IHRydWUKICAgIG51bWJlcl9zZWN0aW9uczogZmFsc2UKICAgIGZpZ19jYXB0aW9uOiB0cnVlCiAgICBjb2RlX2Rvd25sb2FkOiB0cnVlCmFsd2F5c19hbGxvd19odG1sOiB0cnVlCmJpYmxpb2dyYXBoeTogCiAgLSByZWZlcmVuY2VzLmJpYgogIC0gZ3JhdGVmdWwtcmVmcy5iaWIKaGVhZGVyLWluY2x1ZGVzOgogIC0gXG5ld2NvbW1hbmR7XGFyfXtcbWF0aGJie1J9fQogIC0gXG5ld2NvbW1hbmR7XGxsYXZ9WzFde1xsZWZ0XHsjMVxyaWdodFx9fQogIC0gXG5ld2NvbW1hbmR7XHBhcmV9WzFde1xsZWZ0KCMxXHJpZ2h0KX0KICAtIFxuZXdjb21tYW5ke1xOY2FsfXtcbWF0aGNhbHtOfX0KICAtIFxuZXdjb21tYW5ke1xWY2FsfXtcbWF0aGNhbHtWfX0KICAtIFxuZXdjb21tYW5ke1xFY2FsfXtcbWF0aGNhbHtFfX0KICAtIFxuZXdjb21tYW5ke1xXY2FsfXtcbWF0aGNhbHtXfX0KLS0tCgpgYGB7ciB4YXJpbmdhbkV4dHJhLWNsaXBib2FyZCwgZWNobyA9IEZBTFNFfQpodG1sdG9vbHM6OnRhZ0xpc3QoCiAgeGFyaW5nYW5FeHRyYTo6dXNlX2NsaXBib2FyZCgKICAgIGJ1dHRvbl90ZXh0ID0gIjxpIGNsYXNzPVwiZmEtc29saWQgZmEtY2xpcGJvYXJkXCIgc3R5bGU9XCJjb2xvcjogIzAwMDA4QlwiPjwvaT4iLAogICAgc3VjY2Vzc190ZXh0ID0gIjxpIGNsYXNzPVwiZmEgZmEtY2hlY2tcIiBzdHlsZT1cImNvbG9yOiAjOTBCRTZEXCI+PC9pPiIsCiAgICBlcnJvcl90ZXh0ID0gIjxpIGNsYXNzPVwiZmEgZmEtdGltZXMtY2lyY2xlXCIgc3R5bGU9XCJjb2xvcjogI0Y5NDE0NFwiPjwvaT4iCiAgKSwKICBybWFya2Rvd246Omh0bWxfZGVwZW5kZW5jeV9mb250X2F3ZXNvbWUoKQopCmBgYAoKCmBgYHtjc3MsIGVjaG8gPSBGQUxTRX0KYm9keSAubWFpbi1jb250YWluZXIgewogIG1heC13aWR0aDogMTAwJSAhaW1wb3J0YW50OwogIHdpZHRoOiAxMDAlICFpbXBvcnRhbnQ7Cn0KYm9keSB7CiAgbWF4LXdpZHRoOiAxMDAlICFpbXBvcnRhbnQ7Cn0KCmJvZHksIHRkIHsKICAgZm9udC1zaXplOiAxNnB4Owp9CmNvZGUucnsKICBmb250LXNpemU6IDE0cHg7Cn0KcHJlIHsKICBmb250LXNpemU6IDE0cHgKfQouY3VzdG9tLWJveCB7CiAgYmFja2dyb3VuZC1jb2xvcjogI2Y1ZjdmYTsgLyogTGlnaHQgZ3JleS1ibHVlIGJhY2tncm91bmQgKi8KICBib3JkZXItY29sb3I6ICNlMWU4ZWQ7IC8qIExpZ2h0IGJvcmRlciBjb2xvciAqLwogIGNvbG9yOiAjMmMzZTUwOyAvKiBEYXJrIHRleHQgY29sb3IgKi8KICBwYWRkaW5nOiAxNXB4OyAvKiBQYWRkaW5nIGluc2lkZSB0aGUgYm94ICovCiAgYm9yZGVyLXJhZGl1czogNXB4OyAvKiBSb3VuZGVkIGNvcm5lcnMgKi8KICBtYXJnaW4tYm90dG9tOiAyMHB4OyAvKiBTcGFjaW5nIGJlbG93IHRoZSBib3ggKi8KfQouY2FwdGlvbiB7CiAgbWFyZ2luOiBhdXRvOwogIHRleHQtYWxpZ246IGNlbnRlcjsKICBtYXJnaW4tYm90dG9tOiAyMHB4OyAvKiBTcGFjaW5nIGJlbG93IHRoZSBib3ggKi8KfQpgYGAKCgpHbyBiYWNrIHRvIHRoZSBbQWJvdXQgcGFnZV0oYWJvdXQuaHRtbCkuIAoKClRoaXMgdmlnbmV0dGUgdXNlcyB0aGUgcGFyYW1ldGVycyBzdG9yZWQgaW4gWyoqYHBlbXNfcmVwbDJfcmVzdWx0cy5SRGF0YWAqKl0oaHR0cHM6Ly9naXRodWIuY29tL2xlbmlucmFmYWVscmllcmFzZWd1cmEvR1dNRi9ibG9iL21haW4vZGF0YV9maWxlcy9wZW1zX3JlcGwyX3Jlc3VsdHMuUkRhdGEpLCB3aGljaCB3YXMgY3JlYXRlZCBpbiBbcGVtc19yZXBsMi5odG1sXShwZW1zX3JlcGwyLmh0bWwpLCB0byBjb21wdXRlIHNvbWUgY292YXJpYW5jZSBmZWF0dXJlcy4KCkxldCB1cyBzZXQgc29tZSBnbG9iYWwgb3B0aW9ucyBmb3IgYWxsIGNvZGUgY2h1bmtzIGluIHRoaXMgZG9jdW1lbnQuCgoKYGBge3J9CiMgU2V0IHNlZWQgZm9yIHJlcHJvZHVjaWJpbGl0eQpzZXQuc2VlZCgxOTgyKSAKIyBTZXQgZ2xvYmFsIG9wdGlvbnMgZm9yIGFsbCBjb2RlIGNodW5rcwprbml0cjo6b3B0c19jaHVuayRzZXQoCiAgIyBEaXNhYmxlIG1lc3NhZ2VzIHByaW50ZWQgYnkgUiBjb2RlIGNodW5rcwogIG1lc3NhZ2UgPSBGQUxTRSwgICAgCiAgIyBEaXNhYmxlIHdhcm5pbmdzIHByaW50ZWQgYnkgUiBjb2RlIGNodW5rcwogIHdhcm5pbmcgPSBGQUxTRSwgICAgCiAgIyBTaG93IFIgY29kZSB3aXRoaW4gY29kZSBjaHVua3MgaW4gb3V0cHV0CiAgZWNobyA9IFRSVUUsICAgICAgICAKICAjIEluY2x1ZGUgYm90aCBSIGNvZGUgYW5kIGl0cyByZXN1bHRzIGluIG91dHB1dAogIGluY2x1ZGUgPSBUUlVFLCAgICAgCiAgIyBFdmFsdWF0ZSBSIGNvZGUgY2h1bmtzCiAgZXZhbCA9IFRSVUUsICAgICAgIAogICMgRW5hYmxlIGNhY2hpbmcgb2YgUiBjb2RlIGNodW5rcyBmb3IgZmFzdGVyIHJlbmRlcmluZwogIGNhY2hlID0gRkFMU0UsICAgICAgCiAgIyBBbGlnbiBmaWd1cmVzIGluIHRoZSBjZW50ZXIgb2YgdGhlIG91dHB1dAogIGZpZy5hbGlnbiA9ICJjZW50ZXIiLAogICMgRW5hYmxlIHJldGluYSBkaXNwbGF5IGZvciBoaWdoLXJlc29sdXRpb24gZmlndXJlcwogIHJldGluYSA9IDIsCiAgIyBTaG93IGVycm9ycyBpbiB0aGUgb3V0cHV0IGluc3RlYWQgb2Ygc3RvcHBpbmcgcmVuZGVyaW5nCiAgZXJyb3IgPSBUUlVFLAogICMgRG8gbm90IGNvbGxhcHNlIGNvZGUgYW5kIG91dHB1dCBpbnRvIGEgc2luZ2xlIGJsb2NrCiAgY29sbGFwc2UgPSBGQUxTRQopCmBgYAoKQmVsb3cgd2UgbG9hZCB0aGUgbmVjZXNzYXJ5IGxpYnJhcmllcy4KCmBgYHtyfQpsaWJyYXJ5KElOTEEpCmxpYnJhcnkoaW5sYWJydSkKbGlicmFyeShyU1BERSkKbGlicmFyeShNZXRyaWNHcmFwaCkKCmxpYnJhcnkoZHBseXIpCmxpYnJhcnkocGxvdGx5KQpsaWJyYXJ5KHNjYWxlcykKbGlicmFyeShwYXRjaHdvcmspCgpsaWJyYXJ5KGdncGxvdDIpCmxpYnJhcnkoY293cGxvdCkKbGlicmFyeShnZ3B1YnIpICNhbm5vdGF0ZV9maWd1cmUoKQpsaWJyYXJ5KGdyaWQpICN0ZXh0R3JvYigpCmxpYnJhcnkoZ2dtYXApCgpsaWJyYXJ5KHZpcmlkaXMpCmxpYnJhcnkoT3BlblN0cmVldE1hcCkKCgpsaWJyYXJ5KHRpZHlyKQpsaWJyYXJ5KHNmKQoKbGlicmFyeShoZXJlKQpsaWJyYXJ5KHJtYXJrZG93bikKbGlicmFyeShncmF0ZWZ1bCkgIyBDaXRlIGFsbCBsb2FkZWQgcGFja2FnZXMKYGBgCgoKQmVsb3cgd2UgZGVmaW5lIHRoZSBmdW5jdGlvbiBgY2FwdGlvbmVyKClgIHRvIGdlbmVyYXRlIGNhcHRpb25zIGZvciB0aGUgZmlndXJlcyBhbmQgdGhlIGZ1bmN0aW9uIGBwcm9jZXNzX21vZGVsX3Jlc3VsdHMoKWAgdG8gZXh0cmFjdCB0aGUgc3VtbWFyeSBvZiB0aGUgcGFyYW1ldGVycyBvZiB0aGUgbW9kZWwuCgpCZWxvdyB3ZSBhbHNvIGRlZmluZSBmdW5jdGlvbiBgY29tcHV0ZV9wY3IoKWAsIHdoaWNoIGNvbXB1dGVzIHRoZSBwcmFjdGljYWwgY29ycmVsYXRpb24uIEl0IHJlY2VpdmVzIHRoZSBvdXRwdXQgb2YgdGhlIFtgclNQREU6OnNwZGUubWF0ZXJuLm9wZXJhdG9ycygpYF0oaHR0cHM6Ly9kYXZpZGJvbGluLmdpdGh1Yi5pby9yU1BERS9yZWZlcmVuY2Uvc3BkZS5tYXRlcm4ub3BlcmF0b3JzLmh0bWwpIGZ1bmN0aW9uICh3aGVuIGV2YWx1YXRlZCBvbiBjb21wYXRpYmxlIHBhcmFtZXRlcnMpIGFuZCBhIHRocmVzaG9sZCBgY29yX3RocmVzaG9sZGAuIFVzaW5nIHRoZSBjb3JyZWxhdGlvbiBtYXRyaXggYW5kIHRoZSBnZW9kZXNpYyBkaXN0YW5jZSBtYXRyaXgsIGZvciBlYWNoIHBvaW50IGluIHRoZSBtZXNoLCBpdCBjb21wdXRlcyB0aGUgcHJhY3RpY2FsIGNvcnJlbGF0aW9uIHJhbmdlIGFzIHRoZSBtaW5pbXVtIGdlb2Rlc2ljIGRpc3RhbmNlIHN1Y2ggdGhhdCB0aGUgY29ycmVsYXRpb24gaXMgYmVsb3cgYSBnaXZlbiB0aHJlc2hvbGQgYGNvcl90aHJlc2hvbGRgICh1c3VhbGx5IGRlZmluZWQgYXMgMC4xKS4gVGhlIGZ1bmN0aW9uIHJldHVybnMgYSB2ZWN0b3Igd2l0aCB0aGUgcHJhY3RpY2FsIGNvcnJlbGF0aW9uIHJhbmdlIGZvciBlYWNoIHBvaW50IGluIHRoZSBtZXNoLgoKPGRpdiBzdHlsZT0iY29sb3I6IGJsdWU7Ij4KKioqKioqKioKKipQcmVzcyB0aGUgU2hvdyBidXR0b24gYmVsb3cgdG8gcmV2ZWFsIHRoZSBjb2RlLioqCgoqKioqKioqKgo8L2Rpdj4KCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0KIyBTdGFydCB0aGUgZmlndXJlIGNvdW50ZXIKZmlnX2NvdW50IDwtIDAKIyBEZWZpbmUgdGhlIGNhcHRpb25lciBmdW5jdGlvbgpjYXB0aW9uZXIgPC0gZnVuY3Rpb24oY2FwdGlvbikgewogIGZpZ19jb3VudCA8PC0gZmlnX2NvdW50ICsgMQogIHBhc3RlMCgiRmlndXJlICIsIGZpZ19jb3VudCwgIjogIiwgY2FwdGlvbikKfQpwcm9jZXNzX21vZGVsX3Jlc3VsdHMgPC0gZnVuY3Rpb24oZml0LCBtb2RlbCkgewogIGZpdF9zcGRlIDwtIHJzcGRlLnJlc3VsdChmaXQsICJmaWVsZCIsIG1vZGVsLCBwYXJhbWV0ZXJpemF0aW9uID0gInNwZGUiKQogIGZpdF9tYXRlcm4gPC0gcnNwZGUucmVzdWx0KGZpdCwgImZpZWxkIiwgbW9kZWwsIHBhcmFtZXRlcml6YXRpb24gPSAibWF0ZXJuIikKICBkZl9mb3JfcGxvdF9zcGRlIDwtIGdnX2RmKGZpdF9zcGRlKQogIGRmX2Zvcl9wbG90X21hdGVybiA8LSBnZ19kZihmaXRfbWF0ZXJuKQogIHBhcmFtX3NwZGUgPC0gc3VtbWFyeShmaXRfc3BkZSkKICBwYXJhbV9tYXRlcm4gPC0gc3VtbWFyeShmaXRfbWF0ZXJuKQogIHBhcmFtX2ZpeGVkIDwtIGZpdCRzdW1tYXJ5LmZpeGVkWywxOjZdCiAgbWFyZ2luYWwucG9zdGVyaW9yLnNpZ21hX2UgPSBpbmxhLnRtYXJnaW5hbCgKICAgIGZ1biA9IGZ1bmN0aW9uKHgpIGV4cCgteC8yKSwgCiAgICBtYXJnaW5hbCA9IGZpdFtbImludGVybmFsLm1hcmdpbmFscy5oeXBlcnBhciJdXVtbIkxvZyBwcmVjaXNpb24gZm9yIHRoZSBHYXVzc2lhbiBvYnNlcnZhdGlvbnMiXV0pCiAgcXVhbnQuc2lnbWFfZSA8LSBjYXB0dXJlLm91dHB1dCh7cmVzdWx0X3RtcCA8LSBpbmxhLnptYXJnaW5hbChtYXJnaW5hbC5wb3N0ZXJpb3Iuc2lnbWFfZSl9LCBmaWxlID0gIi9kZXYvbnVsbCIpIAogIHF1YW50LnNpZ21hX2UgPC0gcmVzdWx0X3RtcAogIHN0YXRpc3RpY3Muc2lnbWFfZSA8LSB1bmxpc3QocXVhbnQuc2lnbWFfZSlbYygxLDIsMyw1LDcpXQogIG1vZGUuc2lnbWFfZSA8LSBpbmxhLm1tYXJnaW5hbChtYXJnaW5hbC5wb3N0ZXJpb3Iuc2lnbWFfZSkKICBhbGxwYXJhbXMgPC0gcmJpbmQocGFyYW1fZml4ZWQsIHBhcmFtX3NwZGUsIHBhcmFtX21hdGVybiwgYyhzdGF0aXN0aWNzLnNpZ21hX2UsIG1vZGUuc2lnbWFfZSkpCiAgcm93bmFtZXMoYWxscGFyYW1zKVtucm93KGFsbHBhcmFtcyldIDwtICJzaWdtYV9lIgogIHJldHVybihsaXN0KGFsbHBhcmFtcyA9IGFsbHBhcmFtcywgZGZfZm9yX3Bsb3Rfc3BkZSA9IGRmX2Zvcl9wbG90X3NwZGUsIGRmX2Zvcl9wbG90X21hdGVybiA9IGRmX2Zvcl9wbG90X21hdGVybikpCn0KY29tcHV0ZV9wY3IgPC0gZnVuY3Rpb24ob3AsIGNvcl90aHJlc2hvbGQpIHsKICAjIENvbXB1dGUgdGhlIGNvdmFyaWFuY2UgbWF0cml4CiAgY292X21hdHJpeCA8LSBvcCRjb3ZhcmlhbmNlX21lc2goKSAKICAjIENvbXB1dGUgdGhlIGNvcnJlbGF0aW9uIG1hdHJpeAogIGNvcl9tYXRyaXggPC1jb3YyY29yKGNvdl9tYXRyaXgpCiAgIyBDb21wdXRlIHRoZSBnZW9kZXNpYyBkaXN0YW5jZSBtYXRyaXgKICBvcCRncmFwaCRjb21wdXRlX2dlb2Rpc3RfbWVzaCgpIAogICMgRXh0cmFjdCB0aGUgZ2VvZGVzaWMgZGlzdGFuY2UgbWF0cml4CiAgZGlzdF9tYXRyaXggPC0gb3AkZ3JhcGgkbWVzaCRnZW9fZGlzdCAKICAjIEluaXRpYWxpemUgdGhlIHZlY3RvciB0byBzdG9yZSB0aGUgcHJhY3RpY2FsIGNvcnJlbGF0aW9uIHJhbmdlCiAgcGNyIDwtIG51bWVyaWMoZGltKGNvcl9tYXRyaXgpWzFdKSAKICAKICBwcm9jZXNzX3JvdyA8LSBmdW5jdGlvbihyb3dfaW5kZXgpIHsKICAgICMgRm9yIGVhY2ggcm93X2luZGV4LCBjcmVhdGUgYW4gYXV4aWxpYXJ5IG1hdHJpeCBhdXhfbWF0IHdpdGggdGhlIGNvcnJlbGF0aW9uIGFuZCBnZW9kZXNpYyBkaXN0YW5jZQogICAgYXV4X21hdCA8LSBjYmluZChjb3JfbWF0cml4W3Jvd19pbmRleCwgXSwgZGlzdF9tYXRyaXhbcm93X2luZGV4LCBdKSAKICAgICMgT3JkZXIgdGhlIGF1eGlsaWFyeSBtYXRyaXggYnkgdGhlIGdlb2Rlc2ljIGRpc3RhbmNlCiAgICBvcmRlcmVkX2F1eF9tYXQgPC0gYXV4X21hdFtvcmRlcihhdXhfbWF0WywgMl0pLCBdIAogICAgIyBGaWx0ZXIgdGhlIGF1eGlsaWFyeSBvcmRlcmVkIG1hdHJpeCBieSB0aGUgY29ycmVsYXRpb24gdGhyZXNob2xkCiAgICBmaWx0ZXJlZF9hdXhfbWF0IDwtIG9yZGVyZWRfYXV4X21hdFtvcmRlcmVkX2F1eF9tYXRbLDFdIDwgY29yX3RocmVzaG9sZCwgXSAKICAgIGlmIChucm93KGZpbHRlcmVkX2F1eF9tYXQpID4gMCkgewogICAgICAjIFJldHVybiB0aGUgbWluaW11bSBnZW9kZXNpYyBkaXN0YW5jZSBzdWNoIHRoYXQgdGhlIGNvcnJlbGF0aW9uIGlzIGJlbG93IHRoZSB0aHJlc2hvbGQKICAgICAgcmV0dXJuKGZpbHRlcmVkX2F1eF9tYXRbMSwgMl0pIAogICAgfSBlbHNlIHsKICAgICAgIyBJZiB0aGUgY29uZGl0aW9uIGlzIG5vdCBzYXRpc2ZpZWQsIHJlY29yZCB0aGUgbWluaW11bSBjb3JyZWxhdGlvbiB2YWx1ZSBhbmQgcmV0dXJuIGFuIGVycm9yIG1lc3NhZ2UKICAgICAgbWluIDwtIG1pbihhdXhfbWF0WywgMV0pCiAgICAgIHN0b3AocGFzdGUwKCJUaGUgY29uZGl0aW9uIGNvcl9tYXRyaXhbcm93X2luZGV4LCBdIDwgY29yX3RocmVzaG9sZCBpcyBub3Qgc2F0aXNmaWVkIGZvciByb3dfaW5kZXggPSAiLCAKICAgICAgICAgICAgICAgICAgcm93X2luZGV4LCAiLiBJbmNyZWFzZSBjb3JfdGhyZXNob2xkLiBUaGUgbWluaW11bSB2YWx1ZSBvZiBjb3JfbWF0cml4W3Jvd19pbmRleCwgXSBpcyAiLAogICAgICAgICAgICAgICAgICBtaW4pKQogICAgfQogIH0KICAKICBwY3IgPC0gc2FwcGx5KDE6ZGltKGNvcl9tYXRyaXgpWzFdLCBwcm9jZXNzX3JvdykKICAKICByZXR1cm4ocGNyKQp9CmBgYAoKV2UgZmlyc3QgbG9hZCBgcGVtc19yZXBsMl9yZXN1bHRzLlJEYXRhYCAod2hpY2ggY29udGFpbnMgYSBsaXN0IGBsaXN0X3RvX3NhdmVgKSBhbmQgZXh0cmFjdCBpdHMgY29udGVudC4KCmBgYHtyfQojIExvYWQgdGhlIGRhdGEKbG9hZChoZXJlKCJkYXRhX2ZpbGVzL3BlbXNfcmVwbDJfcmVzdWx0cy5SRGF0YSIpKQojIEV4dHJhY3QgaXRzIGNvbnRlbnQKZ3JhcGggPC0gbGlzdF90b19zYXZlJGdyYXBoCkIudGF1IDwtIGxpc3RfdG9fc2F2ZSRCLnRhdQpCLmthcHBhIDwtIGxpc3RfdG9fc2F2ZSRCLmthcHBhCiMgRWFjaCBvZiB0aGUgb2JqZWN0cyBiZWxvdyBpcyBhIG1hdHJpeCB3aXRoIHR3byBjb2x1bW5zLCB0aGUgZmlyc3QgY29sdW1uIGlzIHRoZSBtZWFuIGFuZCB0aGUgc2Vjb25kIGNvbHVtbiBpcyB0aGUgbW9kZQojIFJlZmVyIHRvIHBlbXNfcmVwbDIuaHRtbCBmb3IgbW9yZSBkZXRhaWxzIGFib3V0IHRoZWlyIGNvbnRlbnQKbWVhbl9hbmRfbW9kZV9wYXJhbXNfc3RhdG51MC41IDwtIGxpc3RfdG9fc2F2ZSRtZWFuX2FuZF9tb2RlX3BhcmFtc19zdGF0bnUwLjUKbWVhbl9hbmRfbW9kZV9wYXJhbXNfbm9uc3RhdG51MC41IDwtIGxpc3RfdG9fc2F2ZSRtZWFuX2FuZF9tb2RlX3BhcmFtc19ub25zdGF0bnUwLjUKbWVhbl9hbmRfbW9kZV9wYXJhbXNfc3RhdG51MS41IDwtIGxpc3RfdG9fc2F2ZSRtZWFuX2FuZF9tb2RlX3BhcmFtc19zdGF0bnUxLjUKbWVhbl9hbmRfbW9kZV9wYXJhbXNfbm9uc3RhdG51MS41IDwtIGxpc3RfdG9fc2F2ZSRtZWFuX2FuZF9tb2RlX3BhcmFtc19ub25zdGF0bnUxLjUKbWVhbl9hbmRfbW9kZV9wYXJhbXNfc3RhdG51ZXN0IDwtIGxpc3RfdG9fc2F2ZSRtZWFuX2FuZF9tb2RlX3BhcmFtc19zdGF0bnVlc3QKbWVhbl9hbmRfbW9kZV9wYXJhbXNfbm9uc3RhdG51ZXN0IDwtIGxpc3RfdG9fc2F2ZSRtZWFuX2FuZF9tb2RlX3BhcmFtc19ub25zdGF0bnVlc3QKYGBgCgoKQmVsb3cgd2UgZGVmaW5lIHRoZSBjb3JyZWxhdGlvbiB0aHJlc2hvbGQgdG8gY29tcHV0ZSB0aGUgcHJhY3RpY2FsIGNvcnJlbGF0aW9uIHJhbmdlLgoKCmBgYHtyfQojIERlZmluZSBjb3JyZWxhdGlvbiB0aHJlc2hvbGQKY29yX3RocmVzaG9sZCA8LSAwLjcgCmBgYAoKCiMgQ2FzZSAkXG51ID0gMC41JAoKQmVsb3cgd2UgY29uc2lkZXIgdGhlIHBhcmFtZXRlcnMgb2J0YWluZWQgZm9yIHRoZSBzdGF0aW9uYXJ5IG1vZGVsIHdpdGggJFxudSA9IDAuNSQuCgpgYGB7cn0KdGF1X3N0YXRudTAuNSA8LSBtZWFuX2FuZF9tb2RlX3BhcmFtc19zdGF0bnUwLjVbMywxXQprYXBwYV9zdGF0bnUwLjUgPC0gbWVhbl9hbmRfbW9kZV9wYXJhbXNfc3RhdG51MC41WzQsMV0Kb3Bfc3RhdG51MC41IDwtIHJTUERFOjptYXRlcm4ub3BlcmF0b3JzKGdyYXBoID0gZ3JhcGgsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1ldGVyaXphdGlvbiA9ICJzcGRlIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXUgPSB0YXVfc3RhdG51MC41LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGthcHBhID0ga2FwcGFfc3RhdG51MC41LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFscGhhID0gMSkKCgojIFByZWNpc2lvbiBtYXRyaXgKUV9zdGF0bnUwLjUgPC0gcHJlY2lzaW9uKG9wX3N0YXRudTAuNSkKZXN0X3NpZ21hX3N0YXRudTAuNSA8LSBzcXJ0KGRpYWcoSU5MQTo6aW5sYS5xaW52KFFfc3RhdG51MC41KSkpIAplc3RfcmFuZ2Vfc3RhdG51MC41IDwtIGNvbXB1dGVfcGNyKG9wX3N0YXRudTAuNSwgY29yX3RocmVzaG9sZCkKYGBgCgoKYGBge3IsIGZpZy53aWR0aCA9IDkuMjIsIGZpZy5oZWlnaHQgPSA0LjAxLCBmaWcuY2FwID0gY2FwdGlvbmVyKCJTdGFuZGFyZCBkZXZpYXRpb24gYW5kIHByYWN0aWNhbCBjb3JyZWxhdGlvbiByYW5nZSBmb3IgdGhlIHN0YXRpb25hcnkgbW9kZWwgd2l0aCAkXFxudSA9IDAuNSQuIil9CiMgQ3JlYXRlIGEgcGxvdCBvZiB0aGUgc3RhbmRhcmQgZGV2aWF0aW9uCnMgPC0gZ3JhcGgkcGxvdF9mdW5jdGlvbihYID0gZXN0X3NpZ21hX3N0YXRudTAuNSwgdmVydGV4X3NpemUgPSAwLCBwbG90bHkgPSBGQUxTRSkgKwogIGdndGl0bGUoIlN0YW5kYXJkIGRldmlhdGlvbiIpICsKICB0aGVtZV9taW5pbWFsKCkgKwogIHRoZW1lKHRleHQgPSBlbGVtZW50X3RleHQoZmFtaWx5ID0gIlBhbGF0aW5vIikpCiMgQ3JlYXRlIGEgcGxvdCBvZiB0aGUgcHJhY3RpY2FsIGNvcnJlbGF0aW9uIHJhbmdlCnIgPC0gZ3JhcGgkcGxvdF9mdW5jdGlvbihYID0gZXN0X3JhbmdlX3N0YXRudTAuNSwgdmVydGV4X3NpemUgPSAwLCBwbG90bHkgPSBGQUxTRSkgKwogIGdndGl0bGUoIlByYWN0aWNhbCBjb3JyZWxhdGlvbiByYW5nZSIpICsKICB0aGVtZV9taW5pbWFsKCkgKwogIHRoZW1lKHRleHQgPSBlbGVtZW50X3RleHQoZmFtaWx5ID0gIlBhbGF0aW5vIikpCnNyIDwtIHMgKyByCnByaW50KHNyKQpgYGAKCkJlbG93IHdlIGNvbnNpZGVyIHRoZSBwYXJhbWV0ZXJzIG9idGFpbmVkIGZvciB0aGUgbm9uLXN0YXRpb25hcnkgbW9kZWwgd2l0aCAkXG51ID0gMC41JC4KCmBgYHtyfQp0aGV0YV9ub25zdGF0bnUwLjUgPC0gbWVhbl9hbmRfbW9kZV9wYXJhbXNfbm9uc3RhdG51MC41WzM6NiwxXQpvcF9ub25zdGF0bnUwLjUgPC0gclNQREU6OnNwZGUubWF0ZXJuLm9wZXJhdG9ycyhncmFwaCA9IGdyYXBoLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtZXRlcml6YXRpb24gPSAic3BkZSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQi50YXUgPSBCLnRhdSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBCLmthcHBhID0gQi5rYXBwYSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGV0YSA9IHRoZXRhX25vbnN0YXRudTAuNSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbHBoYSA9IDEpCgoKIyBQcmVjaXNpb24gbWF0cml4ClFfbm9uc3RhdG51MC41IDwtIHByZWNpc2lvbihvcF9ub25zdGF0bnUwLjUpCmVzdF9zaWdtYV9ub25zdGF0bnUwLjUgPC0gc3FydChkaWFnKElOTEE6OmlubGEucWludihRX25vbnN0YXRudTAuNSkpKSAKZXN0X3JhbmdlX25vbnN0YXRudTAuNSA8LSBjb21wdXRlX3BjcihvcF9ub25zdGF0bnUwLjUsIGNvcl90aHJlc2hvbGQpCgplc3RfdGF1X25vbnN0YXRudTAuNSA8LSBleHAoQi50YXVbLC0xXSUqJXRoZXRhX25vbnN0YXRudTAuNSkKZXN0X2thcHBhX25vbnN0YXRudTAuNSA8LSBleHAoQi5rYXBwYVssLTFdJSoldGhldGFfbm9uc3RhdG51MC41KQpgYGAKCmBgYHtyLCBmaWcud2lkdGggPSA5LjIyLCBmaWcuaGVpZ2h0ID0gNy4wNSwgZmlnLmNhcCA9IGNhcHRpb25lcigiU3RhbmRhcmQgZGV2aWF0aW9uLCBwcmFjdGljYWwgY29ycmVsYXRpb24gcmFuZ2UsIHRoZSBtb2RlbCBmb3IgdGF1LCBhbmQgdGhlIG1vZGVsIGZvciBrYXBwYSBmb3IgdGhlIG5vbi1zdGF0aW9uYXJ5IG1vZGVsIHdpdGggJFxcbnUgPSAwLjUkLiIpfQojIENyZWF0ZSBhIHBsb3Qgb2YgdGhlIHN0YW5kYXJkIGRldmlhdGlvbgpzIDwtIGdyYXBoJHBsb3RfZnVuY3Rpb24oWCA9IGVzdF9zaWdtYV9ub25zdGF0bnUwLjUsIHZlcnRleF9zaXplID0gMCwgcGxvdGx5ID0gRkFMU0UpICsKICBnZ3RpdGxlKCJTdGFuZGFyZCBkZXZpYXRpb24iKSArCiAgdGhlbWVfbWluaW1hbCgpICsKICB0aGVtZSh0ZXh0ID0gZWxlbWVudF90ZXh0KGZhbWlseSA9ICJQYWxhdGlubyIpKQojIENyZWF0ZSBhIHBsb3Qgb2YgdGhlIHByYWN0aWNhbCBjb3JyZWxhdGlvbiByYW5nZQpyIDwtIGdyYXBoJHBsb3RfZnVuY3Rpb24oWCA9IGVzdF9yYW5nZV9ub25zdGF0bnUwLjUsIHZlcnRleF9zaXplID0gMCwgcGxvdGx5ID0gRkFMU0UpICsKICBnZ3RpdGxlKCJQcmFjdGljYWwgY29ycmVsYXRpb24gcmFuZ2UiKSArCiAgdGhlbWVfbWluaW1hbCgpICsKICB0aGVtZSh0ZXh0ID0gZWxlbWVudF90ZXh0KGZhbWlseSA9ICJQYWxhdGlubyIpKQp1IDwtIGdyYXBoJHBsb3RfZnVuY3Rpb24oWCA9IGVzdF90YXVfbm9uc3RhdG51MC41LCB2ZXJ0ZXhfc2l6ZSA9IDAsIHBsb3RseSA9IEZBTFNFKSArCiAgZ2d0aXRsZSgiTW9kZWwgZm9yIHRhdSIpICsKICB0aGVtZV9taW5pbWFsKCkgKwogIHRoZW1lKHRleHQgPSBlbGVtZW50X3RleHQoZmFtaWx5ID0gIlBhbGF0aW5vIikpCiMgQ3JlYXRlIGEgcGxvdCBvZiB0aGUgcHJhY3RpY2FsIGNvcnJlbGF0aW9uIHJhbmdlCmsgPC0gZ3JhcGgkcGxvdF9mdW5jdGlvbihYID0gZXN0X2thcHBhX25vbnN0YXRudTAuNSwgdmVydGV4X3NpemUgPSAwLCBwbG90bHkgPSBGQUxTRSkgKwogIGdndGl0bGUoIk1vZGVsIGZvciBrYXBwYSIpICsKICB0aGVtZV9taW5pbWFsKCkgKwogIHRoZW1lKHRleHQgPSBlbGVtZW50X3RleHQoZmFtaWx5ID0gIlBhbGF0aW5vIikpCnNydWsgPC0gKHMgKyByKSAvICh1ICsgaykKcHJpbnQoc3J1aykKYGBgCgojIENhc2UgJFxudSA9IDEuNSQKCkJlbG93IHdlIGNvbnNpZGVyIHRoZSBwYXJhbWV0ZXJzIG9idGFpbmVkIGZvciB0aGUgc3RhdGlvbmFyeSBtb2RlbCB3aXRoICRcbnUgPSAxLjUkLgoKYGBge3J9CnRhdV9zdGF0bnUxLjUgPC0gbWVhbl9hbmRfbW9kZV9wYXJhbXNfc3RhdG51MS41WzMsMV0Ka2FwcGFfc3RhdG51MS41IDwtIG1lYW5fYW5kX21vZGVfcGFyYW1zX3N0YXRudTEuNVs0LDFdCm9wX3N0YXRudTEuNSA8LSByU1BERTo6bWF0ZXJuLm9wZXJhdG9ycyhncmFwaCA9IGdyYXBoLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1ldGVyaXphdGlvbiA9ICJzcGRlIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhdSA9IHRhdV9zdGF0bnUxLjUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrYXBwYSA9IGthcHBhX3N0YXRudTEuNSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFscGhhID0gMikKCgojIFByZWNpc2lvbiBtYXRyaXgKUV9zdGF0bnUxLjUgPC0gcHJlY2lzaW9uKG9wX3N0YXRudTEuNSkKZXN0X3NpZ21hX3N0YXRudTEuNSA8LSBzcXJ0KGRpYWcoSU5MQTo6aW5sYS5xaW52KFFfc3RhdG51MS41KSkpIAplc3RfcmFuZ2Vfc3RhdG51MS41IDwtIGNvbXB1dGVfcGNyKG9wX3N0YXRudTEuNSwgY29yX3RocmVzaG9sZCkKYGBgCgoKYGBge3IsIGZpZy53aWR0aCA9IDkuMjIsIGZpZy5oZWlnaHQgPSA0LjAxLCBmaWcuY2FwID0gY2FwdGlvbmVyKCJTdGFuZGFyZCBkZXZpYXRpb24gYW5kIHByYWN0aWNhbCBjb3JyZWxhdGlvbiByYW5nZSBmb3IgdGhlIHN0YXRpb25hcnkgbW9kZWwgd2l0aCAkXFxudSA9IDEuNSQuIil9CiMgQ3JlYXRlIGEgcGxvdCBvZiB0aGUgc3RhbmRhcmQgZGV2aWF0aW9uCnMgPC0gZ3JhcGgkcGxvdF9mdW5jdGlvbihYID0gZXN0X3NpZ21hX3N0YXRudTEuNSwgdmVydGV4X3NpemUgPSAwLCBwbG90bHkgPSBGQUxTRSkgKwogIGdndGl0bGUoIlN0YW5kYXJkIGRldmlhdGlvbiIpICsKICB0aGVtZV9taW5pbWFsKCkgKwogIHRoZW1lKHRleHQgPSBlbGVtZW50X3RleHQoZmFtaWx5ID0gIlBhbGF0aW5vIikpCiMgQ3JlYXRlIGEgcGxvdCBvZiB0aGUgcHJhY3RpY2FsIGNvcnJlbGF0aW9uIHJhbmdlCnIgPC0gZ3JhcGgkcGxvdF9mdW5jdGlvbihYID0gZXN0X3JhbmdlX3N0YXRudTEuNSwgdmVydGV4X3NpemUgPSAwLCBwbG90bHkgPSBGQUxTRSkgKwogIGdndGl0bGUoIlByYWN0aWNhbCBjb3JyZWxhdGlvbiByYW5nZSIpICsKICB0aGVtZV9taW5pbWFsKCkgKwogIHRoZW1lKHRleHQgPSBlbGVtZW50X3RleHQoZmFtaWx5ID0gIlBhbGF0aW5vIikpCnNyIDwtIHMgKyByCnByaW50KHNyKQpgYGAKCkJlbG93IHdlIGNvbnNpZGVyIHRoZSBwYXJhbWV0ZXJzIG9idGFpbmVkIGZvciB0aGUgbm9uLXN0YXRpb25hcnkgbW9kZWwgd2l0aCAkXG51ID0gMS41JC4KCmBgYHtyfQp0aGV0YV9ub25zdGF0bnUxLjUgPC0gbWVhbl9hbmRfbW9kZV9wYXJhbXNfbm9uc3RhdG51MS41WzM6NiwxXQpvcF9ub25zdGF0bnUxLjUgPC0gclNQREU6OnNwZGUubWF0ZXJuLm9wZXJhdG9ycyhncmFwaCA9IGdyYXBoLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJhbWV0ZXJpemF0aW9uID0gInNwZGUiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBCLnRhdSA9IEIudGF1LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBCLmthcHBhID0gQi5rYXBwYSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhldGEgPSB0aGV0YV9ub25zdGF0bnUxLjUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFscGhhID0gMikKCgojIFByZWNpc2lvbiBtYXRyaXgKUV9ub25zdGF0bnUxLjUgPC0gcHJlY2lzaW9uKG9wX25vbnN0YXRudTEuNSkKZXN0X3NpZ21hX25vbnN0YXRudTEuNSA8LSBzcXJ0KGRpYWcoSU5MQTo6aW5sYS5xaW52KFFfbm9uc3RhdG51MS41KSkpIAplc3RfcmFuZ2Vfbm9uc3RhdG51MS41IDwtIGNvbXB1dGVfcGNyKG9wX25vbnN0YXRudTEuNSwgY29yX3RocmVzaG9sZCkKCmVzdF90YXVfbm9uc3RhdG51MS41IDwtIGV4cChCLnRhdVssLTFdJSoldGhldGFfbm9uc3RhdG51MS41KQplc3Rfa2FwcGFfbm9uc3RhdG51MS41IDwtIGV4cChCLmthcHBhWywtMV0lKiV0aGV0YV9ub25zdGF0bnUxLjUpCmBgYAoKCmBgYHtyLCBmaWcud2lkdGggPSA5LjIyLCBmaWcuaGVpZ2h0ID0gNy4wNSwgZmlnLmNhcCA9IGNhcHRpb25lcigiU3RhbmRhcmQgZGV2aWF0aW9uLCBwcmFjdGljYWwgY29ycmVsYXRpb24gcmFuZ2UsIHRoZSBtb2RlbCBmb3IgdGF1LCBhbmQgdGhlIG1vZGVsIGZvciBrYXBwYSBmb3IgdGhlIG5vbi1zdGF0aW9uYXJ5IG1vZGVsIHdpdGggJFxcbnUgPSAxLjUkLiIpfQojIENyZWF0ZSBhIHBsb3Qgb2YgdGhlIHN0YW5kYXJkIGRldmlhdGlvbgpzIDwtIGdyYXBoJHBsb3RfZnVuY3Rpb24oWCA9IGVzdF9zaWdtYV9ub25zdGF0bnUxLjUsIHZlcnRleF9zaXplID0gMCwgcGxvdGx5ID0gRkFMU0UpICsKICBnZ3RpdGxlKCJTdGFuZGFyZCBkZXZpYXRpb24iKSArCiAgdGhlbWVfbWluaW1hbCgpICsKICB0aGVtZSh0ZXh0ID0gZWxlbWVudF90ZXh0KGZhbWlseSA9ICJQYWxhdGlubyIpKQojIENyZWF0ZSBhIHBsb3Qgb2YgdGhlIHByYWN0aWNhbCBjb3JyZWxhdGlvbiByYW5nZQpyIDwtIGdyYXBoJHBsb3RfZnVuY3Rpb24oWCA9IGVzdF9yYW5nZV9ub25zdGF0bnUxLjUsIHZlcnRleF9zaXplID0gMCwgcGxvdGx5ID0gRkFMU0UpICsKICBnZ3RpdGxlKCJQcmFjdGljYWwgY29ycmVsYXRpb24gcmFuZ2UiKSArCiAgdGhlbWVfbWluaW1hbCgpICsKICB0aGVtZSh0ZXh0ID0gZWxlbWVudF90ZXh0KGZhbWlseSA9ICJQYWxhdGlubyIpKQp1IDwtIGdyYXBoJHBsb3RfZnVuY3Rpb24oWCA9IGVzdF90YXVfbm9uc3RhdG51MS41LCB2ZXJ0ZXhfc2l6ZSA9IDAsIHBsb3RseSA9IEZBTFNFKSArCiAgZ2d0aXRsZSgiTW9kZWwgZm9yIHRhdSIpICsKICB0aGVtZV9taW5pbWFsKCkgKwogIHRoZW1lKHRleHQgPSBlbGVtZW50X3RleHQoZmFtaWx5ID0gIlBhbGF0aW5vIikpCiMgQ3JlYXRlIGEgcGxvdCBvZiB0aGUgcHJhY3RpY2FsIGNvcnJlbGF0aW9uIHJhbmdlCmsgPC0gZ3JhcGgkcGxvdF9mdW5jdGlvbihYID0gZXN0X2thcHBhX25vbnN0YXRudTEuNSwgdmVydGV4X3NpemUgPSAwLCBwbG90bHkgPSBGQUxTRSkgKwogIGdndGl0bGUoIk1vZGVsIGZvciBrYXBwYSIpICsKICB0aGVtZV9taW5pbWFsKCkgKwogIHRoZW1lKHRleHQgPSBlbGVtZW50X3RleHQoZmFtaWx5ID0gIlBhbGF0aW5vIikpCnNydWsgPC0gKHMgKyByKSAvICh1ICsgaykKcHJpbnQoc3J1aykKYGBgCgojIENhc2UgJFxudSQgZXN0aW1hdGVkCgpCZWxvdyB3ZSBjb25zaWRlciB0aGUgcGFyYW1ldGVycyBvYnRhaW5lZCBmb3IgdGhlIHN0YXRpb25hcnkgbW9kZWwgd2l0aCAkXG51JCBlc3RpbWF0ZWQuCgpgYGB7cn0KdGF1X3N0YXRudWVzdCA8LSBtZWFuX2FuZF9tb2RlX3BhcmFtc19zdGF0bnVlc3RbMywxXQprYXBwYV9zdGF0bnVlc3QgPC0gbWVhbl9hbmRfbW9kZV9wYXJhbXNfc3RhdG51ZXN0WzQsMV0KbnVfc3RhdG51ZXN0IDwtIG1lYW5fYW5kX21vZGVfcGFyYW1zX3N0YXRudWVzdFs1LDFdCm9wX3N0YXRudWVzdCA8LSByU1BERTo6bWF0ZXJuLm9wZXJhdG9ycyhncmFwaCA9IGdyYXBoLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1ldGVyaXphdGlvbiA9ICJzcGRlIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhdSA9IHRhdV9zdGF0bnVlc3QsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrYXBwYSA9IGthcHBhX3N0YXRudWVzdCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFscGhhID0gMC41ICsgbnVfc3RhdG51ZXN0KQoKCiMgUHJlY2lzaW9uIG1hdHJpeApRX3N0YXRudWVzdCA8LSBwcmVjaXNpb24ob3Bfc3RhdG51ZXN0KQplc3Rfc2lnbWFfc3RhdG51ZXN0IDwtIHNxcnQoZGlhZyhJTkxBOjppbmxhLnFpbnYoUV9zdGF0bnVlc3QpKSkgCmVzdF9yYW5nZV9zdGF0bnVlc3QgPC0gY29tcHV0ZV9wY3Iob3Bfc3RhdG51ZXN0LCBjb3JfdGhyZXNob2xkKQpgYGAKCgpgYGB7ciwgZmlnLndpZHRoID0gOS4yMiwgZmlnLmhlaWdodCA9IDQuMDEsIGZpZy5jYXAgPSBjYXB0aW9uZXIoIlN0YW5kYXJkIGRldmlhdGlvbiBhbmQgcHJhY3RpY2FsIGNvcnJlbGF0aW9uIHJhbmdlIGZvciB0aGUgc3RhdGlvbmFyeSBtb2RlbCB3aXRoICRcXG51JCBlc3RpbWF0ZWQuIil9CiMgQ3JlYXRlIGEgcGxvdCBvZiB0aGUgc3RhbmRhcmQgZGV2aWF0aW9uCnMgPC0gZ3JhcGgkcGxvdF9mdW5jdGlvbihYID0gZXN0X3NpZ21hX3N0YXRudWVzdCwgdmVydGV4X3NpemUgPSAwLCBwbG90bHkgPSBGQUxTRSkgKwogIGdndGl0bGUoIlN0YW5kYXJkIGRldmlhdGlvbiIpICsKICB0aGVtZV9taW5pbWFsKCkgKwogIHRoZW1lKHRleHQgPSBlbGVtZW50X3RleHQoZmFtaWx5ID0gIlBhbGF0aW5vIikpCiMgQ3JlYXRlIGEgcGxvdCBvZiB0aGUgcHJhY3RpY2FsIGNvcnJlbGF0aW9uIHJhbmdlCnIgPC0gZ3JhcGgkcGxvdF9mdW5jdGlvbihYID0gZXN0X3JhbmdlX3N0YXRudWVzdCwgdmVydGV4X3NpemUgPSAwLCBwbG90bHkgPSBGQUxTRSkgKwogIGdndGl0bGUoIlByYWN0aWNhbCBjb3JyZWxhdGlvbiByYW5nZSIpICsKICB0aGVtZV9taW5pbWFsKCkgKwogIHRoZW1lKHRleHQgPSBlbGVtZW50X3RleHQoZmFtaWx5ID0gIlBhbGF0aW5vIikpCnNyIDwtIHMgKyByCnByaW50KHNyKQpgYGAKCgpCZWxvdyB3ZSBjb25zaWRlciB0aGUgcGFyYW1ldGVycyBvYnRhaW5lZCBmb3IgdGhlIG5vbi1zdGF0aW9uYXJ5IG1vZGVsIHdpdGggJFxudSA9IGVzdCQuCgoKYGBge3J9CnRoZXRhX25vbnN0YXRudWVzdCA8LSBtZWFuX2FuZF9tb2RlX3BhcmFtc19ub25zdGF0bnVlc3RbMzo2LDFdCm51X25vbnN0YXRudWVzdCA8LSBtZWFuX2FuZF9tb2RlX3BhcmFtc19ub25zdGF0bnVlc3RbNywxXQpvcF9ub25zdGF0bnVlc3QgPC0gclNQREU6OnNwZGUubWF0ZXJuLm9wZXJhdG9ycyhncmFwaCA9IGdyYXBoLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJhbWV0ZXJpemF0aW9uID0gInNwZGUiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBCLnRhdSA9IEIudGF1LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBCLmthcHBhID0gQi5rYXBwYSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhldGEgPSB0aGV0YV9ub25zdGF0bnVlc3QsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFscGhhID0gMC41ICsgbnVfbm9uc3RhdG51ZXN0KQoKCiMgUHJlY2lzaW9uIG1hdHJpeApRX25vbnN0YXRudWVzdCA8LSBwcmVjaXNpb24ob3Bfbm9uc3RhdG51ZXN0KQplc3Rfc2lnbWFfbm9uc3RhdG51ZXN0IDwtIHNxcnQoZGlhZyhJTkxBOjppbmxhLnFpbnYoUV9ub25zdGF0bnVlc3QpKSkgCmVzdF9yYW5nZV9ub25zdGF0bnVlc3QgPC0gY29tcHV0ZV9wY3Iob3Bfbm9uc3RhdG51ZXN0LCBjb3JfdGhyZXNob2xkKQoKZXN0X3RhdV9ub25zdGF0bnVlc3QgPC0gZXhwKEIudGF1WywtMV0lKiV0aGV0YV9ub25zdGF0bnVlc3QpCmVzdF9rYXBwYV9ub25zdGF0bnVlc3QgPC0gZXhwKEIua2FwcGFbLC0xXSUqJXRoZXRhX25vbnN0YXRudWVzdCkKYGBgCgoKYGBge3IsIGZpZy53aWR0aCA9IDkuMjIsIGZpZy5oZWlnaHQgPSA3LjA1LCBmaWcuY2FwID0gY2FwdGlvbmVyKCJTdGFuZGFyZCBkZXZpYXRpb24sIHByYWN0aWNhbCBjb3JyZWxhdGlvbiByYW5nZSwgdGhlIG1vZGVsIGZvciB0YXUsIGFuZCB0aGUgbW9kZWwgZm9yIGthcHBhIGZvciB0aGUgbm9uLXN0YXRpb25hcnkgbW9kZWwgd2l0aCAkXFxudSQgZXN0aW1hdGVkLiIpfQojIENyZWF0ZSBhIHBsb3Qgb2YgdGhlIHN0YW5kYXJkIGRldmlhdGlvbgpzIDwtIGdyYXBoJHBsb3RfZnVuY3Rpb24oWCA9IGVzdF9zaWdtYV9ub25zdGF0bnVlc3QsIHZlcnRleF9zaXplID0gMCwgcGxvdGx5ID0gRkFMU0UpICsKICBnZ3RpdGxlKCJTdGFuZGFyZCBkZXZpYXRpb24iKSArCiAgdGhlbWVfbWluaW1hbCgpICsKICB0aGVtZSh0ZXh0ID0gZWxlbWVudF90ZXh0KGZhbWlseSA9ICJQYWxhdGlubyIpKQojIENyZWF0ZSBhIHBsb3Qgb2YgdGhlIHByYWN0aWNhbCBjb3JyZWxhdGlvbiByYW5nZQpyIDwtIGdyYXBoJHBsb3RfZnVuY3Rpb24oWCA9IGVzdF9yYW5nZV9ub25zdGF0bnVlc3QsIHZlcnRleF9zaXplID0gMCwgcGxvdGx5ID0gRkFMU0UpICsKICBnZ3RpdGxlKCJQcmFjdGljYWwgY29ycmVsYXRpb24gcmFuZ2UiKSArCiAgdGhlbWVfbWluaW1hbCgpICsKICB0aGVtZSh0ZXh0ID0gZWxlbWVudF90ZXh0KGZhbWlseSA9ICJQYWxhdGlubyIpKQp1IDwtIGdyYXBoJHBsb3RfZnVuY3Rpb24oWCA9IGVzdF90YXVfbm9uc3RhdG51ZXN0LCB2ZXJ0ZXhfc2l6ZSA9IDAsIHBsb3RseSA9IEZBTFNFKSArCiAgZ2d0aXRsZSgiTW9kZWwgZm9yIHRhdSIpICsKICB0aGVtZV9taW5pbWFsKCkgKwogIHRoZW1lKHRleHQgPSBlbGVtZW50X3RleHQoZmFtaWx5ID0gIlBhbGF0aW5vIikpCiMgQ3JlYXRlIGEgcGxvdCBvZiB0aGUgcHJhY3RpY2FsIGNvcnJlbGF0aW9uIHJhbmdlCmsgPC0gZ3JhcGgkcGxvdF9mdW5jdGlvbihYID0gZXN0X2thcHBhX25vbnN0YXRudWVzdCwgdmVydGV4X3NpemUgPSAwLCBwbG90bHkgPSBGQUxTRSkgKwogIGdndGl0bGUoIk1vZGVsIGZvciBrYXBwYSIpICsKICB0aGVtZV9taW5pbWFsKCkgKwogIHRoZW1lKHRleHQgPSBlbGVtZW50X3RleHQoZmFtaWx5ID0gIlBhbGF0aW5vIikpCnNydWsgPC0gKHMgKyByKSAvICh1ICsgaykKcHJpbnQoc3J1aykKYGBgCgoKYGBge3J9Cmxpc3RfcGVtc19yZXBsMyA8LSBsaXN0KGVzdF9zaWdtYV9zdGF0bnUwLjUgPSBlc3Rfc2lnbWFfc3RhdG51MC41LAogICAgICAgICAgICAgICAgICAgICAgICBlc3RfcmFuZ2Vfc3RhdG51MC41ID0gZXN0X3JhbmdlX3N0YXRudTAuNSwKICAgICAgICAgICAgICAgICAgICAgICAgZXN0X3NpZ21hX25vbnN0YXRudTAuNSA9IGVzdF9zaWdtYV9ub25zdGF0bnUwLjUsCiAgICAgICAgICAgICAgICAgICAgICAgIGVzdF9yYW5nZV9ub25zdGF0bnUwLjUgPSBlc3RfcmFuZ2Vfbm9uc3RhdG51MC41LAogICAgICAgICAgICAgICAgICAgICAgICBlc3RfdGF1X25vbnN0YXRudTAuNSA9IGVzdF90YXVfbm9uc3RhdG51MC41LAogICAgICAgICAgICAgICAgICAgICAgICBlc3Rfa2FwcGFfbm9uc3RhdG51MC41ID0gZXN0X2thcHBhX25vbnN0YXRudTAuNSwKICAgICAgICAgICAgICAgICAgICAgICAgZXN0X3NpZ21hX3N0YXRudTEuNSA9IGVzdF9zaWdtYV9zdGF0bnUxLjUsCiAgICAgICAgICAgICAgICAgICAgICAgIGVzdF9yYW5nZV9zdGF0bnUxLjUgPSBlc3RfcmFuZ2Vfc3RhdG51MS41LAogICAgICAgICAgICAgICAgICAgICAgICBlc3Rfc2lnbWFfbm9uc3RhdG51MS41ID0gZXN0X3NpZ21hX25vbnN0YXRudTEuNSwKICAgICAgICAgICAgICAgICAgICAgICAgZXN0X3JhbmdlX25vbnN0YXRudTEuNSA9IGVzdF9yYW5nZV9ub25zdGF0bnUxLjUsCiAgICAgICAgICAgICAgICAgICAgICAgIGVzdF90YXVfbm9uc3RhdG51MS41ID0gZXN0X3RhdV9ub25zdGF0bnUxLjUsCiAgICAgICAgICAgICAgICAgICAgICAgIGVzdF9rYXBwYV9ub25zdGF0bnUxLjUgPSBlc3Rfa2FwcGFfbm9uc3RhdG51MS41LAogICAgICAgICAgICAgICAgICAgICAgICBlc3Rfc2lnbWFfc3RhdG51ZXN0ID0gZXN0X3NpZ21hX3N0YXRudWVzdCwKICAgICAgICAgICAgICAgICAgICAgICAgZXN0X3JhbmdlX3N0YXRudWVzdCA9IGVzdF9yYW5nZV9zdGF0bnVlc3QsCiAgICAgICAgICAgICAgICAgICAgICAgIGVzdF9zaWdtYV9ub25zdGF0bnVlc3QgPSBlc3Rfc2lnbWFfbm9uc3RhdG51ZXN0LAogICAgICAgICAgICAgICAgICAgICAgICBlc3RfcmFuZ2Vfbm9uc3RhdG51ZXN0ID0gZXN0X3JhbmdlX25vbnN0YXRudWVzdCwKICAgICAgICAgICAgICAgICAgICAgICAgZXN0X3RhdV9ub25zdGF0bnVlc3QgPSBlc3RfdGF1X25vbnN0YXRudWVzdCwKICAgICAgICAgICAgICAgICAgICAgICAgZXN0X2thcHBhX25vbnN0YXRudWVzdCA9IGVzdF9rYXBwYV9ub25zdGF0bnVlc3QsCiAgICAgICAgICAgICAgICAgICAgICAgIGdyYXBoID0gZ3JhcGgpCiMgU2F2ZSB0aGUgcmVzdWx0cwpzYXZlKGxpc3RfcGVtc19yZXBsMywgZmlsZSA9IGhlcmUoImRhdGFfZmlsZXMvcGVtc19yZXBsM19yZXN1bHRzLlJEYXRhIikpCmBgYAoKIyBSZWZlcmVuY2VzCgpgYGB7cn0KY2l0ZV9wYWNrYWdlcyhvdXRwdXQgPSAicGFyYWdyYXBoIiwgb3V0LmRpciA9ICIuIikKYGBgCgoK</div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("pems_repl3.Rmd");
  window.initializeCodeFolding("show" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
