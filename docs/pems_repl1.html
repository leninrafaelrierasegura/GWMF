<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>PeMS 1, covariates and preprocessing</title>

<script src="site_libs/header-attrs-2.28/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<script src="site_libs/clipboard-2.0.6/clipboard.min.js"></script>
<link href="site_libs/xaringanExtra-clipboard-0.2.6/xaringanExtra-clipboard.css" rel="stylesheet" />
<script src="site_libs/xaringanExtra-clipboard-0.2.6/xaringanExtra-clipboard.js"></script>
<script>window.xaringanExtraClipboard(null, {"button":"<i class=\"fa-solid fa-clipboard\" style=\"color: #00008B\"><\/i>","success":"<i class=\"fa fa-check\" style=\"color: #90BE6D\"><\/i>","error":"<i class=\"fa fa-times-circle\" style=\"color: #F94144\"><\/i>"})</script>
<link href="site_libs/font-awesome-6.4.2/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>


<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>

<style type="text/css">
/* for pandoc --citeproc since 2.11 */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">GWMF</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    PeMS
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="pems_repl1.html">PeMS 1</a>
    </li>
    <li>
      <a href="pems_repl2.html">PeMS 2</a>
    </li>
    <li>
      <a href="pems_repl3.html">PeMS 3</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Model Properties
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="model_properties1.html">Model Properties 1</a>
    </li>
    <li>
      <a href="model_properties2.html">Model Properties 2</a>
    </li>
  </ul>
</li>
<li>
  <a href="basis_functions.html">Basis Functions</a>
</li>
<li>
  <a href="approximation.html">Approximation</a>
</li>
<li>
  <a href="numerical_error.html">Numerical Error</a>
</li>
<li>
  <a href="convergence_rates.html">Convergence Rates</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/leninrafaelrierasegura/GWMF">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">PeMS 1, covariates and preprocessing</h1>
<h4 class="date">Created: 05-07-2024. Last modified: 14-10-2024.</h4>

</div>


<style type="text/css">
body .main-container {
  max-width: 100% !important;
  width: 100% !important;
}
body {
  max-width: 100% !important;
}

body, td {
   font-size: 16px;
}
code.r{
  font-size: 14px;
}
pre {
  font-size: 14px
}
.custom-box {
  background-color: #f5f7fa; /* Light grey-blue background */
  border-color: #e1e8ed; /* Light border color */
  color: #2c3e50; /* Dark text color */
  padding: 15px; /* Padding inside the box */
  border-radius: 5px; /* Rounded corners */
  margin-bottom: 20px; /* Spacing below the box */
}
.caption {
  margin: auto;
  text-align: center;
  margin-bottom: 20px; /* Spacing below the box */
}
</style>
<p>Go back to the <a href="about.html">About page</a>.</p>
<div class="custom-box">
<p>This vignette processes half of the PeMS dataset, shows some
illustrations, and produces <a
href="https://github.com/leninrafaelrierasegura/GWMF/blob/main/data_files/pems_repl1_data.RData"><strong><code>pems_repl1_data.RData</code></strong></a>,
which is a file that contains the graph with data and a covariate
defined on the mesh. To see how the data is modeled, go to <a
href="pems_repl2.html">pems_repl2.html</a>.</p>
</div>
<p>Let us set some global options for all code chunks in this
document.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="co"># Set seed for reproducibility</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1982</span>) </span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="co"># Set global options for all code chunks</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>  <span class="co"># Disable messages printed by R code chunks</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>  <span class="at">message =</span> <span class="cn">FALSE</span>,    </span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>  <span class="co"># Disable warnings printed by R code chunks</span></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>  <span class="at">warning =</span> <span class="cn">FALSE</span>,    </span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>  <span class="co"># Show R code within code chunks in output</span></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a>  <span class="at">echo =</span> <span class="cn">TRUE</span>,        </span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a>  <span class="co"># Include both R code and its results in output</span></span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a>  <span class="at">include =</span> <span class="cn">TRUE</span>,     </span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a>  <span class="co"># Evaluate R code chunks</span></span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a>  <span class="at">eval =</span> <span class="cn">TRUE</span>,       </span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a>  <span class="co"># Enable caching of R code chunks for faster rendering</span></span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a>  <span class="at">cache =</span> <span class="cn">FALSE</span>,      </span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a>  <span class="co"># Align figures in the center of the output</span></span>
<span id="cb1-18"><a href="#cb1-18" tabindex="-1"></a>  <span class="at">fig.align =</span> <span class="st">&quot;center&quot;</span>,</span>
<span id="cb1-19"><a href="#cb1-19" tabindex="-1"></a>  <span class="co"># Enable retina display for high-resolution figures</span></span>
<span id="cb1-20"><a href="#cb1-20" tabindex="-1"></a>  <span class="at">retina =</span> <span class="dv">2</span>,</span>
<span id="cb1-21"><a href="#cb1-21" tabindex="-1"></a>  <span class="co"># Show errors in the output instead of stopping rendering</span></span>
<span id="cb1-22"><a href="#cb1-22" tabindex="-1"></a>  <span class="at">error =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1-23"><a href="#cb1-23" tabindex="-1"></a>  <span class="co"># Do not collapse code and output into a single block</span></span>
<span id="cb1-24"><a href="#cb1-24" tabindex="-1"></a>  <span class="at">collapse =</span> <span class="cn">FALSE</span></span>
<span id="cb1-25"><a href="#cb1-25" tabindex="-1"></a>)</span></code></pre></div>
<p>Below we load the necessary libraries.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">library</span>(INLA)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="fu">library</span>(inlabru)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="fu">library</span>(rSPDE)</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="fu">library</span>(MetricGraph)</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a><span class="fu">library</span>(ggpubr) <span class="co">#annotate_figure()</span></span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a><span class="fu">library</span>(grid) <span class="co">#textGrob()</span></span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a><span class="fu">library</span>(ggmap)</span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a></span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a><span class="fu">library</span>(OpenStreetMap)</span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a></span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a></span>
<span id="cb2-21"><a href="#cb2-21" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb2-22"><a href="#cb2-22" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb2-23"><a href="#cb2-23" tabindex="-1"></a></span>
<span id="cb2-24"><a href="#cb2-24" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb2-25"><a href="#cb2-25" tabindex="-1"></a><span class="fu">library</span>(rmarkdown)</span>
<span id="cb2-26"><a href="#cb2-26" tabindex="-1"></a><span class="fu">library</span>(grateful) <span class="co"># Cite all loaded packages</span></span></code></pre></div>
<p>Below we define the function <code>captioner()</code> to generate
captions for the figures and the function
<code>gets_summary_parameters()</code> to extract the summary of the
parameters of the model.</p>
<div style="color: blue;">
<hr />
<p><strong>Press the Show button below to reveal the code.</strong></p>
<hr />
</div>
<div class="sourceCode" id="cb3"><pre
class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># Start the figure counter</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>fig_count <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="co"># Define the captioner function</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>captioner <span class="ot">&lt;-</span> <span class="cf">function</span>(caption) {</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>  fig_count <span class="ot">&lt;&lt;-</span> fig_count <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>  <span class="fu">paste0</span>(<span class="st">&quot;Figure &quot;</span>, fig_count, <span class="st">&quot;: &quot;</span>, caption)</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>}</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>gets_summary_parameters <span class="ot">&lt;-</span> <span class="cf">function</span>(fit, model) {</span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>  param_spde <span class="ot">&lt;-</span> <span class="fu">summary</span>(<span class="fu">rspde.result</span>(fit, <span class="st">&quot;field&quot;</span>, model, <span class="at">parameterization =</span> <span class="st">&quot;spde&quot;</span>))</span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a>  param_matern <span class="ot">&lt;-</span> <span class="fu">summary</span>(<span class="fu">rspde.result</span>(fit, <span class="st">&quot;field&quot;</span>, model, <span class="at">parameterization =</span> <span class="st">&quot;matern&quot;</span>))</span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a>  param_fixed <span class="ot">&lt;-</span> fit<span class="sc">$</span>summary.fixed[,<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>]</span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a>  marginal.posterior.sigma_e <span class="ot">=</span> <span class="fu">inla.tmarginal</span>(</span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a>    <span class="at">fun =</span> <span class="cf">function</span>(x) <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">/</span><span class="dv">2</span>), </span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a>    <span class="at">marginal =</span> fit[[<span class="st">&quot;internal.marginals.hyperpar&quot;</span>]][[<span class="st">&quot;Log precision for the Gaussian observations&quot;</span>]])</span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a>  quant.sigma_e <span class="ot">&lt;-</span> <span class="fu">capture.output</span>({result_tmp <span class="ot">&lt;-</span> <span class="fu">inla.zmarginal</span>(marginal.posterior.sigma_e)}, <span class="at">file =</span> <span class="st">&quot;/dev/null&quot;</span>) </span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a>  quant.sigma_e <span class="ot">&lt;-</span> result_tmp</span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a>  statistics.sigma_e <span class="ot">&lt;-</span> <span class="fu">unlist</span>(quant.sigma_e)[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">7</span>)]</span>
<span id="cb3-18"><a href="#cb3-18" tabindex="-1"></a>  mode.sigma_e <span class="ot">&lt;-</span> <span class="fu">inla.mmarginal</span>(marginal.posterior.sigma_e)</span>
<span id="cb3-19"><a href="#cb3-19" tabindex="-1"></a>  allparams <span class="ot">&lt;-</span> <span class="fu">rbind</span>(param_fixed, param_spde, param_matern, <span class="fu">c</span>(statistics.sigma_e, mode.sigma_e))</span>
<span id="cb3-20"><a href="#cb3-20" tabindex="-1"></a>  <span class="fu">rownames</span>(allparams)[<span class="fu">nrow</span>(allparams)] <span class="ot">&lt;-</span> <span class="st">&quot;sigma_e&quot;</span></span>
<span id="cb3-21"><a href="#cb3-21" tabindex="-1"></a>  <span class="fu">return</span>(allparams)</span>
<span id="cb3-22"><a href="#cb3-22" tabindex="-1"></a>}</span></code></pre></div>
<!-- Object `pems_repl` below is available after loading `MetricGraph` library. -->
<!-- ```{r} -->
<!-- # Load the data -->
<!-- pems_data <- pems_repl$data -->
<!-- # Select the locations, which are common for all replicates -->
<!-- PtE_all <- pems_data[1:319, c("edge_number", "distance_on_edge")] -->
<!-- # Select the response variable and transform it to a matrix -->
<!-- Y_all <- matrix(pems_data$y, nrow = 26, ncol = 319, byrow = TRUE) -->
<!-- # Remove locations, those with the same value in the first 13 replicates -->
<!-- all_same <- function(col) {length(unique(col[1:13])) == 1} -->
<!-- cols_to_keep <- apply(Y_all, 2, function(col) !all_same(col)) -->
<!-- Y_loc <- Y_all[, cols_to_keep] -->
<!-- PtE <- PtE_all[cols_to_keep,] -->
<!-- # Check the dimensions -->
<!-- PtE |> dim() -->
<!-- Y_loc |> dim() -->
<!-- ``` -->
<!-- Half of the replicates are used to compute summary statistics (`Y_logstd` and `Y_mean`) and the other half (`Y`) are used to fit the model. -->
<!-- ```{r} -->
<!-- # First half of the replicates for summary statistics -->
<!-- Y_for_summary <- Y_loc[1:13,] -->
<!-- # Reserve the second half for fitting replicate model -->
<!-- Y <- Y_loc[14:26,] -->
<!-- # Compute the log standard deviation and mean -->
<!-- Y_logstd <- apply(Y_for_summary, 2, sd) |> as.vector() |> log() -->
<!-- Y_mean <- apply(Y_for_summary, 2, mean) |> as.vector() -->
<!-- # Check the dimensions -->
<!-- Y |> dim() -->
<!-- ``` -->
<hr />
<p>Folder <code>data.pems</code> was downloaded from this <a
href="https://github.com/davidbolin/MetricGraph/tree/7f4c90171c40b9bf7ea29e9b048c93d88477c5d1/examples/data.pems">GitHub
repository</a>.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>Lines <span class="ot">&lt;-</span> <span class="fu">read_sf</span>(<span class="fu">here</span>(<span class="st">&quot;data_files/data.pems/lines.shp&quot;</span>))</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>lines <span class="ot">&lt;-</span> <span class="fu">as_Spatial</span>(Lines)</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>EtV <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">here</span>(<span class="st">&quot;data_files/data.pems/E.csv&quot;</span>), <span class="at">header =</span> T, <span class="at">row.names =</span> <span class="cn">NULL</span>)</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>PtE <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">here</span>(<span class="st">&quot;data_files/data.pems/PtE.csv&quot;</span>), <span class="at">header =</span> T, <span class="at">row.names =</span> <span class="cn">NULL</span>)</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>PtE[,<span class="dv">1</span>] <span class="ot">&lt;-</span> PtE[,<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">here</span>(<span class="st">&quot;data_files/data.pems/Y.csv&quot;</span>), <span class="at">header =</span> T, <span class="at">row.names =</span> <span class="cn">NULL</span>)</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(Y[,<span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>edge_length_m <span class="ot">&lt;-</span> EtV[,<span class="dv">4</span>]</span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a>PtE[,<span class="dv">2</span>] <span class="ot">=</span> PtE[,<span class="dv">2</span>]<span class="sc">/</span>edge_length_m[PtE[,<span class="dv">1</span>]]</span></code></pre></div>
<p>Matrix <code>Y</code> has dimension 26, 325. Each row of
<code>Y</code> corresponds to a replicate (26 replicates in total) and
each column corresponds to a location (325 locations in total) on the
network.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">plot</span>(lines)</span></code></pre></div>
<p><img src="pems_repl1_files/figure-html/unnamed-chunk-6-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>PtE <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="dv">5</span>) <span class="sc">|&gt;</span> <span class="fu">paged_table</span>()</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["E"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["length"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"12","2":"0.8936639","_rn_":"1"},{"1":"681","2":"0.8945421","_rn_":"2"},{"1":"411","2":"0.8465329","_rn_":"3"},{"1":"503","2":"0.4627782","_rn_":"4"},{"1":"259","2":"0.7229462","_rn_":"5"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>PtE <span class="sc">|&gt;</span> <span class="fu">dim</span>()</span></code></pre></div>
<pre><code>## [1] 325   2</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>Y <span class="sc">|&gt;</span> <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="dv">5</span>) <span class="sc">|&gt;</span> <span class="fu">paged_table</span>()</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["X400001"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["X400017"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["X400030"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["X400040"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["X400045"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["X400052"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["X400057"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["X400059"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["X400065"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["X400069"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["X400073"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["X400084"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["X400085"],"name":[13],"type":["dbl"],"align":["right"]},{"label":["X400088"],"name":[14],"type":["dbl"],"align":["right"]},{"label":["X400096"],"name":[15],"type":["dbl"],"align":["right"]},{"label":["X400097"],"name":[16],"type":["dbl"],"align":["right"]},{"label":["X400100"],"name":[17],"type":["dbl"],"align":["right"]},{"label":["X400104"],"name":[18],"type":["dbl"],"align":["right"]},{"label":["X400109"],"name":[19],"type":["dbl"],"align":["right"]},{"label":["X400122"],"name":[20],"type":["dbl"],"align":["right"]},{"label":["X400147"],"name":[21],"type":["dbl"],"align":["right"]},{"label":["X400148"],"name":[22],"type":["dbl"],"align":["right"]},{"label":["X400149"],"name":[23],"type":["dbl"],"align":["right"]},{"label":["X400158"],"name":[24],"type":["dbl"],"align":["right"]},{"label":["X400160"],"name":[25],"type":["dbl"],"align":["right"]},{"label":["X400168"],"name":[26],"type":["dbl"],"align":["right"]},{"label":["X400172"],"name":[27],"type":["dbl"],"align":["right"]},{"label":["X400174"],"name":[28],"type":["dbl"],"align":["right"]},{"label":["X400178"],"name":[29],"type":["dbl"],"align":["right"]},{"label":["X400185"],"name":[30],"type":["dbl"],"align":["right"]},{"label":["X400201"],"name":[31],"type":["dbl"],"align":["right"]},{"label":["X400206"],"name":[32],"type":["dbl"],"align":["right"]},{"label":["X400209"],"name":[33],"type":["dbl"],"align":["right"]},{"label":["X400213"],"name":[34],"type":["dbl"],"align":["right"]},{"label":["X400221"],"name":[35],"type":["dbl"],"align":["right"]},{"label":["X400222"],"name":[36],"type":["dbl"],"align":["right"]},{"label":["X400227"],"name":[37],"type":["dbl"],"align":["right"]},{"label":["X400236"],"name":[38],"type":["dbl"],"align":["right"]},{"label":["X400238"],"name":[39],"type":["dbl"],"align":["right"]},{"label":["X400240"],"name":[40],"type":["dbl"],"align":["right"]},{"label":["X400246"],"name":[41],"type":["dbl"],"align":["right"]},{"label":["X400253"],"name":[42],"type":["dbl"],"align":["right"]},{"label":["X400257"],"name":[43],"type":["dbl"],"align":["right"]},{"label":["X400258"],"name":[44],"type":["dbl"],"align":["right"]},{"label":["X400268"],"name":[45],"type":["dbl"],"align":["right"]},{"label":["X400274"],"name":[46],"type":["dbl"],"align":["right"]},{"label":["X400278"],"name":[47],"type":["dbl"],"align":["right"]},{"label":["X400280"],"name":[48],"type":["dbl"],"align":["right"]},{"label":["X400292"],"name":[49],"type":["dbl"],"align":["right"]},{"label":["X400296"],"name":[50],"type":["dbl"],"align":["right"]},{"label":["X400298"],"name":[51],"type":["dbl"],"align":["right"]},{"label":["X400330"],"name":[52],"type":["dbl"],"align":["right"]},{"label":["X400336"],"name":[53],"type":["dbl"],"align":["right"]},{"label":["X400343"],"name":[54],"type":["dbl"],"align":["right"]},{"label":["X400353"],"name":[55],"type":["dbl"],"align":["right"]},{"label":["X400372"],"name":[56],"type":["dbl"],"align":["right"]},{"label":["X400394"],"name":[57],"type":["dbl"],"align":["right"]},{"label":["X400400"],"name":[58],"type":["dbl"],"align":["right"]},{"label":["X400414"],"name":[59],"type":["dbl"],"align":["right"]},{"label":["X400418"],"name":[60],"type":["dbl"],"align":["right"]},{"label":["X400429"],"name":[61],"type":["dbl"],"align":["right"]},{"label":["X400435"],"name":[62],"type":["dbl"],"align":["right"]},{"label":["X400436"],"name":[63],"type":["dbl"],"align":["right"]},{"label":["X400440"],"name":[64],"type":["dbl"],"align":["right"]},{"label":["X400449"],"name":[65],"type":["dbl"],"align":["right"]},{"label":["X400457"],"name":[66],"type":["dbl"],"align":["right"]},{"label":["X400461"],"name":[67],"type":["dbl"],"align":["right"]},{"label":["X400464"],"name":[68],"type":["dbl"],"align":["right"]},{"label":["X400479"],"name":[69],"type":["dbl"],"align":["right"]},{"label":["X400485"],"name":[70],"type":["dbl"],"align":["right"]},{"label":["X400499"],"name":[71],"type":["dbl"],"align":["right"]},{"label":["X400507"],"name":[72],"type":["dbl"],"align":["right"]},{"label":["X400508"],"name":[73],"type":["dbl"],"align":["right"]},{"label":["X400514"],"name":[74],"type":["dbl"],"align":["right"]},{"label":["X400519"],"name":[75],"type":["dbl"],"align":["right"]},{"label":["X400528"],"name":[76],"type":["dbl"],"align":["right"]},{"label":["X400545"],"name":[77],"type":["dbl"],"align":["right"]},{"label":["X400560"],"name":[78],"type":["dbl"],"align":["right"]},{"label":["X400563"],"name":[79],"type":["dbl"],"align":["right"]},{"label":["X400567"],"name":[80],"type":["dbl"],"align":["right"]},{"label":["X400581"],"name":[81],"type":["dbl"],"align":["right"]},{"label":["X400582"],"name":[82],"type":["dbl"],"align":["right"]},{"label":["X400586"],"name":[83],"type":["dbl"],"align":["right"]},{"label":["X400637"],"name":[84],"type":["dbl"],"align":["right"]},{"label":["X400643"],"name":[85],"type":["dbl"],"align":["right"]},{"label":["X400648"],"name":[86],"type":["dbl"],"align":["right"]},{"label":["X400649"],"name":[87],"type":["dbl"],"align":["right"]},{"label":["X400654"],"name":[88],"type":["dbl"],"align":["right"]},{"label":["X400664"],"name":[89],"type":["dbl"],"align":["right"]},{"label":["X400665"],"name":[90],"type":["dbl"],"align":["right"]},{"label":["X400668"],"name":[91],"type":["dbl"],"align":["right"]},{"label":["X400673"],"name":[92],"type":["dbl"],"align":["right"]},{"label":["X400677"],"name":[93],"type":["dbl"],"align":["right"]},{"label":["X400687"],"name":[94],"type":["dbl"],"align":["right"]},{"label":["X400688"],"name":[95],"type":["dbl"],"align":["right"]},{"label":["X400690"],"name":[96],"type":["dbl"],"align":["right"]},{"label":["X400700"],"name":[97],"type":["dbl"],"align":["right"]},{"label":["X400709"],"name":[98],"type":["dbl"],"align":["right"]},{"label":["X400713"],"name":[99],"type":["dbl"],"align":["right"]},{"label":["X400714"],"name":[100],"type":["dbl"],"align":["right"]},{"label":["X400715"],"name":[101],"type":["dbl"],"align":["right"]},{"label":["X400717"],"name":[102],"type":["dbl"],"align":["right"]},{"label":["X400723"],"name":[103],"type":["dbl"],"align":["right"]},{"label":["X400743"],"name":[104],"type":["dbl"],"align":["right"]},{"label":["X400750"],"name":[105],"type":["dbl"],"align":["right"]},{"label":["X400760"],"name":[106],"type":["dbl"],"align":["right"]},{"label":["X400772"],"name":[107],"type":["dbl"],"align":["right"]},{"label":["X400790"],"name":[108],"type":["dbl"],"align":["right"]},{"label":["X400792"],"name":[109],"type":["dbl"],"align":["right"]},{"label":["X400794"],"name":[110],"type":["dbl"],"align":["right"]},{"label":["X400799"],"name":[111],"type":["dbl"],"align":["right"]},{"label":["X400804"],"name":[112],"type":["dbl"],"align":["right"]},{"label":["X400822"],"name":[113],"type":["dbl"],"align":["right"]},{"label":["X400823"],"name":[114],"type":["dbl"],"align":["right"]},{"label":["X400828"],"name":[115],"type":["dbl"],"align":["right"]},{"label":["X400832"],"name":[116],"type":["dbl"],"align":["right"]},{"label":["X400837"],"name":[117],"type":["dbl"],"align":["right"]},{"label":["X400842"],"name":[118],"type":["dbl"],"align":["right"]},{"label":["X400863"],"name":[119],"type":["dbl"],"align":["right"]},{"label":["X400869"],"name":[120],"type":["dbl"],"align":["right"]},{"label":["X400873"],"name":[121],"type":["dbl"],"align":["right"]},{"label":["X400895"],"name":[122],"type":["dbl"],"align":["right"]},{"label":["X400904"],"name":[123],"type":["dbl"],"align":["right"]},{"label":["X400907"],"name":[124],"type":["dbl"],"align":["right"]},{"label":["X400911"],"name":[125],"type":["dbl"],"align":["right"]},{"label":["X400916"],"name":[126],"type":["dbl"],"align":["right"]},{"label":["X400922"],"name":[127],"type":["dbl"],"align":["right"]},{"label":["X400934"],"name":[128],"type":["dbl"],"align":["right"]},{"label":["X400951"],"name":[129],"type":["dbl"],"align":["right"]},{"label":["X400952"],"name":[130],"type":["dbl"],"align":["right"]},{"label":["X400953"],"name":[131],"type":["dbl"],"align":["right"]},{"label":["X400964"],"name":[132],"type":["dbl"],"align":["right"]},{"label":["X400965"],"name":[133],"type":["dbl"],"align":["right"]},{"label":["X400970"],"name":[134],"type":["dbl"],"align":["right"]},{"label":["X400971"],"name":[135],"type":["dbl"],"align":["right"]},{"label":["X400973"],"name":[136],"type":["dbl"],"align":["right"]},{"label":["X400995"],"name":[137],"type":["dbl"],"align":["right"]},{"label":["X400996"],"name":[138],"type":["dbl"],"align":["right"]},{"label":["X401014"],"name":[139],"type":["dbl"],"align":["right"]},{"label":["X401129"],"name":[140],"type":["dbl"],"align":["right"]},{"label":["X401154"],"name":[141],"type":["dbl"],"align":["right"]},{"label":["X401163"],"name":[142],"type":["dbl"],"align":["right"]},{"label":["X401167"],"name":[143],"type":["dbl"],"align":["right"]},{"label":["X401210"],"name":[144],"type":["dbl"],"align":["right"]},{"label":["X401224"],"name":[145],"type":["dbl"],"align":["right"]},{"label":["X401327"],"name":[146],"type":["dbl"],"align":["right"]},{"label":["X401351"],"name":[147],"type":["dbl"],"align":["right"]},{"label":["X401388"],"name":[148],"type":["dbl"],"align":["right"]},{"label":["X401391"],"name":[149],"type":["dbl"],"align":["right"]},{"label":["X401400"],"name":[150],"type":["dbl"],"align":["right"]},{"label":["X401403"],"name":[151],"type":["dbl"],"align":["right"]},{"label":["X401440"],"name":[152],"type":["dbl"],"align":["right"]},{"label":["X401457"],"name":[153],"type":["dbl"],"align":["right"]},{"label":["X401464"],"name":[154],"type":["dbl"],"align":["right"]},{"label":["X401489"],"name":[155],"type":["dbl"],"align":["right"]},{"label":["X401495"],"name":[156],"type":["dbl"],"align":["right"]},{"label":["X401507"],"name":[157],"type":["dbl"],"align":["right"]},{"label":["X401534"],"name":[158],"type":["dbl"],"align":["right"]},{"label":["X401541"],"name":[159],"type":["dbl"],"align":["right"]},{"label":["X401555"],"name":[160],"type":["dbl"],"align":["right"]},{"label":["X401560"],"name":[161],"type":["dbl"],"align":["right"]},{"label":["X401567"],"name":[162],"type":["dbl"],"align":["right"]},{"label":["X401597"],"name":[163],"type":["dbl"],"align":["right"]},{"label":["X401606"],"name":[164],"type":["dbl"],"align":["right"]},{"label":["X401611"],"name":[165],"type":["dbl"],"align":["right"]},{"label":["X401655"],"name":[166],"type":["dbl"],"align":["right"]},{"label":["X401808"],"name":[167],"type":["dbl"],"align":["right"]},{"label":["X401809"],"name":[168],"type":["dbl"],"align":["right"]},{"label":["X401810"],"name":[169],"type":["dbl"],"align":["right"]},{"label":["X401811"],"name":[170],"type":["dbl"],"align":["right"]},{"label":["X401816"],"name":[171],"type":["dbl"],"align":["right"]},{"label":["X401817"],"name":[172],"type":["dbl"],"align":["right"]},{"label":["X401845"],"name":[173],"type":["dbl"],"align":["right"]},{"label":["X401846"],"name":[174],"type":["dbl"],"align":["right"]},{"label":["X401890"],"name":[175],"type":["dbl"],"align":["right"]},{"label":["X401891"],"name":[176],"type":["dbl"],"align":["right"]},{"label":["X401906"],"name":[177],"type":["dbl"],"align":["right"]},{"label":["X401908"],"name":[178],"type":["dbl"],"align":["right"]},{"label":["X401926"],"name":[179],"type":["dbl"],"align":["right"]},{"label":["X401936"],"name":[180],"type":["dbl"],"align":["right"]},{"label":["X401937"],"name":[181],"type":["dbl"],"align":["right"]},{"label":["X401942"],"name":[182],"type":["dbl"],"align":["right"]},{"label":["X401943"],"name":[183],"type":["dbl"],"align":["right"]},{"label":["X401948"],"name":[184],"type":["dbl"],"align":["right"]},{"label":["X401957"],"name":[185],"type":["dbl"],"align":["right"]},{"label":["X401958"],"name":[186],"type":["dbl"],"align":["right"]},{"label":["X401994"],"name":[187],"type":["dbl"],"align":["right"]},{"label":["X401996"],"name":[188],"type":["dbl"],"align":["right"]},{"label":["X401997"],"name":[189],"type":["dbl"],"align":["right"]},{"label":["X401998"],"name":[190],"type":["dbl"],"align":["right"]},{"label":["X402056"],"name":[191],"type":["dbl"],"align":["right"]},{"label":["X402057"],"name":[192],"type":["dbl"],"align":["right"]},{"label":["X402058"],"name":[193],"type":["dbl"],"align":["right"]},{"label":["X402059"],"name":[194],"type":["dbl"],"align":["right"]},{"label":["X402060"],"name":[195],"type":["dbl"],"align":["right"]},{"label":["X402061"],"name":[196],"type":["dbl"],"align":["right"]},{"label":["X402067"],"name":[197],"type":["dbl"],"align":["right"]},{"label":["X402117"],"name":[198],"type":["dbl"],"align":["right"]},{"label":["X402118"],"name":[199],"type":["dbl"],"align":["right"]},{"label":["X402119"],"name":[200],"type":["dbl"],"align":["right"]},{"label":["X402120"],"name":[201],"type":["dbl"],"align":["right"]},{"label":["X402121"],"name":[202],"type":["dbl"],"align":["right"]},{"label":["X402281"],"name":[203],"type":["dbl"],"align":["right"]},{"label":["X402282"],"name":[204],"type":["dbl"],"align":["right"]},{"label":["X402283"],"name":[205],"type":["dbl"],"align":["right"]},{"label":["X402284"],"name":[206],"type":["dbl"],"align":["right"]},{"label":["X402285"],"name":[207],"type":["dbl"],"align":["right"]},{"label":["X402286"],"name":[208],"type":["dbl"],"align":["right"]},{"label":["X402287"],"name":[209],"type":["dbl"],"align":["right"]},{"label":["X402288"],"name":[210],"type":["dbl"],"align":["right"]},{"label":["X402289"],"name":[211],"type":["dbl"],"align":["right"]},{"label":["X402359"],"name":[212],"type":["dbl"],"align":["right"]},{"label":["X402360"],"name":[213],"type":["dbl"],"align":["right"]},{"label":["X402361"],"name":[214],"type":["dbl"],"align":["right"]},{"label":["X402362"],"name":[215],"type":["dbl"],"align":["right"]},{"label":["X402363"],"name":[216],"type":["dbl"],"align":["right"]},{"label":["X402364"],"name":[217],"type":["dbl"],"align":["right"]},{"label":["X402365"],"name":[218],"type":["dbl"],"align":["right"]},{"label":["X402366"],"name":[219],"type":["dbl"],"align":["right"]},{"label":["X402367"],"name":[220],"type":["dbl"],"align":["right"]},{"label":["X402368"],"name":[221],"type":["dbl"],"align":["right"]},{"label":["X402369"],"name":[222],"type":["dbl"],"align":["right"]},{"label":["X402370"],"name":[223],"type":["dbl"],"align":["right"]},{"label":["X402371"],"name":[224],"type":["dbl"],"align":["right"]},{"label":["X402372"],"name":[225],"type":["dbl"],"align":["right"]},{"label":["X402373"],"name":[226],"type":["dbl"],"align":["right"]},{"label":["X403225"],"name":[227],"type":["dbl"],"align":["right"]},{"label":["X403265"],"name":[228],"type":["dbl"],"align":["right"]},{"label":["X403329"],"name":[229],"type":["dbl"],"align":["right"]},{"label":["X403401"],"name":[230],"type":["dbl"],"align":["right"]},{"label":["X403402"],"name":[231],"type":["dbl"],"align":["right"]},{"label":["X403404"],"name":[232],"type":["dbl"],"align":["right"]},{"label":["X403406"],"name":[233],"type":["dbl"],"align":["right"]},{"label":["X403409"],"name":[234],"type":["dbl"],"align":["right"]},{"label":["X403412"],"name":[235],"type":["dbl"],"align":["right"]},{"label":["X403414"],"name":[236],"type":["dbl"],"align":["right"]},{"label":["X403419"],"name":[237],"type":["dbl"],"align":["right"]},{"label":["X404370"],"name":[238],"type":["dbl"],"align":["right"]},{"label":["X404434"],"name":[239],"type":["dbl"],"align":["right"]},{"label":["X404435"],"name":[240],"type":["dbl"],"align":["right"]},{"label":["X404444"],"name":[241],"type":["dbl"],"align":["right"]},{"label":["X404451"],"name":[242],"type":["dbl"],"align":["right"]},{"label":["X404452"],"name":[243],"type":["dbl"],"align":["right"]},{"label":["X404453"],"name":[244],"type":["dbl"],"align":["right"]},{"label":["X404461"],"name":[245],"type":["dbl"],"align":["right"]},{"label":["X404462"],"name":[246],"type":["dbl"],"align":["right"]},{"label":["X404521"],"name":[247],"type":["dbl"],"align":["right"]},{"label":["X404522"],"name":[248],"type":["dbl"],"align":["right"]},{"label":["X404553"],"name":[249],"type":["dbl"],"align":["right"]},{"label":["X404554"],"name":[250],"type":["dbl"],"align":["right"]},{"label":["X404585"],"name":[251],"type":["dbl"],"align":["right"]},{"label":["X404586"],"name":[252],"type":["dbl"],"align":["right"]},{"label":["X404640"],"name":[253],"type":["dbl"],"align":["right"]},{"label":["X404753"],"name":[254],"type":["dbl"],"align":["right"]},{"label":["X404759"],"name":[255],"type":["dbl"],"align":["right"]},{"label":["X405613"],"name":[256],"type":["dbl"],"align":["right"]},{"label":["X405619"],"name":[257],"type":["dbl"],"align":["right"]},{"label":["X405701"],"name":[258],"type":["dbl"],"align":["right"]},{"label":["X407150"],"name":[259],"type":["dbl"],"align":["right"]},{"label":["X407151"],"name":[260],"type":["dbl"],"align":["right"]},{"label":["X407152"],"name":[261],"type":["dbl"],"align":["right"]},{"label":["X407153"],"name":[262],"type":["dbl"],"align":["right"]},{"label":["X407155"],"name":[263],"type":["dbl"],"align":["right"]},{"label":["X407157"],"name":[264],"type":["dbl"],"align":["right"]},{"label":["X407161"],"name":[265],"type":["dbl"],"align":["right"]},{"label":["X407165"],"name":[266],"type":["dbl"],"align":["right"]},{"label":["X407172"],"name":[267],"type":["dbl"],"align":["right"]},{"label":["X407173"],"name":[268],"type":["dbl"],"align":["right"]},{"label":["X407174"],"name":[269],"type":["dbl"],"align":["right"]},{"label":["X407176"],"name":[270],"type":["dbl"],"align":["right"]},{"label":["X407177"],"name":[271],"type":["dbl"],"align":["right"]},{"label":["X407179"],"name":[272],"type":["dbl"],"align":["right"]},{"label":["X407180"],"name":[273],"type":["dbl"],"align":["right"]},{"label":["X407181"],"name":[274],"type":["dbl"],"align":["right"]},{"label":["X407184"],"name":[275],"type":["dbl"],"align":["right"]},{"label":["X407185"],"name":[276],"type":["dbl"],"align":["right"]},{"label":["X407186"],"name":[277],"type":["dbl"],"align":["right"]},{"label":["X407187"],"name":[278],"type":["dbl"],"align":["right"]},{"label":["X407190"],"name":[279],"type":["dbl"],"align":["right"]},{"label":["X407191"],"name":[280],"type":["dbl"],"align":["right"]},{"label":["X407194"],"name":[281],"type":["dbl"],"align":["right"]},{"label":["X407200"],"name":[282],"type":["dbl"],"align":["right"]},{"label":["X407202"],"name":[283],"type":["dbl"],"align":["right"]},{"label":["X407204"],"name":[284],"type":["dbl"],"align":["right"]},{"label":["X407206"],"name":[285],"type":["dbl"],"align":["right"]},{"label":["X407207"],"name":[286],"type":["dbl"],"align":["right"]},{"label":["X407321"],"name":[287],"type":["dbl"],"align":["right"]},{"label":["X407323"],"name":[288],"type":["dbl"],"align":["right"]},{"label":["X407325"],"name":[289],"type":["dbl"],"align":["right"]},{"label":["X407328"],"name":[290],"type":["dbl"],"align":["right"]},{"label":["X407331"],"name":[291],"type":["dbl"],"align":["right"]},{"label":["X407332"],"name":[292],"type":["dbl"],"align":["right"]},{"label":["X407335"],"name":[293],"type":["dbl"],"align":["right"]},{"label":["X407336"],"name":[294],"type":["dbl"],"align":["right"]},{"label":["X407337"],"name":[295],"type":["dbl"],"align":["right"]},{"label":["X407339"],"name":[296],"type":["dbl"],"align":["right"]},{"label":["X407341"],"name":[297],"type":["dbl"],"align":["right"]},{"label":["X407342"],"name":[298],"type":["dbl"],"align":["right"]},{"label":["X407344"],"name":[299],"type":["dbl"],"align":["right"]},{"label":["X407348"],"name":[300],"type":["dbl"],"align":["right"]},{"label":["X407352"],"name":[301],"type":["dbl"],"align":["right"]},{"label":["X407359"],"name":[302],"type":["dbl"],"align":["right"]},{"label":["X407360"],"name":[303],"type":["dbl"],"align":["right"]},{"label":["X407361"],"name":[304],"type":["dbl"],"align":["right"]},{"label":["X407364"],"name":[305],"type":["dbl"],"align":["right"]},{"label":["X407367"],"name":[306],"type":["dbl"],"align":["right"]},{"label":["X407370"],"name":[307],"type":["dbl"],"align":["right"]},{"label":["X407372"],"name":[308],"type":["dbl"],"align":["right"]},{"label":["X407373"],"name":[309],"type":["dbl"],"align":["right"]},{"label":["X407374"],"name":[310],"type":["dbl"],"align":["right"]},{"label":["X407710"],"name":[311],"type":["dbl"],"align":["right"]},{"label":["X407711"],"name":[312],"type":["dbl"],"align":["right"]},{"label":["X408907"],"name":[313],"type":["dbl"],"align":["right"]},{"label":["X408911"],"name":[314],"type":["dbl"],"align":["right"]},{"label":["X409524"],"name":[315],"type":["dbl"],"align":["right"]},{"label":["X409525"],"name":[316],"type":["dbl"],"align":["right"]},{"label":["X409526"],"name":[317],"type":["dbl"],"align":["right"]},{"label":["X409528"],"name":[318],"type":["dbl"],"align":["right"]},{"label":["X409529"],"name":[319],"type":["dbl"],"align":["right"]},{"label":["X413026"],"name":[320],"type":["dbl"],"align":["right"]},{"label":["X413845"],"name":[321],"type":["dbl"],"align":["right"]},{"label":["X413877"],"name":[322],"type":["dbl"],"align":["right"]},{"label":["X413878"],"name":[323],"type":["dbl"],"align":["right"]},{"label":["X414284"],"name":[324],"type":["dbl"],"align":["right"]},{"label":["X414694"],"name":[325],"type":["dbl"],"align":["right"]}],"data":[{"1":"70.0","2":"37.3","3":"33.4","4":"29.3","5":"63.8","6":"63.2","7":"9.0","8":"63.9","9":"31.0","10":"11.4","11":"64.0","12":"41.3","13":"65.0","14":"62.4","15":"62.0","16":"20.6","17":"63.9","18":"24.0","19":"50.7","20":"57.0","21":"65.5","22":"60.5","23":"43.7","24":"53.2","25":"64.5","26":"64.4","27":"50.7","28":"68.0","29":"62.1","30":"65.3","31":"64.3","32":"56.5","33":"27.4","34":"46.3","35":"60.0","36":"65.0","37":"66.2","38":"22.6","39":"61.1","40":"65.2","41":"48.3","42":"32.9","43":"42.3","44":"36.9","45":"64.0","46":"59.5","47":"61.8","48":"60.8","49":"24.9","50":"36.4","51":"63.9","52":"29.8","53":"64.2","54":"54.5","55":"62.3","56":"22.1","57":"21.1","58":"63.8","59":"61.4","60":"64.2","61":"33.9","62":"25.7","63":"63.5","64":"56.7","65":"56.4","66":"57.2","67":"62.3","68":"63.9","69":"25.8","70":"67.2","71":"63.3","72":"59.9","73":"34.5","74":"38.3","75":"65.0","76":"17.5","77":"54.2","78":"60.9","79":"66.7","80":"21.2","81":"47.9","82":"65.0","83":"18.6","84":"65.0","85":"10.3","86":"28.1","87":"65.1","88":"64.1","89":"65.0","90":"62.0","91":"64.8","92":"54.6","93":"66.7","94":"56.4","95":"66.9","96":"53.4","97":"29.0","98":"63.8","99":"62.6","100":"53.6","101":"67.1","102":"49.9","103":"45.5","104":"63.8","105":"63.9","106":"68.0","107":"26.9","108":"69.0","109":"21.5","110":"13.7","111":"62.1","112":"63.8","113":"66.4","114":"36.2","115":"20.0","116":"40.7","117":"65.0","118":"65.1","119":"67.7","120":"42.9","121":"41.1","122":"17.3","123":"53.8","124":"65.0","125":"67.7","126":"68.3","127":"51.2","128":"16.9","129":"31.9","130":"65.7","131":"58.7","132":"62.9","133":"66.1","134":"18.5","135":"15.1","136":"19.0","137":"33.5","138":"66.8","139":"55.4","140":"65.1","141":"65.1","142":"13.9","143":"65.6","144":"64.7","145":"25.7","146":"50.7","147":"49.6","148":"38.9","149":"65.1","150":"58.8","151":"65.1","152":"33.4","153":"64.0","154":"61.2","155":"55.6","156":"57.7","157":"56.8","158":"60.0","159":"60.2","160":"62.5","161":"63.9","162":"65.1","163":"65.6","164":"35.4","165":"59.7","166":"65.6","167":"65.4","168":"60.6","169":"54.6","170":"27.3","171":"62.2","172":"66.1","173":"66.0","174":"62.8","175":"66.9","176":"48.1","177":"33.4","178":"63.8","179":"44.2","180":"43.9","181":"48.9","182":"63.5","183":"15.2","184":"59.3","185":"55.4","186":"54.3","187":"50.7","188":"63.8","189":"62.2","190":"62.8","191":"68.2","192":"45.8","193":"34.6","194":"68.2","195":"61.8","196":"27.9","197":"16.2","198":"24.2","199":"62.4","200":"64.3","201":"29.0","202":"15.5","203":"54.8","204":"27.3","205":"63.8","206":"63.8","207":"63.3","208":"65.3","209":"64.5","210":"63.1","211":"42.8","212":"63.8","213":"64.5","214":"63.8","215":"63.8","216":"63.8","217":"63.8","218":"10.4","219":"56.0","220":"25.6","221":"63.8","222":"63.8","223":"63.8","224":"63.8","225":"63.8","226":"63.8","227":"21.9","228":"20.5","229":"64.3","230":"42.8","231":"66.3","232":"63.8","233":"20.4","234":"32.4","235":"43.4","236":"10.6","237":"25.7","238":"66.3","239":"63.9","240":"63.9","241":"63.9","242":"64.3","243":"63.9","244":"43.6","245":"37.1","246":"60.3","247":"65.8","248":"63.8","249":"51.5","250":"63.8","251":"43.5","252":"33.6","253":"63.8","254":"70.7","255":"45.0","256":"63.9","257":"63.9","258":"63.5","259":"65.0","260":"63.7","261":"68.1","262":"65.0","263":"65.8","264":"65.6","265":"65.2","266":"42.5","267":"63.8","268":"63.9","269":"61.3","270":"61.3","271":"60.7","272":"64.6","273":"64.9","274":"63.8","275":"18.0","276":"19.3","277":"19.6","278":"32.3","279":"14.3","280":"15.7","281":"55.3","282":"18.5","283":"40.5","284":"26.0","285":"34.8","286":"63.8","287":"67.0","288":"60.1","289":"64.3","290":"56.8","291":"62.6","292":"63.7","293":"56.2","294":"61.1","295":"62.2","296":"43.1","297":"61.8","298":"59.2","299":"68.2","300":"16.5","301":"22.4","302":"49.3","303":"25.0","304":"26.2","305":"27.2","306":"25.2","307":"59.4","308":"38.5","309":"23.8","310":"24.8","311":"55.5","312":"25.6","313":"63.9","314":"52.2","315":"66.6","316":"63.9","317":"63.3","318":"63.9","319":"63.8","320":"63.4","321":"62.8","322":"54.9","323":"63.8","324":"52.6","325":"62.4","_rn_":"1"},{"1":"69.3","2":"22.4","3":"38.2","4":"61.3","5":"56.2","6":"59.8","7":"36.4","8":"48.7","9":"20.0","10":"11.4","11":"62.1","12":"26.5","13":"54.8","14":"62.3","15":"59.9","16":"19.7","17":"60.9","18":"20.8","19":"50.7","20":"57.7","21":"51.5","22":"56.8","23":"44.0","24":"49.8","25":"58.8","26":"58.1","27":"14.2","28":"67.1","29":"59.4","30":"63.8","31":"57.8","32":"43.1","33":"26.7","34":"48.5","35":"61.3","36":"59.3","37":"60.4","38":"20.0","39":"50.5","40":"61.2","41":"32.2","42":"23.5","43":"33.8","44":"38.3","45":"59.3","46":"52.0","47":"61.0","48":"65.4","49":"34.5","50":"37.7","51":"62.0","52":"25.4","53":"61.6","54":"38.4","55":"52.6","56":"10.3","57":"21.5","58":"60.2","59":"59.2","60":"61.9","61":"26.3","62":"25.2","63":"65.6","64":"42.6","65":"52.5","66":"57.7","67":"52.6","68":"59.2","69":"30.1","70":"63.3","71":"61.8","72":"63.2","73":"25.7","74":"36.3","75":"65.0","76":"18.4","77":"45.7","78":"59.2","79":"65.8","80":"31.6","81":"36.2","82":"18.3","83":"18.8","84":"43.0","85":"17.7","86":"21.8","87":"56.1","88":"62.0","89":"56.6","90":"60.5","91":"60.6","92":"38.4","93":"66.8","94":"51.4","95":"63.4","96":"53.4","97":"27.6","98":"37.3","99":"60.9","100":"42.4","101":"59.5","102":"50.3","103":"44.7","104":"25.3","105":"49.8","106":"68.4","107":"26.9","108":"62.1","109":"25.5","110":"16.6","111":"63.6","112":"63.8","113":"64.4","114":"24.8","115":"13.8","116":"57.6","117":"60.2","118":"65.1","119":"66.1","120":"26.8","121":"39.8","122":"13.7","123":"53.0","124":"51.2","125":"65.6","126":"65.0","127":"34.9","128":"17.6","129":"63.5","130":"62.9","131":"60.7","132":"59.2","133":"64.4","134":"19.5","135":"25.3","136":"18.5","137":"34.7","138":"64.9","139":"48.7","140":"65.1","141":"65.1","142":"17.1","143":"67.4","144":"63.3","145":"23.4","146":"29.0","147":"24.1","148":"33.3","149":"65.1","150":"55.1","151":"65.1","152":"28.8","153":"44.5","154":"64.0","155":"63.1","156":"55.1","157":"54.2","158":"54.1","159":"60.6","160":"55.5","161":"63.9","162":"57.9","163":"57.5","164":"36.0","165":"59.3","166":"65.6","167":"63.0","168":"44.6","169":"58.5","170":"24.3","171":"60.5","172":"64.0","173":"64.7","174":"62.9","175":"64.1","176":"36.0","177":"26.0","178":"63.8","179":"44.6","180":"46.1","181":"47.1","182":"57.9","183":"16.4","184":"50.9","185":"55.9","186":"52.0","187":"35.2","188":"57.3","189":"58.0","190":"58.4","191":"65.9","192":"28.0","193":"28.3","194":"67.8","195":"60.5","196":"33.8","197":"17.6","198":"22.1","199":"67.3","200":"59.7","201":"27.5","202":"17.3","203":"62.4","204":"18.5","205":"60.3","206":"28.2","207":"61.5","208":"60.3","209":"44.8","210":"61.4","211":"37.6","212":"63.8","213":"64.5","214":"63.8","215":"61.0","216":"45.0","217":"63.1","218":"10.6","219":"47.9","220":"29.8","221":"61.1","222":"47.0","223":"63.8","224":"43.0","225":"56.5","226":"35.0","227":"18.6","228":"21.1","229":"67.4","230":"45.2","231":"66.5","232":"46.1","233":"22.9","234":"34.4","235":"45.0","236":"13.5","237":"26.9","238":"67.0","239":"62.2","240":"65.3","241":"50.3","242":"55.7","243":"63.9","244":"50.7","245":"31.7","246":"55.8","247":"58.8","248":"57.5","249":"49.1","250":"37.5","251":"36.0","252":"31.7","253":"60.7","254":"67.2","255":"38.0","256":"62.6","257":"42.4","258":"64.6","259":"63.8","260":"62.2","261":"66.1","262":"63.5","263":"64.3","264":"65.0","265":"65.5","266":"48.7","267":"63.8","268":"52.3","269":"56.8","270":"61.2","271":"60.2","272":"63.3","273":"61.7","274":"60.3","275":"57.7","276":"56.2","277":"18.7","278":"18.5","279":"24.3","280":"19.0","281":"54.3","282":"19.1","283":"37.6","284":"24.2","285":"30.5","286":"34.4","287":"65.0","288":"64.3","289":"67.9","290":"56.1","291":"63.2","292":"63.7","293":"55.0","294":"55.8","295":"61.5","296":"59.1","297":"60.1","298":"57.8","299":"68.3","300":"68.0","301":"20.8","302":"53.0","303":"16.3","304":"24.2","305":"26.6","306":"23.5","307":"60.0","308":"36.1","309":"33.6","310":"29.8","311":"42.5","312":"34.2","313":"63.1","314":"47.2","315":"65.5","316":"65.5","317":"64.8","318":"24.4","319":"39.1","320":"62.2","321":"49.5","322":"56.8","323":"58.8","324":"55.7","325":"61.9","_rn_":"2"},{"1":"71.7","2":"60.6","3":"43.5","4":"41.7","5":"59.4","6":"63.3","7":"61.2","8":"57.3","9":"59.8","10":"61.2","11":"65.3","12":"64.9","13":"59.3","14":"63.4","15":"65.3","16":"64.3","17":"64.8","18":"39.9","19":"50.7","20":"61.3","21":"61.2","22":"56.4","23":"65.0","24":"50.9","25":"66.8","26":"66.3","27":"16.2","28":"67.9","29":"62.7","30":"65.1","31":"62.4","32":"61.7","33":"66.6","34":"64.7","35":"60.9","36":"61.1","37":"63.3","38":"60.1","39":"54.4","40":"61.8","41":"64.8","42":"56.1","43":"43.9","44":"56.7","45":"64.0","46":"63.8","47":"65.6","48":"66.5","49":"63.6","50":"55.8","51":"64.0","52":"61.4","53":"63.9","54":"62.4","55":"62.3","56":"61.3","57":"27.0","58":"61.6","59":"64.5","60":"65.1","61":"60.2","62":"60.1","63":"65.4","64":"59.6","65":"56.1","66":"62.7","67":"57.0","68":"63.3","69":"37.9","70":"64.6","71":"64.9","72":"60.6","73":"50.2","74":"52.5","75":"65.0","76":"63.6","77":"67.3","78":"63.9","79":"67.8","80":"54.8","81":"58.3","82":"59.6","83":"20.4","84":"55.3","85":"64.2","86":"63.0","87":"61.7","88":"63.4","89":"58.0","90":"61.2","91":"64.3","92":"68.2","93":"67.6","94":"61.1","95":"67.5","96":"59.0","97":"56.2","98":"53.4","99":"59.0","100":"62.2","101":"61.4","102":"56.3","103":"58.6","104":"64.3","105":"57.4","106":"69.3","107":"50.3","108":"69.5","109":"67.3","110":"68.5","111":"63.6","112":"63.8","113":"66.7","114":"63.7","115":"64.3","116":"63.0","117":"46.3","118":"65.1","119":"69.2","120":"64.2","121":"53.2","122":"18.6","123":"62.7","124":"64.8","125":"68.6","126":"68.3","127":"36.2","128":"64.6","129":"63.9","130":"65.9","131":"60.9","132":"58.9","133":"65.4","134":"58.6","135":"33.7","136":"59.6","137":"56.0","138":"65.8","139":"55.0","140":"65.1","141":"65.1","142":"65.2","143":"68.6","144":"65.2","145":"62.0","146":"61.2","147":"49.2","148":"63.6","149":"65.1","150":"56.1","151":"65.1","152":"53.0","153":"51.6","154":"63.6","155":"63.9","156":"63.5","157":"66.7","158":"65.2","159":"58.5","160":"58.7","161":"63.9","162":"60.1","163":"61.2","164":"42.4","165":"65.9","166":"65.6","167":"61.8","168":"50.8","169":"61.4","170":"53.4","171":"61.5","172":"63.9","173":"69.1","174":"66.5","175":"65.1","176":"59.0","177":"51.1","178":"63.8","179":"62.7","180":"65.4","181":"62.5","182":"64.5","183":"62.5","184":"58.1","185":"55.9","186":"52.0","187":"65.2","188":"63.4","189":"65.3","190":"65.4","191":"68.3","192":"59.9","193":"57.6","194":"68.3","195":"63.5","196":"59.5","197":"62.0","198":"60.1","199":"70.0","200":"62.8","201":"62.1","202":"31.9","203":"63.0","204":"38.3","205":"60.5","206":"52.9","207":"63.1","208":"62.8","209":"58.1","210":"62.4","211":"54.8","212":"63.8","213":"67.5","214":"63.8","215":"61.5","216":"59.1","217":"65.2","218":"34.8","219":"62.7","220":"63.5","221":"66.2","222":"61.6","223":"63.8","224":"60.4","225":"62.7","226":"60.7","227":"52.1","228":"48.4","229":"67.6","230":"50.0","231":"64.5","232":"65.4","233":"56.0","234":"64.6","235":"63.7","236":"63.2","237":"64.6","238":"65.8","239":"65.0","240":"64.8","241":"63.9","242":"57.9","243":"63.9","244":"60.0","245":"48.2","246":"59.1","247":"65.8","248":"63.2","249":"63.3","250":"60.8","251":"63.4","252":"59.7","253":"64.2","254":"71.2","255":"45.1","256":"63.4","257":"46.5","258":"67.1","259":"66.5","260":"63.1","261":"66.1","262":"65.7","263":"65.1","264":"65.1","265":"66.5","266":"57.3","267":"63.8","268":"59.8","269":"64.8","270":"61.9","271":"60.5","272":"63.8","273":"64.2","274":"61.6","275":"15.2","276":"17.8","277":"19.6","278":"31.0","279":"12.3","280":"14.0","281":"56.4","282":"14.2","283":"54.1","284":"56.8","285":"56.5","286":"48.7","287":"64.6","288":"64.4","289":"59.6","290":"59.9","291":"64.8","292":"63.1","293":"62.6","294":"60.5","295":"63.5","296":"39.5","297":"63.0","298":"60.8","299":"67.5","300":"57.3","301":"59.2","302":"66.6","303":"35.3","304":"53.5","305":"58.6","306":"53.6","307":"67.5","308":"47.7","309":"36.9","310":"61.7","311":"63.1","312":"66.7","313":"63.1","314":"59.6","315":"67.7","316":"69.1","317":"66.3","318":"63.4","319":"60.2","320":"63.2","321":"54.3","322":"66.4","323":"63.1","324":"65.9","325":"64.2","_rn_":"3"},{"1":"72.4","2":"20.7","3":"36.3","4":"32.7","5":"55.7","6":"62.5","7":"57.4","8":"47.7","9":"25.6","10":"11.8","11":"62.2","12":"27.6","13":"51.1","14":"63.3","15":"61.1","16":"26.0","17":"62.0","18":"23.4","19":"50.7","20":"57.3","21":"59.5","22":"61.3","23":"57.6","24":"27.8","25":"59.4","26":"63.8","27":"13.3","28":"66.7","29":"63.6","30":"65.3","31":"64.6","32":"25.4","33":"42.6","34":"52.1","35":"64.0","36":"57.4","37":"67.0","38":"23.7","39":"53.3","40":"64.7","41":"59.8","42":"20.7","43":"33.5","44":"51.7","45":"62.3","46":"56.3","47":"62.8","48":"68.9","49":"34.0","50":"34.6","51":"63.0","52":"24.9","53":"63.2","54":"40.7","55":"61.7","56":"10.4","57":"22.9","58":"62.3","59":"62.5","60":"66.1","61":"31.9","62":"30.6","63":"67.2","64":"49.4","65":"49.6","66":"62.0","67":"56.8","68":"64.7","69":"30.9","70":"65.5","71":"64.4","72":"63.4","73":"25.4","74":"29.0","75":"25.8","76":"21.2","77":"41.0","78":"62.9","79":"68.7","80":"21.5","81":"24.7","82":"23.4","83":"18.3","84":"35.0","85":"21.2","86":"31.3","87":"65.8","88":"66.5","89":"60.5","90":"60.7","91":"66.9","92":"39.7","93":"69.0","94":"55.0","95":"68.1","96":"54.5","97":"28.9","98":"32.9","99":"60.2","100":"56.8","101":"64.9","102":"47.9","103":"34.5","104":"22.8","105":"56.1","106":"68.8","107":"35.5","108":"66.7","109":"27.0","110":"18.7","111":"64.4","112":"63.8","113":"66.6","114":"27.7","115":"20.8","116":"59.8","117":"37.6","118":"65.1","119":"68.6","120":"45.0","121":"38.4","122":"15.3","123":"55.3","124":"50.3","125":"68.1","126":"69.5","127":"34.6","128":"22.2","129":"64.0","130":"66.9","131":"63.1","132":"63.0","133":"67.4","134":"21.2","135":"20.3","136":"19.5","137":"30.8","138":"67.4","139":"33.3","140":"65.1","141":"65.1","142":"22.9","143":"67.7","144":"64.6","145":"29.2","146":"29.9","147":"17.0","148":"36.1","149":"65.1","150":"59.3","151":"65.1","152":"33.2","153":"44.2","154":"62.9","155":"64.5","156":"40.4","157":"56.0","158":"56.2","159":"59.9","160":"57.7","161":"63.9","162":"61.2","163":"61.3","164":"35.6","165":"60.6","166":"65.6","167":"65.0","168":"50.4","169":"61.9","170":"24.5","171":"61.1","172":"62.9","173":"67.1","174":"62.6","175":"66.5","176":"37.5","177":"27.7","178":"63.8","179":"57.5","180":"60.8","181":"59.1","182":"62.3","183":"15.2","184":"52.2","185":"65.0","186":"65.0","187":"61.1","188":"58.2","189":"58.8","190":"60.6","191":"69.4","192":"26.8","193":"25.6","194":"70.1","195":"62.5","196":"31.0","197":"17.8","198":"26.4","199":"62.9","200":"61.5","201":"21.3","202":"18.4","203":"62.6","204":"18.5","205":"60.5","206":"25.0","207":"60.9","208":"60.0","209":"41.0","210":"63.0","211":"39.9","212":"63.8","213":"63.0","214":"63.8","215":"64.0","216":"51.3","217":"66.2","218":"14.1","219":"59.8","220":"30.9","221":"67.0","222":"47.5","223":"63.8","224":"43.0","225":"57.8","226":"46.5","227":"23.7","228":"22.8","229":"68.0","230":"52.4","231":"69.0","232":"50.2","233":"24.7","234":"26.3","235":"42.0","236":"13.1","237":"28.6","238":"69.0","239":"64.7","240":"66.9","241":"47.1","242":"59.0","243":"63.9","244":"62.3","245":"34.6","246":"55.7","247":"65.2","248":"59.0","249":"51.5","250":"36.4","251":"37.8","252":"28.2","253":"58.7","254":"71.3","255":"40.2","256":"64.2","257":"43.5","258":"65.0","259":"67.1","260":"66.6","261":"71.3","262":"67.4","263":"67.9","264":"66.9","265":"68.2","266":"56.6","267":"63.8","268":"60.1","269":"61.2","270":"63.4","271":"61.4","272":"66.8","273":"65.9","274":"63.3","275":"13.8","276":"16.1","277":"14.4","278":"19.3","279":"11.5","280":"12.8","281":"56.8","282":"14.6","283":"40.0","284":"22.5","285":"26.4","286":"34.1","287":"66.0","288":"63.6","289":"59.8","290":"58.0","291":"64.4","292":"62.2","293":"57.4","294":"61.4","295":"62.4","296":"43.6","297":"62.8","298":"60.5","299":"69.0","300":"33.5","301":"25.9","302":"53.9","303":"28.5","304":"28.3","305":"27.6","306":"27.2","307":"59.5","308":"34.5","309":"32.8","310":"40.8","311":"57.5","312":"52.3","313":"63.5","314":"47.6","315":"64.4","316":"68.8","317":"64.8","318":"40.8","319":"53.0","320":"65.0","321":"38.2","322":"62.2","323":"62.1","324":"64.0","325":"62.9","_rn_":"4"},{"1":"72.6","2":"21.3","3":"51.6","4":"38.5","5":"56.4","6":"62.2","7":"24.5","8":"47.8","9":"24.0","10":"10.5","11":"64.3","12":"23.9","13":"55.4","14":"63.6","15":"50.7","16":"21.9","17":"61.6","18":"23.4","19":"50.7","20":"58.4","21":"47.0","22":"57.9","23":"60.5","24":"30.3","25":"66.8","26":"65.5","27":"20.2","28":"67.6","29":"64.3","30":"69.3","31":"56.5","32":"23.7","33":"8.4","34":"27.8","35":"61.9","36":"57.8","37":"66.4","38":"25.7","39":"56.1","40":"62.0","41":"58.5","42":"22.5","43":"38.7","44":"35.1","45":"64.4","46":"41.1","47":"63.5","48":"70.4","49":"26.2","50":"36.0","51":"63.5","52":"26.2","53":"67.4","54":"42.2","55":"62.9","56":"8.6","57":"20.1","58":"64.7","59":"63.7","60":"66.7","61":"25.3","62":"26.3","63":"66.6","64":"62.1","65":"47.3","66":"63.4","67":"56.8","68":"62.3","69":"50.5","70":"66.2","71":"66.3","72":"64.4","73":"26.3","74":"37.3","75":"34.6","76":"23.3","77":"39.9","78":"64.7","79":"66.1","80":"22.7","81":"28.1","82":"21.3","83":"17.2","84":"45.5","85":"9.8","86":"18.5","87":"63.4","88":"66.7","89":"61.6","90":"62.2","91":"67.1","92":"32.5","93":"69.0","94":"37.9","95":"65.8","96":"54.0","97":"30.6","98":"39.4","99":"61.4","100":"45.9","101":"63.8","102":"50.8","103":"42.9","104":"24.9","105":"57.0","106":"69.3","107":"27.5","108":"62.7","109":"24.2","110":"15.6","111":"63.8","112":"63.8","113":"67.0","114":"16.2","115":"13.6","116":"60.9","117":"38.4","118":"65.1","119":"71.4","120":"47.3","121":"36.2","122":"15.7","123":"41.7","124":"37.5","125":"69.6","126":"65.8","127":"38.2","128":"19.1","129":"63.4","130":"65.5","131":"57.1","132":"63.8","133":"67.7","134":"20.3","135":"23.3","136":"18.2","137":"32.5","138":"67.7","139":"36.5","140":"65.1","141":"65.1","142":"12.5","143":"67.7","144":"66.3","145":"22.9","146":"27.9","147":"27.1","148":"29.9","149":"65.1","150":"58.5","151":"65.1","152":"33.7","153":"47.9","154":"67.3","155":"66.5","156":"56.6","157":"65.7","158":"61.4","159":"62.7","160":"58.9","161":"63.9","162":"61.5","163":"61.8","164":"37.0","165":"62.4","166":"65.6","167":"66.3","168":"52.0","169":"53.0","170":"23.1","171":"62.3","172":"61.7","173":"68.8","174":"21.9","175":"68.6","176":"53.0","177":"46.0","178":"63.8","179":"59.1","180":"56.4","181":"60.1","182":"39.2","183":"15.7","184":"50.6","185":"65.0","186":"65.0","187":"61.7","188":"62.9","189":"64.1","190":"64.1","191":"66.4","192":"41.0","193":"40.8","194":"67.5","195":"62.6","196":"32.7","197":"15.2","198":"27.4","199":"67.2","200":"65.5","201":"21.5","202":"19.9","203":"65.4","204":"18.8","205":"63.7","206":"25.3","207":"63.1","208":"61.6","209":"41.7","210":"63.4","211":"37.2","212":"63.8","213":"64.8","214":"63.8","215":"64.7","216":"61.8","217":"67.6","218":"10.9","219":"60.4","220":"15.9","221":"63.8","222":"39.5","223":"63.8","224":"41.5","225":"61.5","226":"42.0","227":"22.8","228":"23.0","229":"67.8","230":"51.4","231":"70.5","232":"43.4","233":"23.7","234":"33.0","235":"43.7","236":"10.2","237":"24.8","238":"67.9","239":"63.2","240":"66.9","241":"26.6","242":"59.3","243":"63.9","244":"38.7","245":"36.0","246":"57.4","247":"64.9","248":"63.1","249":"45.9","250":"34.0","251":"25.7","252":"21.3","253":"30.8","254":"72.8","255":"36.0","256":"65.1","257":"43.5","258":"65.7","259":"67.9","260":"66.5","261":"70.4","262":"67.9","263":"67.4","264":"66.7","265":"67.7","266":"39.6","267":"63.8","268":"41.4","269":"55.9","270":"61.6","271":"61.2","272":"65.5","273":"65.3","274":"62.4","275":"62.0","276":"41.3","277":"20.9","278":"26.6","279":"16.8","280":"19.3","281":"54.1","282":"19.7","283":"46.4","284":"25.3","285":"38.5","286":"41.3","287":"68.0","288":"63.8","289":"61.2","290":"60.1","291":"64.3","292":"61.7","293":"63.2","294":"61.7","295":"62.5","296":"57.3","297":"62.0","298":"62.6","299":"68.5","300":"32.6","301":"26.1","302":"59.3","303":"24.4","304":"25.3","305":"31.8","306":"28.1","307":"53.1","308":"39.6","309":"32.6","310":"40.5","311":"58.5","312":"15.2","313":"62.4","314":"49.1","315":"64.3","316":"60.4","317":"62.7","318":"28.9","319":"58.3","320":"66.4","321":"30.7","322":"40.2","323":"46.0","324":"26.4","325":"62.1","_rn_":"5"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>Y <span class="sc">|&gt;</span> <span class="fu">dim</span>()</span></code></pre></div>
<pre><code>## [1]  26 325</code></pre>
<p>We remove columns in <code>Y</code>, those with the same value in the
first 13 replicates. We also remove the corresponding rows in
<code>PtE</code>.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>all_same <span class="ot">&lt;-</span> <span class="cf">function</span>(col) {</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>  <span class="fu">length</span>(<span class="fu">unique</span>(col[<span class="dv">1</span><span class="sc">:</span><span class="dv">13</span>])) <span class="sc">==</span> <span class="dv">1</span></span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>}</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>cols_to_keep <span class="ot">&lt;-</span> <span class="fu">apply</span>(Y, <span class="dv">2</span>, <span class="cf">function</span>(col) <span class="sc">!</span><span class="fu">all_same</span>(col))</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>Y <span class="ot">&lt;-</span> Y[, cols_to_keep]</span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>PtE <span class="ot">&lt;-</span> PtE[cols_to_keep,]</span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a>PtE <span class="sc">|&gt;</span> <span class="fu">dim</span>()</span></code></pre></div>
<pre><code>## [1] 314   2</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>Y <span class="sc">|&gt;</span> <span class="fu">dim</span>()</span></code></pre></div>
<pre><code>## [1]  26 314</code></pre>
<p>Half of the replicates (<code>Y_for_summary</code>) are used to
compute <code>Y_logstd</code> and <code>Y_mean</code>, and the other
half (<code>Y</code> again ) are used to fit a replicate model in <a
href="pems_repl2.html">pems_repl2.html</a>.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>sampled_numbers <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">13</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>not_sampled_numbers <span class="ot">&lt;-</span> <span class="dv">14</span><span class="sc">:</span><span class="dv">26</span></span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>Y_for_summary <span class="ot">&lt;-</span> Y[sampled_numbers,]</span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>Y_logstd <span class="ot">&lt;-</span> <span class="fu">apply</span>(Y_for_summary, <span class="dv">2</span>, sd) <span class="sc">|&gt;</span> <span class="fu">as.vector</span>() <span class="sc">|&gt;</span> <span class="fu">log</span>()</span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>Y_mean <span class="ot">&lt;-</span> <span class="fu">apply</span>(Y_for_summary, <span class="dv">2</span>, mean) <span class="sc">|&gt;</span> <span class="fu">as.vector</span>()</span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a>Y <span class="ot">&lt;-</span> Y[not_sampled_numbers,]</span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a>Y <span class="sc">|&gt;</span> <span class="fu">dim</span>()</span></code></pre></div>
<pre><code>## [1]  13 314</code></pre>
<hr />
<p>Observe that <code>Y_logstd</code> corresponds to <span
class="math inline">\(\log\)</span> of the standard deviation at each
location.</p>
<p>Below we build the graph using the list element <code>edges</code>
object from <code>pems_repl</code>.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="co"># Build the graph</span></span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>graph <span class="ot">&lt;-</span> metric_graph<span class="sc">$</span><span class="fu">new</span>(<span class="at">edges =</span> pems_repl<span class="sc">$</span>edges, <span class="at">longlat =</span> <span class="cn">TRUE</span>)</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a><span class="co"># Add the observations</span></span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>graph<span class="sc">$</span><span class="fu">add_observations</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">y =</span> Y_logstd, </span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a>                                         <span class="at">edge_number =</span> PtE[,<span class="dv">1</span>], </span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a>                                         <span class="at">distance_on_edge =</span> PtE[,<span class="dv">2</span>]), </span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a>                       <span class="at">normalized =</span> <span class="cn">TRUE</span>, </span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a>                       <span class="at">clear_obs =</span> <span class="cn">TRUE</span>)</span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a><span class="co"># Build the mesh</span></span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a>graph<span class="sc">$</span><span class="fu">build_mesh</span>(<span class="at">h =</span> <span class="fl">0.05</span>) </span></code></pre></div>
<p>Below we fit <span class="math inline">\(\log(\mathrm{sd}(s_i))\sim
N(\beta_0+u(s_i), \sigma_e^2)\)</span>.</p>
<div style="color: blue;">
<hr />
<p><strong>Press the Show button below to reveal the code.</strong></p>
<hr />
</div>
<div class="sourceCode" id="cb19"><pre
class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="co"># Build the model</span></span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>rspde_model_stat <span class="ot">&lt;-</span> <span class="fu">rspde.metric_graph</span>(graph,</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>                                       <span class="at">parameterization =</span> <span class="st">&quot;spde&quot;</span>)</span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a><span class="co"># Prepare the data for fitting</span></span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a>data_rspde_bru_stat <span class="ot">&lt;-</span> <span class="fu">graph_data_rspde</span>(rspde_model_stat,</span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a>                                        <span class="at">loc_name =</span> <span class="st">&quot;loc&quot;</span>)</span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a><span class="co"># Define the component</span></span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a>cmp_stat <span class="ot">&lt;-</span> y <span class="sc">~</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">+</span></span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a>  <span class="fu">Intercept</span>(<span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb19-10"><a href="#cb19-10" tabindex="-1"></a>  <span class="fu">field</span>(loc, <span class="at">model =</span> rspde_model_stat)</span>
<span id="cb19-11"><a href="#cb19-11" tabindex="-1"></a><span class="co"># Fit the model</span></span>
<span id="cb19-12"><a href="#cb19-12" tabindex="-1"></a>rspde_fit_stat <span class="ot">&lt;-</span></span>
<span id="cb19-13"><a href="#cb19-13" tabindex="-1"></a>  <span class="fu">bru</span>(cmp_stat,</span>
<span id="cb19-14"><a href="#cb19-14" tabindex="-1"></a>      <span class="at">data =</span> data_rspde_bru_stat[[<span class="st">&quot;data&quot;</span>]],</span>
<span id="cb19-15"><a href="#cb19-15" tabindex="-1"></a>      <span class="at">family =</span> <span class="st">&quot;gaussian&quot;</span>,</span>
<span id="cb19-16"><a href="#cb19-16" tabindex="-1"></a>      <span class="at">options =</span> <span class="fu">list</span>(<span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb19-17"><a href="#cb19-17" tabindex="-1"></a>  )</span>
<span id="cb19-18"><a href="#cb19-18" tabindex="-1"></a><span class="co"># Summarize the results</span></span>
<span id="cb19-19"><a href="#cb19-19" tabindex="-1"></a><span class="fu">summary</span>(rspde_fit_stat)</span></code></pre></div>
<pre><code>## inlabru version: 2.11.1.9004
## INLA version: 24.10.07-2
## Components:
## Intercept: main = linear(1), group = exchangeable(1L), replicate = iid(1L), NULL
## field: main = cgeneric(loc), group = exchangeable(1L), replicate = iid(1L), NULL
## Likelihoods:
##   Family: &#39;gaussian&#39;
##     Data class: &#39;metric_graph_data&#39;, &#39;list&#39;
##     Response class: &#39;numeric&#39;
##     Predictor: y ~ .
##     Used components: effects[Intercept, field], latent[]
## Time used:
##     Pre = 0.517, Running = 8.69, Post = 1.99, Total = 11.2 
## Fixed effects:
##            mean    sd 0.025quant 0.5quant 0.975quant  mode kld
## Intercept 1.756 0.133      1.492    1.756      2.019 1.756   0
## 
## Random effects:
##   Name     Model
##     field CGeneric
## 
## Model hyperparameters:
##                                           mean    sd 0.025quant 0.5quant
## Precision for the Gaussian observations  4.585 0.502      3.668    4.561
## Theta1 for field                         0.236 0.198     -0.156    0.237
## Theta2 for field                        -0.608 0.204     -1.005   -0.610
## Theta3 for field                         1.110 0.709     -0.241    1.095
##                                         0.975quant   mode
## Precision for the Gaussian observations      5.642  4.518
## Theta1 for field                             0.623  0.241
## Theta2 for field                            -0.201 -0.618
## Theta3 for field                             2.549  1.029
## 
## Deviance Information Criterion (DIC) ...............: 516.04
## Deviance Information Criterion (DIC, saturated) ....: 415.70
## Effective number of parameters .....................: 98.88
## 
## Watanabe-Akaike information criterion (WAIC) ...: 512.76
## Effective number of parameters .................: 78.40
## 
## Marginal log-Likelihood:  -327.39 
##  is computed 
## Posterior summaries for the linear predictor and the fitted values are computed
## (Posterior marginals needs also &#39;control.compute=list(return.marginals.predictor=TRUE)&#39;)</code></pre>
<div class="sourceCode" id="cb21"><pre
class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="fu">gets_summary_parameters</span>(rspde_fit_stat, rspde_model_stat)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["mean"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["sd"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["0.025quant"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["0.5quant"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["0.975quant"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["mode"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"1.7557115","2":"0.13303206","3":"1.4916167","4":"1.7557747","5":"2.019359","6":"1.7557571","_rn_":"Intercept"},{"1":"1.2914300","2":"0.25550500","3":"0.8587880","4":"1.2681700","5":"1.859000","6":"1.2216700","_rn_":"tau"},{"1":"0.5557060","2":"0.11438300","3":"0.3673880","4":"0.5431070","5":"0.815093","6":"0.5181840","_rn_":"kappa"},{"1":"1.4629000","2":"0.25497100","3":"0.8853570","4":"1.4970000","5":"1.853080","6":"1.5918900","_rn_":"nu"},{"1":"1.3235000","2":"0.20415000","3":"0.9340480","4":"1.3149600","5":"1.744340","6":"1.2952600","_rn_":"std.dev"},{"1":"6.2546100","2":"1.09673000","3":"4.3329800","4":"6.1682800","5":"8.627110","6":"5.9283500","_rn_":"range"},{"1":"1.4629000","2":"0.25497100","3":"0.8853570","4":"1.4970000","5":"1.853080","6":"1.5918900","_rn_":"nu1"},{"1":"0.4690848","2":"0.02552808","3":"0.4213175","4":"0.4681735","5":"0.521551","6":"0.4663403","_rn_":"sigma_e"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>We now compute the kriging predictor <span
class="math inline">\(E(u(s_i)|\log(\mathrm{sd}(s_i)))\)</span> (denoted
as <code>cov</code> below) and standardize it.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="co"># Prediction locations</span></span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>data_prd_list_mesh <span class="ot">&lt;-</span> graph<span class="sc">$</span><span class="fu">get_mesh_locations</span>(<span class="at">bru =</span> <span class="cn">TRUE</span>, <span class="at">loc =</span> <span class="st">&quot;loc&quot;</span>)</span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a><span class="co"># Compute the kriging predictor</span></span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a>y_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(rspde_model_stat, cmp_stat, rspde_fit_stat, <span class="at">newdata =</span> data_prd_list_mesh, <span class="sc">~</span>Intercept <span class="sc">+</span> field)</span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a>cov_almost <span class="ot">&lt;-</span> y_pred<span class="sc">$</span>pred<span class="sc">$</span>mean</span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a><span class="co"># Standardize the kriging predictor of the log standard deviation</span></span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a>cov <span class="ot">&lt;-</span> (cov_almost <span class="sc">-</span> <span class="fu">mean</span>(cov_almost))<span class="sc">/</span><span class="fu">sd</span>(cov_almost)</span></code></pre></div>
<p>Below we plot the results. We first generate two maps, one for zoom
level 12 and the other for zoom level 13.</p>
<div style="color: blue;">
<hr />
<p><strong>Press the Show button below to reveal the code.</strong></p>
<hr />
</div>
<div class="sourceCode" id="cb23"><pre
class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="co"># Extract the Euclidean coordinates of the mesh points</span></span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>xypoints <span class="ot">&lt;-</span> graph<span class="sc">$</span>mesh<span class="sc">$</span>V</span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a><span class="co"># Extract the range of the coordinates </span></span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a>x_left <span class="ot">&lt;-</span> <span class="fu">range</span>(xypoints[,<span class="dv">1</span>])[<span class="dv">1</span>]</span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a>x_right <span class="ot">&lt;-</span> <span class="fu">range</span>(xypoints[,<span class="dv">1</span>])[<span class="dv">2</span>]</span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a>y_bottom <span class="ot">&lt;-</span> <span class="fu">range</span>(xypoints[,<span class="dv">2</span>])[<span class="dv">1</span>]</span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a>y_top <span class="ot">&lt;-</span> <span class="fu">range</span>(xypoints[,<span class="dv">2</span>])[<span class="dv">2</span>]</span>
<span id="cb23-8"><a href="#cb23-8" tabindex="-1"></a><span class="co"># Define coordinates for small windows</span></span>
<span id="cb23-9"><a href="#cb23-9" tabindex="-1"></a>coordx_lwr1 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">121.878</span></span>
<span id="cb23-10"><a href="#cb23-10" tabindex="-1"></a>coordx_upr1 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">121.828</span></span>
<span id="cb23-11"><a href="#cb23-11" tabindex="-1"></a>coordy_lwr1 <span class="ot">&lt;-</span> <span class="fl">37.315</span></span>
<span id="cb23-12"><a href="#cb23-12" tabindex="-1"></a>coordy_upr1 <span class="ot">&lt;-</span> <span class="fl">37.365</span></span>
<span id="cb23-13"><a href="#cb23-13" tabindex="-1"></a></span>
<span id="cb23-14"><a href="#cb23-14" tabindex="-1"></a>coordx_lwr2<span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">122.075</span></span>
<span id="cb23-15"><a href="#cb23-15" tabindex="-1"></a>coordx_upr2 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">122.025</span></span>
<span id="cb23-16"><a href="#cb23-16" tabindex="-1"></a>coordy_lwr2 <span class="ot">&lt;-</span> <span class="fl">37.365</span></span>
<span id="cb23-17"><a href="#cb23-17" tabindex="-1"></a>coordy_upr2 <span class="ot">&lt;-</span> <span class="fl">37.415</span></span>
<span id="cb23-18"><a href="#cb23-18" tabindex="-1"></a><span class="co"># Define the colors for the windows</span></span>
<span id="cb23-19"><a href="#cb23-19" tabindex="-1"></a>lower_color <span class="ot">&lt;-</span> <span class="st">&quot;darkred&quot;</span>   <span class="co"># Dark purple</span></span>
<span id="cb23-20"><a href="#cb23-20" tabindex="-1"></a>upper_color <span class="ot">&lt;-</span> <span class="st">&quot;darkblue&quot;</span>  <span class="co"># Yellow</span></span>
<span id="cb23-21"><a href="#cb23-21" tabindex="-1"></a><span class="co"># Set the style of the map</span></span>
<span id="cb23-22"><a href="#cb23-22" tabindex="-1"></a>style_vector <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">c</span>(<span class="at">feature =</span> <span class="st">&quot;road&quot;</span>, <span class="at">element =</span> <span class="st">&quot;geometry&quot;</span>, <span class="at">visibility =</span> <span class="st">&quot;on&quot;</span>),</span>
<span id="cb23-23"><a href="#cb23-23" tabindex="-1"></a>                  <span class="fu">c</span>(<span class="st">&quot;&amp;style=&quot;</span>, <span class="at">feature =</span> <span class="st">&quot;poi&quot;</span>, <span class="at">element =</span> <span class="st">&quot;labels&quot;</span>, <span class="at">visibility =</span> <span class="st">&quot;off&quot;</span>),</span>
<span id="cb23-24"><a href="#cb23-24" tabindex="-1"></a>                  <span class="fu">c</span>(<span class="st">&quot;&amp;style=&quot;</span>, <span class="at">feature =</span> <span class="st">&quot;road&quot;</span>, <span class="at">element =</span> <span class="st">&quot;labels&quot;</span>, <span class="at">visibility =</span> <span class="st">&quot;off&quot;</span>),</span>
<span id="cb23-25"><a href="#cb23-25" tabindex="-1"></a>                  <span class="fu">c</span>(<span class="st">&quot;&amp;style=&quot;</span>, <span class="at">feature =</span> <span class="st">&quot;administrative&quot;</span>, <span class="at">element =</span> <span class="st">&quot;labels&quot;</span>, <span class="at">visibility =</span> <span class="st">&quot;off&quot;</span>), <span class="co">#name of places</span></span>
<span id="cb23-26"><a href="#cb23-26" tabindex="-1"></a>                  <span class="fu">c</span>(<span class="st">&quot;&amp;style=&quot;</span>, <span class="at">feature =</span> <span class="st">&quot;transit&quot;</span>, <span class="at">element =</span> <span class="st">&quot;labels&quot;</span>, <span class="at">visibility =</span> <span class="st">&quot;off&quot;</span>),</span>
<span id="cb23-27"><a href="#cb23-27" tabindex="-1"></a>                  <span class="fu">c</span>(<span class="st">&quot;&amp;style=&quot;</span>, <span class="at">feature =</span> <span class="st">&quot;landscape&quot;</span>, <span class="at">element =</span> <span class="st">&quot;geometry&quot;</span>, <span class="at">visibility =</span> <span class="st">&quot;on&quot;</span>),</span>
<span id="cb23-28"><a href="#cb23-28" tabindex="-1"></a>                  <span class="fu">c</span>(<span class="st">&quot;&amp;style=&quot;</span>, <span class="at">feature =</span> <span class="st">&quot;water&quot;</span>, <span class="at">element =</span> <span class="st">&quot;geometry&quot;</span>, <span class="at">visibility =</span> <span class="st">&quot;on&quot;</span>)) </span>
<span id="cb23-29"><a href="#cb23-29" tabindex="-1"></a><span class="co"># Obtain the maps</span></span>
<span id="cb23-30"><a href="#cb23-30" tabindex="-1"></a>p12 <span class="ot">&lt;-</span> <span class="fu">ggmap</span>(<span class="fu">get_stadiamap</span>(<span class="at">bbox =</span> <span class="fu">c</span>(<span class="at">left =</span> x_left, <span class="at">bottom =</span> y_bottom, <span class="at">right =</span> x_right, <span class="at">top =</span> y_top),</span>
<span id="cb23-31"><a href="#cb23-31" tabindex="-1"></a>              <span class="at">zoom =</span> <span class="dv">12</span>,</span>
<span id="cb23-32"><a href="#cb23-32" tabindex="-1"></a>              <span class="at">maptype =</span> <span class="st">&quot;stamen_toner_lite&quot;</span>, </span>
<span id="cb23-33"><a href="#cb23-33" tabindex="-1"></a>              <span class="at">scale =</span><span class="dv">2</span>,</span>
<span id="cb23-34"><a href="#cb23-34" tabindex="-1"></a>              <span class="at">style =</span> style_vector,</span>
<span id="cb23-35"><a href="#cb23-35" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">&quot;color&quot;</span>)) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="cn">NULL</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="cn">NULL</span>)</span>
<span id="cb23-36"><a href="#cb23-36" tabindex="-1"></a>p13 <span class="ot">&lt;-</span> <span class="fu">ggmap</span>(<span class="fu">get_stadiamap</span>(<span class="at">bbox =</span> <span class="fu">c</span>(<span class="at">left =</span> x_left, <span class="at">bottom =</span> y_bottom, <span class="at">right =</span> x_right, <span class="at">top =</span> y_top),</span>
<span id="cb23-37"><a href="#cb23-37" tabindex="-1"></a>              <span class="at">zoom =</span> <span class="dv">13</span>,</span>
<span id="cb23-38"><a href="#cb23-38" tabindex="-1"></a>              <span class="at">maptype =</span> <span class="st">&quot;stamen_toner_lite&quot;</span>, </span>
<span id="cb23-39"><a href="#cb23-39" tabindex="-1"></a>              <span class="at">scale =</span><span class="dv">2</span>,</span>
<span id="cb23-40"><a href="#cb23-40" tabindex="-1"></a>              <span class="at">style =</span> style_vector,</span>
<span id="cb23-41"><a href="#cb23-41" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">&quot;color&quot;</span>)) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="cn">NULL</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="cn">NULL</span>)</span></code></pre></div>
<p>Below we plot the field on top of the map. We also add the point
values of the standard deviation of the log standard deviation to the
graph so we can plot it on top of the map and the field.</p>
<div class="sourceCode" id="cb24"><pre
class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="co"># Plot the field on top of the map</span></span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a>f12 <span class="ot">&lt;-</span> graph<span class="sc">$</span><span class="fu">plot_function</span>(<span class="at">X =</span> cov, </span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a>                          <span class="at">vertex_size =</span> <span class="dv">0</span>, </span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a>                          <span class="at">p =</span> p12,</span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a>                          <span class="at">edge_width =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb24-6"><a href="#cb24-6" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb24-7"><a href="#cb24-7" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">&quot;Palatino&quot;</span>), </span>
<span id="cb24-8"><a href="#cb24-8" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb24-9"><a href="#cb24-9" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb24-10"><a href="#cb24-10" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="sc">-</span><span class="fl">0.4</span><span class="sc">*</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="st">&quot;cm&quot;</span>)</span>
<span id="cb24-11"><a href="#cb24-11" tabindex="-1"></a>        ) <span class="sc">+</span></span>
<span id="cb24-12"><a href="#cb24-12" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">&quot;&quot;</span>, <span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> <span class="st">&quot;&quot;</span>) <span class="sc">+</span></span>
<span id="cb24-13"><a href="#cb24-13" tabindex="-1"></a>  <span class="fu">xlim</span>(x_left, x_right) <span class="sc">+</span> </span>
<span id="cb24-14"><a href="#cb24-14" tabindex="-1"></a>  <span class="fu">ylim</span>(y_bottom, y_top)</span>
<span id="cb24-15"><a href="#cb24-15" tabindex="-1"></a><span class="co"># Plot the field on top of the map</span></span>
<span id="cb24-16"><a href="#cb24-16" tabindex="-1"></a>f13 <span class="ot">&lt;-</span> graph<span class="sc">$</span><span class="fu">plot_function</span>(<span class="at">X =</span> cov, </span>
<span id="cb24-17"><a href="#cb24-17" tabindex="-1"></a>                          <span class="at">vertex_size =</span> <span class="dv">0</span>, </span>
<span id="cb24-18"><a href="#cb24-18" tabindex="-1"></a>                          <span class="at">p =</span> p13,</span>
<span id="cb24-19"><a href="#cb24-19" tabindex="-1"></a>                          <span class="at">edge_width =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb24-20"><a href="#cb24-20" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb24-21"><a href="#cb24-21" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">&quot;Palatino&quot;</span>), </span>
<span id="cb24-22"><a href="#cb24-22" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb24-23"><a href="#cb24-23" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb24-24"><a href="#cb24-24" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="sc">-</span><span class="fl">0.4</span><span class="sc">*</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="st">&quot;cm&quot;</span>)</span>
<span id="cb24-25"><a href="#cb24-25" tabindex="-1"></a>        ) <span class="sc">+</span></span>
<span id="cb24-26"><a href="#cb24-26" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">&quot;&quot;</span>, <span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> <span class="st">&quot;&quot;</span>) <span class="sc">+</span></span>
<span id="cb24-27"><a href="#cb24-27" tabindex="-1"></a>  <span class="fu">xlim</span>(x_left, x_right) <span class="sc">+</span> </span>
<span id="cb24-28"><a href="#cb24-28" tabindex="-1"></a>  <span class="fu">ylim</span>(y_bottom, y_top)</span>
<span id="cb24-29"><a href="#cb24-29" tabindex="-1"></a></span>
<span id="cb24-30"><a href="#cb24-30" tabindex="-1"></a><span class="co"># We add the point values of standard deviation of the log standard deviation to the graph so we can plot it</span></span>
<span id="cb24-31"><a href="#cb24-31" tabindex="-1"></a>standardized_Y_logstd <span class="ot">&lt;-</span> (Y_logstd <span class="sc">-</span> <span class="fu">mean</span>(Y_logstd))<span class="sc">/</span><span class="fu">sd</span>(Y_logstd)</span>
<span id="cb24-32"><a href="#cb24-32" tabindex="-1"></a>graph<span class="sc">$</span><span class="fu">add_observations</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">y =</span> standardized_Y_logstd, </span>
<span id="cb24-33"><a href="#cb24-33" tabindex="-1"></a>                                         <span class="at">edge_number =</span> PtE[,<span class="dv">1</span>], </span>
<span id="cb24-34"><a href="#cb24-34" tabindex="-1"></a>                                         <span class="at">distance_on_edge =</span> PtE[,<span class="dv">2</span>]), </span>
<span id="cb24-35"><a href="#cb24-35" tabindex="-1"></a>                       <span class="at">normalized =</span> <span class="cn">TRUE</span>, </span>
<span id="cb24-36"><a href="#cb24-36" tabindex="-1"></a>                       <span class="at">clear_obs =</span> <span class="cn">TRUE</span>)</span>
<span id="cb24-37"><a href="#cb24-37" tabindex="-1"></a>g12 <span class="ot">&lt;-</span> graph<span class="sc">$</span><span class="fu">plot</span>(<span class="at">data =</span> <span class="st">&quot;y&quot;</span>, <span class="at">vertex_size =</span> <span class="dv">0</span>, <span class="at">p =</span> f12, <span class="at">edge_width =</span> <span class="dv">0</span>, <span class="at">data_size =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb24-38"><a href="#cb24-38" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">&quot;&quot;</span>, <span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> <span class="st">&quot;&quot;</span>) <span class="sc">+</span> </span>
<span id="cb24-39"><a href="#cb24-39" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;segment&quot;</span>, <span class="at">x =</span> coordx_lwr1, <span class="at">y =</span> coordy_lwr1, <span class="at">xend =</span> coordx_upr1, <span class="at">yend =</span> coordy_lwr1, </span>
<span id="cb24-40"><a href="#cb24-40" tabindex="-1"></a>           <span class="at">linewidth =</span> <span class="fl">0.4</span>, <span class="at">color =</span> upper_color) <span class="sc">+</span>  <span class="co"># Bottom line</span></span>
<span id="cb24-41"><a href="#cb24-41" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;segment&quot;</span>, <span class="at">x =</span> coordx_lwr1, <span class="at">y =</span> coordy_upr1, <span class="at">xend =</span> coordx_upr1, <span class="at">yend =</span> coordy_upr1, </span>
<span id="cb24-42"><a href="#cb24-42" tabindex="-1"></a>           <span class="at">linewidth =</span> <span class="fl">0.4</span>, <span class="at">color =</span> upper_color) <span class="sc">+</span>  <span class="co"># Top line</span></span>
<span id="cb24-43"><a href="#cb24-43" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;segment&quot;</span>, <span class="at">x =</span> coordx_lwr1, <span class="at">y =</span> coordy_lwr1, <span class="at">xend =</span> coordx_lwr1, <span class="at">yend =</span> coordy_upr1, </span>
<span id="cb24-44"><a href="#cb24-44" tabindex="-1"></a>           <span class="at">linewidth =</span> <span class="fl">0.4</span>, <span class="at">color =</span> upper_color) <span class="sc">+</span>  <span class="co"># Left line</span></span>
<span id="cb24-45"><a href="#cb24-45" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;segment&quot;</span>, <span class="at">x =</span> coordx_upr1, <span class="at">y =</span> coordy_lwr1, <span class="at">xend =</span> coordx_upr1, <span class="at">yend =</span> coordy_upr1, </span>
<span id="cb24-46"><a href="#cb24-46" tabindex="-1"></a>           <span class="at">linewidth =</span> <span class="fl">0.4</span>, <span class="at">color =</span> upper_color) <span class="sc">+</span>  <span class="co"># Right line</span></span>
<span id="cb24-47"><a href="#cb24-47" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;segment&quot;</span>, <span class="at">x =</span> coordx_lwr2, <span class="at">y =</span> coordy_lwr2, <span class="at">xend =</span> coordx_upr2, <span class="at">yend =</span> coordy_lwr2, </span>
<span id="cb24-48"><a href="#cb24-48" tabindex="-1"></a>           <span class="at">linewidth =</span> <span class="fl">0.4</span>, <span class="at">color =</span> lower_color) <span class="sc">+</span>  </span>
<span id="cb24-49"><a href="#cb24-49" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;segment&quot;</span>, <span class="at">x =</span> coordx_lwr2, <span class="at">y =</span> coordy_upr2, <span class="at">xend =</span> coordx_upr2, <span class="at">yend =</span> coordy_upr2, </span>
<span id="cb24-50"><a href="#cb24-50" tabindex="-1"></a>           <span class="at">linewidth =</span> <span class="fl">0.4</span>, <span class="at">color =</span> lower_color) <span class="sc">+</span>  </span>
<span id="cb24-51"><a href="#cb24-51" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;segment&quot;</span>, <span class="at">x =</span> coordx_lwr2, <span class="at">y =</span> coordy_lwr2, <span class="at">xend =</span> coordx_lwr2, <span class="at">yend =</span> coordy_upr2, </span>
<span id="cb24-52"><a href="#cb24-52" tabindex="-1"></a>           <span class="at">linewidth =</span> <span class="fl">0.4</span>, <span class="at">color =</span> lower_color) <span class="sc">+</span>  </span>
<span id="cb24-53"><a href="#cb24-53" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;segment&quot;</span>, <span class="at">x =</span> coordx_upr2, <span class="at">y =</span> coordy_lwr2, <span class="at">xend =</span> coordx_upr2, <span class="at">yend =</span> coordy_upr2, </span>
<span id="cb24-54"><a href="#cb24-54" tabindex="-1"></a>           <span class="at">linewidth =</span> <span class="fl">0.4</span>, <span class="at">color =</span> lower_color)</span>
<span id="cb24-55"><a href="#cb24-55" tabindex="-1"></a>g13 <span class="ot">&lt;-</span> graph<span class="sc">$</span><span class="fu">plot</span>(<span class="at">data =</span> <span class="st">&quot;y&quot;</span>, <span class="at">vertex_size =</span> <span class="dv">0</span>, <span class="at">p =</span> f13, <span class="at">edge_width =</span> <span class="dv">0</span>, <span class="at">data_size =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb24-56"><a href="#cb24-56" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">&quot;&quot;</span>, <span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> <span class="st">&quot;&quot;</span>) <span class="sc">+</span> </span>
<span id="cb24-57"><a href="#cb24-57" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;segment&quot;</span>, <span class="at">x =</span> coordx_lwr1, <span class="at">y =</span> coordy_lwr1, <span class="at">xend =</span> coordx_upr1, <span class="at">yend =</span> coordy_lwr1, </span>
<span id="cb24-58"><a href="#cb24-58" tabindex="-1"></a>           <span class="at">linewidth =</span> <span class="fl">0.4</span>, <span class="at">color =</span> upper_color) <span class="sc">+</span>  <span class="co"># Bottom line</span></span>
<span id="cb24-59"><a href="#cb24-59" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;segment&quot;</span>, <span class="at">x =</span> coordx_lwr1, <span class="at">y =</span> coordy_upr1, <span class="at">xend =</span> coordx_upr1, <span class="at">yend =</span> coordy_upr1, </span>
<span id="cb24-60"><a href="#cb24-60" tabindex="-1"></a>           <span class="at">linewidth =</span> <span class="fl">0.4</span>, <span class="at">color =</span> upper_color) <span class="sc">+</span>  <span class="co"># Top line</span></span>
<span id="cb24-61"><a href="#cb24-61" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;segment&quot;</span>, <span class="at">x =</span> coordx_lwr1, <span class="at">y =</span> coordy_lwr1, <span class="at">xend =</span> coordx_lwr1, <span class="at">yend =</span> coordy_upr1, </span>
<span id="cb24-62"><a href="#cb24-62" tabindex="-1"></a>           <span class="at">linewidth =</span> <span class="fl">0.4</span>, <span class="at">color =</span> upper_color) <span class="sc">+</span>  <span class="co"># Left line</span></span>
<span id="cb24-63"><a href="#cb24-63" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;segment&quot;</span>, <span class="at">x =</span> coordx_upr1, <span class="at">y =</span> coordy_lwr1, <span class="at">xend =</span> coordx_upr1, <span class="at">yend =</span> coordy_upr1, </span>
<span id="cb24-64"><a href="#cb24-64" tabindex="-1"></a>           <span class="at">linewidth =</span> <span class="fl">0.4</span>, <span class="at">color =</span> upper_color) <span class="sc">+</span>  <span class="co"># Right line</span></span>
<span id="cb24-65"><a href="#cb24-65" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;segment&quot;</span>, <span class="at">x =</span> coordx_lwr2, <span class="at">y =</span> coordy_lwr2, <span class="at">xend =</span> coordx_upr2, <span class="at">yend =</span> coordy_lwr2, </span>
<span id="cb24-66"><a href="#cb24-66" tabindex="-1"></a>           <span class="at">linewidth =</span> <span class="fl">0.4</span>, <span class="at">color =</span> lower_color) <span class="sc">+</span>  </span>
<span id="cb24-67"><a href="#cb24-67" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;segment&quot;</span>, <span class="at">x =</span> coordx_lwr2, <span class="at">y =</span> coordy_upr2, <span class="at">xend =</span> coordx_upr2, <span class="at">yend =</span> coordy_upr2, </span>
<span id="cb24-68"><a href="#cb24-68" tabindex="-1"></a>           <span class="at">linewidth =</span> <span class="fl">0.4</span>, <span class="at">color =</span> lower_color) <span class="sc">+</span>  </span>
<span id="cb24-69"><a href="#cb24-69" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;segment&quot;</span>, <span class="at">x =</span> coordx_lwr2, <span class="at">y =</span> coordy_lwr2, <span class="at">xend =</span> coordx_lwr2, <span class="at">yend =</span> coordy_upr2, </span>
<span id="cb24-70"><a href="#cb24-70" tabindex="-1"></a>           <span class="at">linewidth =</span> <span class="fl">0.4</span>, <span class="at">color =</span> lower_color) <span class="sc">+</span>  </span>
<span id="cb24-71"><a href="#cb24-71" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;segment&quot;</span>, <span class="at">x =</span> coordx_upr2, <span class="at">y =</span> coordy_lwr2, <span class="at">xend =</span> coordx_upr2, <span class="at">yend =</span> coordy_upr2, </span>
<span id="cb24-72"><a href="#cb24-72" tabindex="-1"></a>           <span class="at">linewidth =</span> <span class="fl">0.4</span>, <span class="at">color =</span> lower_color) </span>
<span id="cb24-73"><a href="#cb24-73" tabindex="-1"></a></span>
<span id="cb24-74"><a href="#cb24-74" tabindex="-1"></a>r1 <span class="ot">&lt;-</span> g13 <span class="sc">+</span> <span class="fu">xlim</span>(coordx_lwr1, coordx_upr1) <span class="sc">+</span> </span>
<span id="cb24-75"><a href="#cb24-75" tabindex="-1"></a>                    <span class="fu">ylim</span>(coordy_lwr1, coordy_upr1) <span class="sc">+</span> </span>
<span id="cb24-76"><a href="#cb24-76" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>, </span>
<span id="cb24-77"><a href="#cb24-77" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="sc">-</span><span class="fl">0.2</span><span class="sc">*</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="st">&quot;cm&quot;</span>))</span>
<span id="cb24-78"><a href="#cb24-78" tabindex="-1"></a></span>
<span id="cb24-79"><a href="#cb24-79" tabindex="-1"></a>r2 <span class="ot">&lt;-</span> g13 <span class="sc">+</span> <span class="fu">xlim</span>(coordx_lwr2, coordx_upr2) <span class="sc">+</span> </span>
<span id="cb24-80"><a href="#cb24-80" tabindex="-1"></a>                    <span class="fu">ylim</span>(coordy_lwr2, coordy_upr2) <span class="sc">+</span> </span>
<span id="cb24-81"><a href="#cb24-81" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>, </span>
<span id="cb24-82"><a href="#cb24-82" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="sc">-</span><span class="fl">0.2</span><span class="sc">*</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="st">&quot;cm&quot;</span>))</span>
<span id="cb24-83"><a href="#cb24-83" tabindex="-1"></a></span>
<span id="cb24-84"><a href="#cb24-84" tabindex="-1"></a><span class="co"># Arrange p2 and p3 horizontally</span></span>
<span id="cb24-85"><a href="#cb24-85" tabindex="-1"></a>left_col <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(r2, r1, <span class="at">labels =</span> <span class="cn">NULL</span>, <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">rel_heights =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb24-86"><a href="#cb24-86" tabindex="-1"></a></span>
<span id="cb24-87"><a href="#cb24-87" tabindex="-1"></a><span class="co"># Combine the top row with p1 in a grid</span></span>
<span id="cb24-88"><a href="#cb24-88" tabindex="-1"></a>combined_plot <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(left_col, g12, <span class="at">labels =</span> <span class="cn">NULL</span>, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">rel_widths =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)) </span>
<span id="cb24-89"><a href="#cb24-89" tabindex="-1"></a>final_plot <span class="ot">&lt;-</span> <span class="fu">annotate_figure</span>(combined_plot, <span class="at">left =</span> <span class="fu">textGrob</span>(<span class="st">&quot;Latitude&quot;</span>, <span class="at">rot =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">cex =</span> <span class="fl">0.8</span>)),</span>
<span id="cb24-90"><a href="#cb24-90" tabindex="-1"></a>                              <span class="at">bottom =</span> <span class="fu">textGrob</span>(<span class="st">&quot;Longitude&quot;</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">cex =</span> <span class="fl">0.8</span>)))</span>
<span id="cb24-91"><a href="#cb24-91" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">here</span>(<span class="st">&quot;data_files/stand_log_sigma_3.png&quot;</span>), <span class="at">width =</span> <span class="fl">11.2</span>, <span class="at">height =</span> <span class="fl">5.43</span>, <span class="at">plot =</span> final_plot, <span class="at">dpi =</span> <span class="dv">500</span>)</span>
<span id="cb24-92"><a href="#cb24-92" tabindex="-1"></a><span class="co"># Print the combined plot</span></span>
<span id="cb24-93"><a href="#cb24-93" tabindex="-1"></a><span class="fu">print</span>(final_plot)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="pems_repl1_files/figure-html/unnamed-chunk-14-1.png" alt="Figure 1: Standardized logarithm of the standard deviation of the first part of the data. Points represent the point value at each available location, and edges represent the $\mathrm{std.cov}(s)$ covariate." width="1075.2" />
<p class="caption">
Figure 1: Standardized logarithm of the standard deviation of the first
part of the data. Points represent the point value at each available
location, and edges represent the <span
class="math inline">\(\mathrm{std.cov}(s)\)</span> covariate.
</p>
</div>
<p>We repeat the same process but now for <code>Y_mean</code>. We first
add the observations to the graph.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a>graph<span class="sc">$</span><span class="fu">add_observations</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">y =</span> Y_mean, </span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a>                                         <span class="at">edge_number =</span> PtE[,<span class="dv">1</span>], </span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a>                                         <span class="at">distance_on_edge =</span> PtE[,<span class="dv">2</span>]),</span>
<span id="cb25-4"><a href="#cb25-4" tabindex="-1"></a>                       <span class="at">normalized =</span> <span class="cn">TRUE</span>, </span>
<span id="cb25-5"><a href="#cb25-5" tabindex="-1"></a>                       <span class="at">clear_obs =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>We fit the model <span class="math inline">\(\mathrm{mean}(s_i)\sim
N(\beta_0+u(s_i), \sigma_e^2)\)</span>.</p>
<div style="color: blue;">
<hr />
<p><strong>Press the Show button below to reveal the code.</strong></p>
<hr />
</div>
<div class="sourceCode" id="cb26"><pre
class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="co"># Build the model</span></span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a>rspde_model_stat <span class="ot">&lt;-</span> <span class="fu">rspde.metric_graph</span>(graph,</span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a>                                       <span class="at">parameterization =</span> <span class="st">&quot;spde&quot;</span>)</span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a><span class="co"># Prepare the data for fitting</span></span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a>data_rspde_bru_stat <span class="ot">&lt;-</span> <span class="fu">graph_data_rspde</span>(rspde_model_stat,</span>
<span id="cb26-6"><a href="#cb26-6" tabindex="-1"></a>                                        <span class="at">loc_name =</span> <span class="st">&quot;loc&quot;</span>)</span>
<span id="cb26-7"><a href="#cb26-7" tabindex="-1"></a><span class="co"># Define the component</span></span>
<span id="cb26-8"><a href="#cb26-8" tabindex="-1"></a>cmp_stat <span class="ot">&lt;-</span> y <span class="sc">~</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">+</span></span>
<span id="cb26-9"><a href="#cb26-9" tabindex="-1"></a>  <span class="fu">Intercept</span>(<span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb26-10"><a href="#cb26-10" tabindex="-1"></a>  <span class="fu">field</span>(loc, <span class="at">model =</span> rspde_model_stat)</span>
<span id="cb26-11"><a href="#cb26-11" tabindex="-1"></a><span class="co"># Fit the model</span></span>
<span id="cb26-12"><a href="#cb26-12" tabindex="-1"></a>rspde_fit_stat <span class="ot">&lt;-</span></span>
<span id="cb26-13"><a href="#cb26-13" tabindex="-1"></a>  <span class="fu">bru</span>(cmp_stat,</span>
<span id="cb26-14"><a href="#cb26-14" tabindex="-1"></a>      <span class="at">data =</span> data_rspde_bru_stat[[<span class="st">&quot;data&quot;</span>]],</span>
<span id="cb26-15"><a href="#cb26-15" tabindex="-1"></a>      <span class="at">family =</span> <span class="st">&quot;gaussian&quot;</span>,</span>
<span id="cb26-16"><a href="#cb26-16" tabindex="-1"></a>      <span class="at">options =</span> <span class="fu">list</span>(<span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb26-17"><a href="#cb26-17" tabindex="-1"></a>  )</span>
<span id="cb26-18"><a href="#cb26-18" tabindex="-1"></a><span class="co"># Summarize the results</span></span>
<span id="cb26-19"><a href="#cb26-19" tabindex="-1"></a><span class="fu">summary</span>(rspde_fit_stat)</span></code></pre></div>
<pre><code>## inlabru version: 2.11.1.9004
## INLA version: 24.10.07-2
## Components:
## Intercept: main = linear(1), group = exchangeable(1L), replicate = iid(1L), NULL
## field: main = cgeneric(loc), group = exchangeable(1L), replicate = iid(1L), NULL
## Likelihoods:
##   Family: &#39;gaussian&#39;
##     Data class: &#39;metric_graph_data&#39;, &#39;list&#39;
##     Response class: &#39;numeric&#39;
##     Predictor: y ~ .
##     Used components: effects[Intercept, field], latent[]
## Time used:
##     Pre = 0.34, Running = 18.1, Post = 1.02, Total = 19.5 
## Fixed effects:
##             mean    sd 0.025quant 0.5quant 0.975quant   mode kld
## Intercept 50.783 2.833     45.086   50.804     56.352 50.801   0
## 
## Random effects:
##   Name     Model
##     field CGeneric
## 
## Model hyperparameters:
##                                           mean    sd 0.025quant 0.5quant
## Precision for the Gaussian observations  0.020 0.002      0.016    0.020
## Theta1 for field                        -2.364 0.168     -2.696   -2.364
## Theta2 for field                        -0.848 0.174     -1.190   -0.847
## Theta3 for field                         1.078 0.323      0.430    1.081
##                                         0.975quant   mode
## Precision for the Gaussian observations      0.024  0.019
## Theta1 for field                            -2.036 -2.361
## Theta2 for field                            -0.506 -0.847
## Theta3 for field                             1.703  1.097
## 
## Deviance Information Criterion (DIC) ...............: 2223.14
## Deviance Information Criterion (DIC, saturated) ....: 412.19
## Effective number of parameters .....................: 95.95
## 
## Watanabe-Akaike information criterion (WAIC) ...: 2217.72
## Effective number of parameters .................: 74.51
## 
## Marginal log-Likelihood:  -1193.19 
##  is computed 
## Posterior summaries for the linear predictor and the fitted values are computed
## (Posterior marginals needs also &#39;control.compute=list(return.marginals.predictor=TRUE)&#39;)</code></pre>
<div class="sourceCode" id="cb28"><pre
class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="fu">gets_summary_parameters</span>(rspde_fit_stat, rspde_model_stat)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["mean"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["sd"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["0.025quant"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["0.5quant"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["0.975quant"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["mode"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"50.7827422","2":"2.8326179","3":"45.0864835","4":"50.8035035","5":"56.351608","6":"50.8009341","_rn_":"Intercept"},{"1":"0.0953644","2":"0.0159613","3":"0.0676564","4":"0.0940979","5":"0.130198","6":"0.0917009","_rn_":"tau"},{"1":"0.4349150","2":"0.0755741","3":"0.3051320","4":"0.4285590","5":"0.601203","6":"0.4156460","_rn_":"kappa"},{"1":"1.4828400","2":"0.1220940","3":"1.2148000","4":"1.4938500","5":"1.690650","6":"1.5188900","_rn_":"nu"},{"1":"26.6663000","2":"3.8110300","3":"20.0607000","4":"26.4231000","5":"35.065900","6":"26.8073000","_rn_":"std.dev"},{"1":"8.1464200","2":"1.3773400","3":"5.7839400","4":"8.0315100","5":"11.097200","6":"7.6864600","_rn_":"range"},{"1":"1.4828400","2":"0.1220940","3":"1.2148000","4":"1.4938500","5":"1.690650","6":"1.5188900","_rn_":"nu1"},{"1":"7.1428239","2":"0.3762497","3":"6.4371517","4":"7.1300191","5":"7.914494","6":"7.1038787","_rn_":"sigma_e"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Below we compute the predictions for the mesh and the data
location.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a>mean_on_mesh_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(rspde_model_stat, cmp_stat, rspde_fit_stat, <span class="at">newdata =</span> data_prd_list_mesh, <span class="sc">~</span>Intercept <span class="sc">+</span> field)</span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a>cov_for_mean_to_plot <span class="ot">&lt;-</span> mean_on_mesh_pred<span class="sc">$</span>pred<span class="sc">$</span>mean</span>
<span id="cb29-3"><a href="#cb29-3" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" tabindex="-1"></a>mean_on_loc_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(rspde_model_stat, cmp_stat, rspde_fit_stat, <span class="at">newdata =</span> <span class="fu">list</span>(<span class="at">loc =</span> PtE), <span class="sc">~</span>Intercept <span class="sc">+</span> field)</span>
<span id="cb29-5"><a href="#cb29-5" tabindex="-1"></a>cov_for_mean <span class="ot">&lt;-</span> mean_on_loc_pred<span class="sc">$</span>pred<span class="sc">$</span>mean</span></code></pre></div>
<p>Below we check that the predicted mean is close to the observed
mean.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a><span class="fu">plot</span>(Y_mean, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="st">&quot;darkblue&quot;</span>)</span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a><span class="fu">lines</span>(cov_for_mean, <span class="at">col =</span> <span class="st">&quot;darkred&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="pems_repl1_files/figure-html/unnamed-chunk-18-1.png" alt="Figure 2: Predicted mean and observed mean." width="2304" />
<p class="caption">
Figure 2: Predicted mean and observed mean.
</p>
</div>
<p>Below we plot the results as we did before.</p>
<div style="color: blue;">
<hr />
<p><strong>Press the Show button below to reveal the code.</strong></p>
<hr />
</div>
<div class="sourceCode" id="cb31"><pre
class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a><span class="co"># Plot the field on top of the map</span></span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a>f12 <span class="ot">&lt;-</span> graph<span class="sc">$</span><span class="fu">plot_function</span>(<span class="at">X =</span> cov_for_mean_to_plot, </span>
<span id="cb31-3"><a href="#cb31-3" tabindex="-1"></a>                          <span class="at">vertex_size =</span> <span class="dv">0</span>, </span>
<span id="cb31-4"><a href="#cb31-4" tabindex="-1"></a>                          <span class="at">p =</span> p12,</span>
<span id="cb31-5"><a href="#cb31-5" tabindex="-1"></a>                          <span class="at">edge_width =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb31-6"><a href="#cb31-6" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb31-7"><a href="#cb31-7" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">&quot;Palatino&quot;</span>), </span>
<span id="cb31-8"><a href="#cb31-8" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb31-9"><a href="#cb31-9" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb31-10"><a href="#cb31-10" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="sc">-</span><span class="fl">0.4</span><span class="sc">*</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="st">&quot;cm&quot;</span>)</span>
<span id="cb31-11"><a href="#cb31-11" tabindex="-1"></a>        ) <span class="sc">+</span></span>
<span id="cb31-12"><a href="#cb31-12" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">&quot;&quot;</span>, <span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> <span class="st">&quot;&quot;</span>) <span class="sc">+</span></span>
<span id="cb31-13"><a href="#cb31-13" tabindex="-1"></a>  <span class="fu">xlim</span>(x_left, x_right) <span class="sc">+</span> </span>
<span id="cb31-14"><a href="#cb31-14" tabindex="-1"></a>  <span class="fu">ylim</span>(y_bottom, y_top)</span>
<span id="cb31-15"><a href="#cb31-15" tabindex="-1"></a><span class="co"># Plot the field on top of the map</span></span>
<span id="cb31-16"><a href="#cb31-16" tabindex="-1"></a>f13 <span class="ot">&lt;-</span> graph<span class="sc">$</span><span class="fu">plot_function</span>(<span class="at">X =</span> cov_for_mean_to_plot, </span>
<span id="cb31-17"><a href="#cb31-17" tabindex="-1"></a>                          <span class="at">vertex_size =</span> <span class="dv">0</span>, </span>
<span id="cb31-18"><a href="#cb31-18" tabindex="-1"></a>                          <span class="at">p =</span> p13,</span>
<span id="cb31-19"><a href="#cb31-19" tabindex="-1"></a>                          <span class="at">edge_width =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb31-20"><a href="#cb31-20" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb31-21"><a href="#cb31-21" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">&quot;Palatino&quot;</span>), </span>
<span id="cb31-22"><a href="#cb31-22" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb31-23"><a href="#cb31-23" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb31-24"><a href="#cb31-24" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="sc">-</span><span class="fl">0.4</span><span class="sc">*</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="st">&quot;cm&quot;</span>)</span>
<span id="cb31-25"><a href="#cb31-25" tabindex="-1"></a>        ) <span class="sc">+</span></span>
<span id="cb31-26"><a href="#cb31-26" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">&quot;&quot;</span>, <span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> <span class="st">&quot;&quot;</span>) <span class="sc">+</span></span>
<span id="cb31-27"><a href="#cb31-27" tabindex="-1"></a>  <span class="fu">xlim</span>(x_left, x_right) <span class="sc">+</span> </span>
<span id="cb31-28"><a href="#cb31-28" tabindex="-1"></a>  <span class="fu">ylim</span>(y_bottom, y_top)</span>
<span id="cb31-29"><a href="#cb31-29" tabindex="-1"></a></span>
<span id="cb31-30"><a href="#cb31-30" tabindex="-1"></a>g12 <span class="ot">&lt;-</span> graph<span class="sc">$</span><span class="fu">plot</span>(<span class="at">data =</span> <span class="st">&quot;y&quot;</span>, <span class="at">vertex_size =</span> <span class="dv">0</span>, <span class="at">p =</span> f12, <span class="at">edge_width =</span> <span class="dv">0</span>, <span class="at">data_size =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb31-31"><a href="#cb31-31" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">&quot;&quot;</span>, <span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> <span class="st">&quot;&quot;</span>) <span class="sc">+</span> </span>
<span id="cb31-32"><a href="#cb31-32" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;segment&quot;</span>, <span class="at">x =</span> coordx_lwr1, <span class="at">y =</span> coordy_lwr1, <span class="at">xend =</span> coordx_upr1, <span class="at">yend =</span> coordy_lwr1, </span>
<span id="cb31-33"><a href="#cb31-33" tabindex="-1"></a>           <span class="at">linewidth =</span> <span class="fl">0.4</span>, <span class="at">color =</span> upper_color) <span class="sc">+</span>  <span class="co"># Bottom line</span></span>
<span id="cb31-34"><a href="#cb31-34" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;segment&quot;</span>, <span class="at">x =</span> coordx_lwr1, <span class="at">y =</span> coordy_upr1, <span class="at">xend =</span> coordx_upr1, <span class="at">yend =</span> coordy_upr1, </span>
<span id="cb31-35"><a href="#cb31-35" tabindex="-1"></a>           <span class="at">linewidth =</span> <span class="fl">0.4</span>, <span class="at">color =</span> upper_color) <span class="sc">+</span>  <span class="co"># Top line</span></span>
<span id="cb31-36"><a href="#cb31-36" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;segment&quot;</span>, <span class="at">x =</span> coordx_lwr1, <span class="at">y =</span> coordy_lwr1, <span class="at">xend =</span> coordx_lwr1, <span class="at">yend =</span> coordy_upr1, </span>
<span id="cb31-37"><a href="#cb31-37" tabindex="-1"></a>           <span class="at">linewidth =</span> <span class="fl">0.4</span>, <span class="at">color =</span> upper_color) <span class="sc">+</span>  <span class="co"># Left line</span></span>
<span id="cb31-38"><a href="#cb31-38" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;segment&quot;</span>, <span class="at">x =</span> coordx_upr1, <span class="at">y =</span> coordy_lwr1, <span class="at">xend =</span> coordx_upr1, <span class="at">yend =</span> coordy_upr1, </span>
<span id="cb31-39"><a href="#cb31-39" tabindex="-1"></a>           <span class="at">linewidth =</span> <span class="fl">0.4</span>, <span class="at">color =</span> upper_color) <span class="sc">+</span>  <span class="co"># Right line</span></span>
<span id="cb31-40"><a href="#cb31-40" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;segment&quot;</span>, <span class="at">x =</span> coordx_lwr2, <span class="at">y =</span> coordy_lwr2, <span class="at">xend =</span> coordx_upr2, <span class="at">yend =</span> coordy_lwr2, </span>
<span id="cb31-41"><a href="#cb31-41" tabindex="-1"></a>           <span class="at">linewidth =</span> <span class="fl">0.4</span>, <span class="at">color =</span> lower_color) <span class="sc">+</span>  </span>
<span id="cb31-42"><a href="#cb31-42" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;segment&quot;</span>, <span class="at">x =</span> coordx_lwr2, <span class="at">y =</span> coordy_upr2, <span class="at">xend =</span> coordx_upr2, <span class="at">yend =</span> coordy_upr2, </span>
<span id="cb31-43"><a href="#cb31-43" tabindex="-1"></a>           <span class="at">linewidth =</span> <span class="fl">0.4</span>, <span class="at">color =</span> lower_color) <span class="sc">+</span>  </span>
<span id="cb31-44"><a href="#cb31-44" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;segment&quot;</span>, <span class="at">x =</span> coordx_lwr2, <span class="at">y =</span> coordy_lwr2, <span class="at">xend =</span> coordx_lwr2, <span class="at">yend =</span> coordy_upr2, </span>
<span id="cb31-45"><a href="#cb31-45" tabindex="-1"></a>           <span class="at">linewidth =</span> <span class="fl">0.4</span>, <span class="at">color =</span> lower_color) <span class="sc">+</span>  </span>
<span id="cb31-46"><a href="#cb31-46" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;segment&quot;</span>, <span class="at">x =</span> coordx_upr2, <span class="at">y =</span> coordy_lwr2, <span class="at">xend =</span> coordx_upr2, <span class="at">yend =</span> coordy_upr2, </span>
<span id="cb31-47"><a href="#cb31-47" tabindex="-1"></a>           <span class="at">linewidth =</span> <span class="fl">0.4</span>, <span class="at">color =</span> lower_color)</span>
<span id="cb31-48"><a href="#cb31-48" tabindex="-1"></a>g13 <span class="ot">&lt;-</span> graph<span class="sc">$</span><span class="fu">plot</span>(<span class="at">data =</span> <span class="st">&quot;y&quot;</span>, <span class="at">vertex_size =</span> <span class="dv">0</span>, <span class="at">p =</span> f13, <span class="at">edge_width =</span> <span class="dv">0</span>, <span class="at">data_size =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb31-49"><a href="#cb31-49" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">&quot;&quot;</span>, <span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> <span class="st">&quot;&quot;</span>) <span class="sc">+</span> </span>
<span id="cb31-50"><a href="#cb31-50" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;segment&quot;</span>, <span class="at">x =</span> coordx_lwr1, <span class="at">y =</span> coordy_lwr1, <span class="at">xend =</span> coordx_upr1, <span class="at">yend =</span> coordy_lwr1, </span>
<span id="cb31-51"><a href="#cb31-51" tabindex="-1"></a>           <span class="at">linewidth =</span> <span class="fl">0.4</span>, <span class="at">color =</span> upper_color) <span class="sc">+</span>  <span class="co"># Bottom line</span></span>
<span id="cb31-52"><a href="#cb31-52" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;segment&quot;</span>, <span class="at">x =</span> coordx_lwr1, <span class="at">y =</span> coordy_upr1, <span class="at">xend =</span> coordx_upr1, <span class="at">yend =</span> coordy_upr1, </span>
<span id="cb31-53"><a href="#cb31-53" tabindex="-1"></a>           <span class="at">linewidth =</span> <span class="fl">0.4</span>, <span class="at">color =</span> upper_color) <span class="sc">+</span>  <span class="co"># Top line</span></span>
<span id="cb31-54"><a href="#cb31-54" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;segment&quot;</span>, <span class="at">x =</span> coordx_lwr1, <span class="at">y =</span> coordy_lwr1, <span class="at">xend =</span> coordx_lwr1, <span class="at">yend =</span> coordy_upr1, </span>
<span id="cb31-55"><a href="#cb31-55" tabindex="-1"></a>           <span class="at">linewidth =</span> <span class="fl">0.4</span>, <span class="at">color =</span> upper_color) <span class="sc">+</span>  <span class="co"># Left line</span></span>
<span id="cb31-56"><a href="#cb31-56" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;segment&quot;</span>, <span class="at">x =</span> coordx_upr1, <span class="at">y =</span> coordy_lwr1, <span class="at">xend =</span> coordx_upr1, <span class="at">yend =</span> coordy_upr1, </span>
<span id="cb31-57"><a href="#cb31-57" tabindex="-1"></a>           <span class="at">linewidth =</span> <span class="fl">0.4</span>, <span class="at">color =</span> upper_color) <span class="sc">+</span>  <span class="co"># Right line</span></span>
<span id="cb31-58"><a href="#cb31-58" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;segment&quot;</span>, <span class="at">x =</span> coordx_lwr2, <span class="at">y =</span> coordy_lwr2, <span class="at">xend =</span> coordx_upr2, <span class="at">yend =</span> coordy_lwr2, </span>
<span id="cb31-59"><a href="#cb31-59" tabindex="-1"></a>           <span class="at">linewidth =</span> <span class="fl">0.4</span>, <span class="at">color =</span> lower_color) <span class="sc">+</span>  </span>
<span id="cb31-60"><a href="#cb31-60" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;segment&quot;</span>, <span class="at">x =</span> coordx_lwr2, <span class="at">y =</span> coordy_upr2, <span class="at">xend =</span> coordx_upr2, <span class="at">yend =</span> coordy_upr2, </span>
<span id="cb31-61"><a href="#cb31-61" tabindex="-1"></a>           <span class="at">linewidth =</span> <span class="fl">0.4</span>, <span class="at">color =</span> lower_color) <span class="sc">+</span>  </span>
<span id="cb31-62"><a href="#cb31-62" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;segment&quot;</span>, <span class="at">x =</span> coordx_lwr2, <span class="at">y =</span> coordy_lwr2, <span class="at">xend =</span> coordx_lwr2, <span class="at">yend =</span> coordy_upr2, </span>
<span id="cb31-63"><a href="#cb31-63" tabindex="-1"></a>           <span class="at">linewidth =</span> <span class="fl">0.4</span>, <span class="at">color =</span> lower_color) <span class="sc">+</span>  </span>
<span id="cb31-64"><a href="#cb31-64" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;segment&quot;</span>, <span class="at">x =</span> coordx_upr2, <span class="at">y =</span> coordy_lwr2, <span class="at">xend =</span> coordx_upr2, <span class="at">yend =</span> coordy_upr2, </span>
<span id="cb31-65"><a href="#cb31-65" tabindex="-1"></a>           <span class="at">linewidth =</span> <span class="fl">0.4</span>, <span class="at">color =</span> lower_color) </span>
<span id="cb31-66"><a href="#cb31-66" tabindex="-1"></a></span>
<span id="cb31-67"><a href="#cb31-67" tabindex="-1"></a>r1 <span class="ot">&lt;-</span> g13 <span class="sc">+</span> <span class="fu">xlim</span>(coordx_lwr1, coordx_upr1) <span class="sc">+</span> </span>
<span id="cb31-68"><a href="#cb31-68" tabindex="-1"></a>                    <span class="fu">ylim</span>(coordy_lwr1, coordy_upr1) <span class="sc">+</span> </span>
<span id="cb31-69"><a href="#cb31-69" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>, </span>
<span id="cb31-70"><a href="#cb31-70" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="sc">-</span><span class="fl">0.2</span><span class="sc">*</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="st">&quot;cm&quot;</span>))</span>
<span id="cb31-71"><a href="#cb31-71" tabindex="-1"></a></span>
<span id="cb31-72"><a href="#cb31-72" tabindex="-1"></a>r2 <span class="ot">&lt;-</span> g13 <span class="sc">+</span> <span class="fu">xlim</span>(coordx_lwr2, coordx_upr2) <span class="sc">+</span> </span>
<span id="cb31-73"><a href="#cb31-73" tabindex="-1"></a>                    <span class="fu">ylim</span>(coordy_lwr2, coordy_upr2) <span class="sc">+</span> </span>
<span id="cb31-74"><a href="#cb31-74" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>, </span>
<span id="cb31-75"><a href="#cb31-75" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="sc">-</span><span class="fl">0.2</span><span class="sc">*</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="st">&quot;cm&quot;</span>))</span>
<span id="cb31-76"><a href="#cb31-76" tabindex="-1"></a></span>
<span id="cb31-77"><a href="#cb31-77" tabindex="-1"></a><span class="co"># Arrange p2 and p3 horizontally</span></span>
<span id="cb31-78"><a href="#cb31-78" tabindex="-1"></a>left_col <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(r2, r1, <span class="at">labels =</span> <span class="cn">NULL</span>, <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">rel_heights =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb31-79"><a href="#cb31-79" tabindex="-1"></a></span>
<span id="cb31-80"><a href="#cb31-80" tabindex="-1"></a><span class="co"># Combine the top row with p1 in a grid</span></span>
<span id="cb31-81"><a href="#cb31-81" tabindex="-1"></a>combined_plot <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(left_col, g12, <span class="at">labels =</span> <span class="cn">NULL</span>, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">rel_widths =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)) </span>
<span id="cb31-82"><a href="#cb31-82" tabindex="-1"></a>final_plot <span class="ot">&lt;-</span> <span class="fu">annotate_figure</span>(combined_plot, <span class="at">left =</span> <span class="fu">textGrob</span>(<span class="st">&quot;Latitude&quot;</span>, <span class="at">rot =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">cex =</span> <span class="fl">0.8</span>)),</span>
<span id="cb31-83"><a href="#cb31-83" tabindex="-1"></a>                              <span class="at">bottom =</span> <span class="fu">textGrob</span>(<span class="st">&quot;Longitude&quot;</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">cex =</span> <span class="fl">0.8</span>)))</span>
<span id="cb31-84"><a href="#cb31-84" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">here</span>(<span class="st">&quot;data_files/mean_better_3.png&quot;</span>), <span class="at">width =</span> <span class="fl">11.2</span>, <span class="at">height =</span> <span class="fl">5.43</span>, <span class="at">plot =</span> final_plot, <span class="at">dpi =</span> <span class="dv">500</span>)</span>
<span id="cb31-85"><a href="#cb31-85" tabindex="-1"></a><span class="co"># Print the combined plot</span></span>
<span id="cb31-86"><a href="#cb31-86" tabindex="-1"></a><span class="fu">print</span>(final_plot)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="pems_repl1_files/figure-html/unnamed-chunk-19-1.png" alt="Figure 3: Average speeds of the first part of the data. Points represent the point value at each available location, and edges represent the $\mathrm{mean.cov}(s)$ covariate." width="1075.2" />
<p class="caption">
Figure 3: Average speeds of the first part of the data. Points represent
the point value at each available location, and edges represent the
<span class="math inline">\(\mathrm{mean.cov}(s)\)</span> covariate.
</p>
</div>
<p>We finally add the remaining half of the replicates to the graph and
plot one of them.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a>df_rep <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(Y), <span class="cf">function</span>(i){<span class="fu">data.frame</span>(<span class="at">y =</span> Y[i,],</span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a>                                                   <span class="at">mean_value =</span> cov_for_mean,</span>
<span id="cb32-3"><a href="#cb32-3" tabindex="-1"></a>                                                   <span class="at">edge_number =</span> PtE[,<span class="dv">1</span>],</span>
<span id="cb32-4"><a href="#cb32-4" tabindex="-1"></a>                                                   <span class="at">distance_on_edge =</span> PtE[,<span class="dv">2</span>],</span>
<span id="cb32-5"><a href="#cb32-5" tabindex="-1"></a>                                                   <span class="at">repl =</span> i)})</span>
<span id="cb32-6"><a href="#cb32-6" tabindex="-1"></a>df_rep <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, df_rep)</span>
<span id="cb32-7"><a href="#cb32-7" tabindex="-1"></a></span>
<span id="cb32-8"><a href="#cb32-8" tabindex="-1"></a>graph<span class="sc">$</span><span class="fu">add_observations</span>(<span class="at">data =</span> df_rep, <span class="at">normalized =</span> <span class="cn">TRUE</span>, <span class="at">clear_obs =</span> <span class="cn">TRUE</span>, <span class="at">group =</span> <span class="st">&quot;repl&quot;</span>)</span></code></pre></div>
<p>Below we plot replicate 14.</p>
<div style="color: blue;">
<hr />
<p><strong>Press the Show button below to reveal the code.</strong></p>
<hr />
</div>
<div class="sourceCode" id="cb33"><pre
class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a>g12 <span class="ot">&lt;-</span> graph<span class="sc">$</span><span class="fu">plot</span>(<span class="at">data =</span> <span class="st">&quot;y&quot;</span>, </span>
<span id="cb33-2"><a href="#cb33-2" tabindex="-1"></a>                 <span class="at">p =</span> p12,</span>
<span id="cb33-3"><a href="#cb33-3" tabindex="-1"></a>                 <span class="at">group =</span> <span class="dv">1</span>, </span>
<span id="cb33-4"><a href="#cb33-4" tabindex="-1"></a>                 <span class="at">vertex_size =</span> <span class="dv">0</span>, </span>
<span id="cb33-5"><a href="#cb33-5" tabindex="-1"></a>                 <span class="at">data_size =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb33-6"><a href="#cb33-6" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb33-7"><a href="#cb33-7" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">&quot;Palatino&quot;</span>), </span>
<span id="cb33-8"><a href="#cb33-8" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb33-9"><a href="#cb33-9" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb33-10"><a href="#cb33-10" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="sc">-</span><span class="fl">0.4</span><span class="sc">*</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="st">&quot;cm&quot;</span>)) <span class="sc">+</span></span>
<span id="cb33-11"><a href="#cb33-11" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">&quot;&quot;</span>, <span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> <span class="st">&quot;&quot;</span>) <span class="sc">+</span></span>
<span id="cb33-12"><a href="#cb33-12" tabindex="-1"></a>  <span class="fu">xlim</span>(x_left, x_right) <span class="sc">+</span> </span>
<span id="cb33-13"><a href="#cb33-13" tabindex="-1"></a>  <span class="fu">ylim</span>(y_bottom, y_top) <span class="sc">+</span></span>
<span id="cb33-14"><a href="#cb33-14" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;segment&quot;</span>, <span class="at">x =</span> coordx_lwr1, <span class="at">y =</span> coordy_lwr1, <span class="at">xend =</span> coordx_upr1, <span class="at">yend =</span> coordy_lwr1, </span>
<span id="cb33-15"><a href="#cb33-15" tabindex="-1"></a>           <span class="at">linewidth =</span> <span class="fl">0.4</span>, <span class="at">color =</span> upper_color) <span class="sc">+</span>  <span class="co"># Bottom line</span></span>
<span id="cb33-16"><a href="#cb33-16" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;segment&quot;</span>, <span class="at">x =</span> coordx_lwr1, <span class="at">y =</span> coordy_upr1, <span class="at">xend =</span> coordx_upr1, <span class="at">yend =</span> coordy_upr1, </span>
<span id="cb33-17"><a href="#cb33-17" tabindex="-1"></a>           <span class="at">linewidth =</span> <span class="fl">0.4</span>, <span class="at">color =</span> upper_color) <span class="sc">+</span>  <span class="co"># Top line</span></span>
<span id="cb33-18"><a href="#cb33-18" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;segment&quot;</span>, <span class="at">x =</span> coordx_lwr1, <span class="at">y =</span> coordy_lwr1, <span class="at">xend =</span> coordx_lwr1, <span class="at">yend =</span> coordy_upr1, </span>
<span id="cb33-19"><a href="#cb33-19" tabindex="-1"></a>           <span class="at">linewidth =</span> <span class="fl">0.4</span>, <span class="at">color =</span> upper_color) <span class="sc">+</span>  <span class="co"># Left line</span></span>
<span id="cb33-20"><a href="#cb33-20" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;segment&quot;</span>, <span class="at">x =</span> coordx_upr1, <span class="at">y =</span> coordy_lwr1, <span class="at">xend =</span> coordx_upr1, <span class="at">yend =</span> coordy_upr1, </span>
<span id="cb33-21"><a href="#cb33-21" tabindex="-1"></a>           <span class="at">linewidth =</span> <span class="fl">0.4</span>, <span class="at">color =</span> upper_color) <span class="sc">+</span>  <span class="co"># Right line</span></span>
<span id="cb33-22"><a href="#cb33-22" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;segment&quot;</span>, <span class="at">x =</span> coordx_lwr2, <span class="at">y =</span> coordy_lwr2, <span class="at">xend =</span> coordx_upr2, <span class="at">yend =</span> coordy_lwr2, </span>
<span id="cb33-23"><a href="#cb33-23" tabindex="-1"></a>           <span class="at">linewidth =</span> <span class="fl">0.4</span>, <span class="at">color =</span> lower_color) <span class="sc">+</span>  </span>
<span id="cb33-24"><a href="#cb33-24" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;segment&quot;</span>, <span class="at">x =</span> coordx_lwr2, <span class="at">y =</span> coordy_upr2, <span class="at">xend =</span> coordx_upr2, <span class="at">yend =</span> coordy_upr2, </span>
<span id="cb33-25"><a href="#cb33-25" tabindex="-1"></a>           <span class="at">linewidth =</span> <span class="fl">0.4</span>, <span class="at">color =</span> lower_color) <span class="sc">+</span>  </span>
<span id="cb33-26"><a href="#cb33-26" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;segment&quot;</span>, <span class="at">x =</span> coordx_lwr2, <span class="at">y =</span> coordy_lwr2, <span class="at">xend =</span> coordx_lwr2, <span class="at">yend =</span> coordy_upr2, </span>
<span id="cb33-27"><a href="#cb33-27" tabindex="-1"></a>           <span class="at">linewidth =</span> <span class="fl">0.4</span>, <span class="at">color =</span> lower_color) <span class="sc">+</span>  </span>
<span id="cb33-28"><a href="#cb33-28" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;segment&quot;</span>, <span class="at">x =</span> coordx_upr2, <span class="at">y =</span> coordy_lwr2, <span class="at">xend =</span> coordx_upr2, <span class="at">yend =</span> coordy_upr2, </span>
<span id="cb33-29"><a href="#cb33-29" tabindex="-1"></a>           <span class="at">linewidth =</span> <span class="fl">0.4</span>, <span class="at">color =</span> lower_color)</span>
<span id="cb33-30"><a href="#cb33-30" tabindex="-1"></a></span>
<span id="cb33-31"><a href="#cb33-31" tabindex="-1"></a>g13 <span class="ot">&lt;-</span> graph<span class="sc">$</span><span class="fu">plot</span>(<span class="at">data =</span> <span class="st">&quot;y&quot;</span>, </span>
<span id="cb33-32"><a href="#cb33-32" tabindex="-1"></a>                 <span class="at">p =</span> p13,</span>
<span id="cb33-33"><a href="#cb33-33" tabindex="-1"></a>                 <span class="at">group =</span> <span class="dv">1</span>, </span>
<span id="cb33-34"><a href="#cb33-34" tabindex="-1"></a>                 <span class="at">vertex_size =</span> <span class="dv">0</span>, </span>
<span id="cb33-35"><a href="#cb33-35" tabindex="-1"></a>                 <span class="at">data_size =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb33-36"><a href="#cb33-36" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb33-37"><a href="#cb33-37" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">&quot;Palatino&quot;</span>), </span>
<span id="cb33-38"><a href="#cb33-38" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb33-39"><a href="#cb33-39" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb33-40"><a href="#cb33-40" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="sc">-</span><span class="fl">0.4</span><span class="sc">*</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="st">&quot;cm&quot;</span>)) <span class="sc">+</span></span>
<span id="cb33-41"><a href="#cb33-41" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">&quot;speed&quot;</span>, <span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> <span class="st">&quot;&quot;</span>) <span class="sc">+</span></span>
<span id="cb33-42"><a href="#cb33-42" tabindex="-1"></a>  <span class="fu">xlim</span>(x_left, x_right) <span class="sc">+</span> </span>
<span id="cb33-43"><a href="#cb33-43" tabindex="-1"></a>  <span class="fu">ylim</span>(y_bottom, y_top) <span class="sc">+</span></span>
<span id="cb33-44"><a href="#cb33-44" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;segment&quot;</span>, <span class="at">x =</span> coordx_lwr1, <span class="at">y =</span> coordy_lwr1, <span class="at">xend =</span> coordx_upr1, <span class="at">yend =</span> coordy_lwr1, </span>
<span id="cb33-45"><a href="#cb33-45" tabindex="-1"></a>           <span class="at">linewidth =</span> <span class="fl">0.4</span>, <span class="at">color =</span> upper_color) <span class="sc">+</span>  <span class="co"># Bottom line</span></span>
<span id="cb33-46"><a href="#cb33-46" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;segment&quot;</span>, <span class="at">x =</span> coordx_lwr1, <span class="at">y =</span> coordy_upr1, <span class="at">xend =</span> coordx_upr1, <span class="at">yend =</span> coordy_upr1, </span>
<span id="cb33-47"><a href="#cb33-47" tabindex="-1"></a>           <span class="at">linewidth =</span> <span class="fl">0.4</span>, <span class="at">color =</span> upper_color) <span class="sc">+</span>  <span class="co"># Top line</span></span>
<span id="cb33-48"><a href="#cb33-48" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;segment&quot;</span>, <span class="at">x =</span> coordx_lwr1, <span class="at">y =</span> coordy_lwr1, <span class="at">xend =</span> coordx_lwr1, <span class="at">yend =</span> coordy_upr1, </span>
<span id="cb33-49"><a href="#cb33-49" tabindex="-1"></a>           <span class="at">linewidth =</span> <span class="fl">0.4</span>, <span class="at">color =</span> upper_color) <span class="sc">+</span>  <span class="co"># Left line</span></span>
<span id="cb33-50"><a href="#cb33-50" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;segment&quot;</span>, <span class="at">x =</span> coordx_upr1, <span class="at">y =</span> coordy_lwr1, <span class="at">xend =</span> coordx_upr1, <span class="at">yend =</span> coordy_upr1, </span>
<span id="cb33-51"><a href="#cb33-51" tabindex="-1"></a>           <span class="at">linewidth =</span> <span class="fl">0.4</span>, <span class="at">color =</span> upper_color) <span class="sc">+</span>  <span class="co"># Right line</span></span>
<span id="cb33-52"><a href="#cb33-52" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;segment&quot;</span>, <span class="at">x =</span> coordx_lwr2, <span class="at">y =</span> coordy_lwr2, <span class="at">xend =</span> coordx_upr2, <span class="at">yend =</span> coordy_lwr2, </span>
<span id="cb33-53"><a href="#cb33-53" tabindex="-1"></a>           <span class="at">linewidth =</span> <span class="fl">0.4</span>, <span class="at">color =</span> lower_color) <span class="sc">+</span>  </span>
<span id="cb33-54"><a href="#cb33-54" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;segment&quot;</span>, <span class="at">x =</span> coordx_lwr2, <span class="at">y =</span> coordy_upr2, <span class="at">xend =</span> coordx_upr2, <span class="at">yend =</span> coordy_upr2, </span>
<span id="cb33-55"><a href="#cb33-55" tabindex="-1"></a>           <span class="at">linewidth =</span> <span class="fl">0.4</span>, <span class="at">color =</span> lower_color) <span class="sc">+</span>  </span>
<span id="cb33-56"><a href="#cb33-56" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;segment&quot;</span>, <span class="at">x =</span> coordx_lwr2, <span class="at">y =</span> coordy_lwr2, <span class="at">xend =</span> coordx_lwr2, <span class="at">yend =</span> coordy_upr2, </span>
<span id="cb33-57"><a href="#cb33-57" tabindex="-1"></a>           <span class="at">linewidth =</span> <span class="fl">0.4</span>, <span class="at">color =</span> lower_color) <span class="sc">+</span>  </span>
<span id="cb33-58"><a href="#cb33-58" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;segment&quot;</span>, <span class="at">x =</span> coordx_upr2, <span class="at">y =</span> coordy_lwr2, <span class="at">xend =</span> coordx_upr2, <span class="at">yend =</span> coordy_upr2, </span>
<span id="cb33-59"><a href="#cb33-59" tabindex="-1"></a>           <span class="at">linewidth =</span> <span class="fl">0.4</span>, <span class="at">color =</span> lower_color)</span>
<span id="cb33-60"><a href="#cb33-60" tabindex="-1"></a></span>
<span id="cb33-61"><a href="#cb33-61" tabindex="-1"></a>r1 <span class="ot">&lt;-</span> g13 <span class="sc">+</span> <span class="fu">xlim</span>(coordx_lwr1, coordx_upr1) <span class="sc">+</span> </span>
<span id="cb33-62"><a href="#cb33-62" tabindex="-1"></a>                    <span class="fu">ylim</span>(coordy_lwr1, coordy_upr1) <span class="sc">+</span> </span>
<span id="cb33-63"><a href="#cb33-63" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>, </span>
<span id="cb33-64"><a href="#cb33-64" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="sc">-</span><span class="fl">0.2</span><span class="sc">*</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="st">&quot;cm&quot;</span>))</span>
<span id="cb33-65"><a href="#cb33-65" tabindex="-1"></a></span>
<span id="cb33-66"><a href="#cb33-66" tabindex="-1"></a>r2 <span class="ot">&lt;-</span> g13 <span class="sc">+</span> <span class="fu">xlim</span>(coordx_lwr2, coordx_upr2) <span class="sc">+</span> </span>
<span id="cb33-67"><a href="#cb33-67" tabindex="-1"></a>                    <span class="fu">ylim</span>(coordy_lwr2, coordy_upr2) <span class="sc">+</span> </span>
<span id="cb33-68"><a href="#cb33-68" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>, </span>
<span id="cb33-69"><a href="#cb33-69" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="sc">-</span><span class="fl">0.2</span><span class="sc">*</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="st">&quot;cm&quot;</span>))</span>
<span id="cb33-70"><a href="#cb33-70" tabindex="-1"></a></span>
<span id="cb33-71"><a href="#cb33-71" tabindex="-1"></a><span class="co"># Arrange p2 and p3 horizontally</span></span>
<span id="cb33-72"><a href="#cb33-72" tabindex="-1"></a>left_col <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(r2, r1, <span class="at">labels =</span> <span class="cn">NULL</span>, <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">rel_heights =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb33-73"><a href="#cb33-73" tabindex="-1"></a></span>
<span id="cb33-74"><a href="#cb33-74" tabindex="-1"></a><span class="co"># Combine the top row with p1 in a grid</span></span>
<span id="cb33-75"><a href="#cb33-75" tabindex="-1"></a>combined_plot <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(left_col, g12, <span class="at">labels =</span> <span class="cn">NULL</span>, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">rel_widths =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)) </span>
<span id="cb33-76"><a href="#cb33-76" tabindex="-1"></a>final_plot <span class="ot">&lt;-</span> <span class="fu">annotate_figure</span>(combined_plot, <span class="at">left =</span> <span class="fu">textGrob</span>(<span class="st">&quot;Latitude&quot;</span>, <span class="at">rot =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">cex =</span> <span class="fl">0.8</span>)),</span>
<span id="cb33-77"><a href="#cb33-77" tabindex="-1"></a>                              <span class="at">bottom =</span> <span class="fu">textGrob</span>(<span class="st">&quot;Longitude&quot;</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">cex =</span> <span class="fl">0.8</span>)))</span>
<span id="cb33-78"><a href="#cb33-78" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">here</span>(<span class="st">&quot;data_files/replicate14_3.png&quot;</span>), <span class="at">width =</span> <span class="fl">11.2</span>, <span class="at">height =</span> <span class="fl">5.43</span>, <span class="at">plot =</span> final_plot, <span class="at">dpi =</span> <span class="dv">500</span>)</span>
<span id="cb33-79"><a href="#cb33-79" tabindex="-1"></a><span class="co"># Print the combined plot</span></span>
<span id="cb33-80"><a href="#cb33-80" tabindex="-1"></a><span class="fu">print</span>(final_plot)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="pems_repl1_files/figure-html/unnamed-chunk-21-1.png" alt="Figure 4: Speed observations (in mph) on the highway network of the city of San Jose in California, recorded on April 3, 2017. The left panels are zoomed-in areas of the panel to the right." width="1075.2" />
<p class="caption">
Figure 4: Speed observations (in mph) on the highway network of the city
of San Jose in California, recorded on April 3, 2017. The left panels
are zoomed-in areas of the panel to the right.
</p>
</div>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a><span class="fu">save</span>(graph, cov, cov_for_mean_to_plot, data_prd_list_mesh, <span class="at">file =</span> <span class="fu">here</span>(<span class="st">&quot;data_files/pems_repl1_data.RData&quot;</span>))</span></code></pre></div>
<div id="references" class="section level1">
<h1>References</h1>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a><span class="fu">cite_packages</span>(<span class="at">output =</span> <span class="st">&quot;paragraph&quot;</span>, <span class="at">out.dir =</span> <span class="st">&quot;.&quot;</span>)</span></code></pre></div>
<p>We used R version 4.4.1 <span class="citation">(R Core Team
2024)</span> and the following R packages: cowplot v. 1.1.3 <span
class="citation">(Wilke 2024)</span>, ggmap v. 4.0.0.900 <span
class="citation">(Kahle and Wickham 2013)</span>, ggpubr v. 0.6.0 <span
class="citation">(Kassambara 2023)</span>, ggtext v. 0.1.2 <span
class="citation">(Wilke and Wiernik 2022)</span>, here v. 1.0.1 <span
class="citation">(Mller 2020)</span>, htmltools v. 0.5.8.1 <span
class="citation">(Cheng et al. 2024)</span>, INLA v. 24.10.7.2 <span
class="citation">(Rue, Martino, and Chopin 2009; Lindgren, Rue, and
Lindstrm 2011; Martins et al. 2013; Lindgren and Rue 2015; De Coninck
et al. 2016; Rue et al. 2017; Verbosio et al. 2017; Bakka et al. 2018;
Kourounis, Fuchs, and Schenk 2018)</span>, inlabru v. 2.11.1.9004 <span
class="citation">(Yuan et al. 2017; Bachl et al. 2019)</span>, knitr v.
1.48 <span class="citation">(Xie 2014, 2015, 2024)</span>, latex2exp v.
0.9.6 <span class="citation">(Meschiari 2022)</span>, Matrix v. 1.6.5
<span class="citation">(Bates, Maechler, and Jagan 2024)</span>,
MetricGraph v. 1.3.0.9000 <span class="citation">(Bolin, Simas, and
Wallin 2023b, 2023a, 2023c, 2024; Bolin et al. 2024)</span>,
OpenStreetMap v. 0.4.0 <span class="citation">(Fellows and JMapViewer
library by Jan Peter Stotz 2023)</span>, patchwork v. 1.2.0 <span
class="citation">(Pedersen 2024)</span>, plotly v. 4.10.4 <span
class="citation">(Sievert 2020)</span>, plotrix v. 3.8.4 <span
class="citation">(J 2006)</span>, reshape2 v. 1.4.4 <span
class="citation">(Wickham 2007)</span>, rmarkdown v. 2.28 <span
class="citation">(Xie, Allaire, and Grolemund 2018; Xie, Dervieux, and
Riederer 2020; Allaire et al. 2024)</span>, rSPDE v. 2.3.3.9000 <span
class="citation">(Bolin and Kirchner 2020; Bolin and Simas 2023; Bolin,
Simas, and Xiong 2024)</span>, scales v. 1.3.0 <span
class="citation">(Wickham, Pedersen, and Seidel 2023)</span>, sf v.
1.0.17 <span class="citation">(Pebesma 2018; Pebesma and Bivand
2023)</span>, tidyverse v. 2.0.0 <span class="citation">(Wickham et al.
2019)</span>, viridis v. 0.6.4 <span class="citation">(Garnier et al.
2023)</span>, xaringanExtra v. 0.8.0 <span class="citation">(Aden-Buie
and Warkentin 2024)</span>.</p>
<div id="refs" class="references csl-bib-body hanging-indent"
entry-spacing="0">
<div id="ref-xaringanExtra" class="csl-entry">
Aden-Buie, Garrick, and Matthew T. Warkentin. 2024. <em><span
class="nocase">xaringanExtra</span>: Extras and Extensions for
<span><span class="nocase">xaringan</span></span> Slides</em>. <a
href="https://CRAN.R-project.org/package=xaringanExtra">https://CRAN.R-project.org/package=xaringanExtra</a>.
</div>
<div id="ref-rmarkdown2024" class="csl-entry">
Allaire, JJ, Yihui Xie, Christophe Dervieux, Jonathan McPherson, Javier
Luraschi, Kevin Ushey, Aron Atkins, et al. 2024. <em><span
class="nocase">rmarkdown</span>: Dynamic Documents for r</em>. <a
href="https://github.com/rstudio/rmarkdown">https://github.com/rstudio/rmarkdown</a>.
</div>
<div id="ref-inlabru2019" class="csl-entry">
Bachl, Fabian E., Finn Lindgren, David L. Borchers, and Janine B.
Illian. 2019. <span><span class="nocase">inlabru</span>: An
<span>R</span> Package for <span>Bayesian</span> Spatial Modelling from
Ecological Survey Data.</span> <em>Methods in Ecology and
Evolution</em> 10: 76066. <a
href="https://doi.org/10.1111/2041-210X.13168">https://doi.org/10.1111/2041-210X.13168</a>.
</div>
<div id="ref-INLA2018f" class="csl-entry">
Bakka, Haakon, Hvard Rue, Geir-Arne Fuglstad, Andrea I. Riebler, David
Bolin, Janine Illian, Elias Krainski, Daniel P. Simpson, and Finn K.
Lindgren. 2018. <span>Spatial Modelling with <span>INLA</span>:
<span>A</span> Review.</span> <em>WIRES (Invited Extended Review)</em>
xx (Feb): xx. <a
href="http://arxiv.org/abs/1802.06350">http://arxiv.org/abs/1802.06350</a>.
</div>
<div id="ref-Matrix" class="csl-entry">
Bates, Douglas, Martin Maechler, and Mikael Jagan. 2024.
<em><span>Matrix</span>: Sparse and Dense Matrix Classes and
Methods</em>. <a
href="https://CRAN.R-project.org/package=Matrix">https://CRAN.R-project.org/package=Matrix</a>.
</div>
<div id="ref-rSPDE2020" class="csl-entry">
Bolin, David, and Kristin Kirchner. 2020. <span>The Rational
<span>SPDE</span> Approach for <span>Gaussian</span> Random Fields with
General Smoothness.</span> <em>Journal of Computational and Graphical
Statistics</em> 29 (2): 27485. <a
href="https://doi.org/10.1080/10618600.2019.1665537">https://doi.org/10.1080/10618600.2019.1665537</a>.
</div>
<div id="ref-MetricGraph2024c" class="csl-entry">
Bolin, David, Mihly Kovcs, Vivek Kumar, and Alexandre B. Simas. 2024.
<span>Regularity and Numerical Approximation of Fractional Elliptic
Differential Equations on Compact Metric Graphs.</span> <em>Mathematics
of Computation</em> 93 (349): 243972. <a
href="https://doi.org/10.1090/mcom/3929">https://doi.org/10.1090/mcom/3929</a>.
</div>
<div id="ref-rSPDE2023" class="csl-entry">
Bolin, David, and Alexandre B. Simas. 2023. <em><span
class="nocase">rSPDE</span>: Rational Approximations of Fractional
Stochastic Partial Differential Equations</em>. <a
href="https://CRAN.R-project.org/package=rSPDE">https://CRAN.R-project.org/package=rSPDE</a>.
</div>
<div id="ref-MetricGraph2023d" class="csl-entry">
Bolin, David, Alexandre B. Simas, and Jonas Wallin. 2023a. <span>Markov
Properties of Gaussian Random Fields on Compact Metric Graphs.</span>
<em>arXiv Preprint arXiv:2304.03190</em>. <a
href="https://doi.org/10.48550/arXiv.2304.03190">https://doi.org/10.48550/arXiv.2304.03190</a>.
</div>
<div id="ref-MetricGraph2023a" class="csl-entry">
. 2023b. <em><span>MetricGraph</span>: Random Fields on Metric
Graphs</em>. <a
href="https://CRAN.R-project.org/package=MetricGraph">https://CRAN.R-project.org/package=MetricGraph</a>.
</div>
<div id="ref-MetricGraph2023e" class="csl-entry">
. 2023c. <span>Statistical Inference for Gaussian Whittle-Matrn
Fields on Metric Graphs.</span> <em>arXiv Preprint
arXiv:2304.10372</em>. <a
href="https://doi.org/10.48550/arXiv.2304.10372">https://doi.org/10.48550/arXiv.2304.10372</a>.
</div>
<div id="ref-MetricGraph2024b" class="csl-entry">
. 2024. <span>Gaussian Whittle-Matrn Fields on Metric
Graphs.</span> <em>Bernoulli</em> 30 (2): 161139. <a
href="https://doi.org/10.3150/23-BEJ1647">https://doi.org/10.3150/23-BEJ1647</a>.
</div>
<div id="ref-rSPDE2024" class="csl-entry">
Bolin, David, Alexandre B. Simas, and Zhen Xiong. 2024.
<span>Covariance-Based Rational Approximations of Fractional SPDEs for
Computationally Efficient Bayesian Inference.</span> <em>Journal of
Computational and Graphical Statistics</em> 33 (1): 6474. <a
href="https://doi.org/10.1080/10618600.2023.2231051">https://doi.org/10.1080/10618600.2023.2231051</a>.
</div>
<div id="ref-htmltools" class="csl-entry">
Cheng, Joe, Carson Sievert, Barret Schloerke, Winston Chang, Yihui Xie,
and Jeff Allen. 2024. <em><span class="nocase">htmltools</span>: Tools
for HTML</em>. <a
href="https://CRAN.R-project.org/package=htmltools">https://CRAN.R-project.org/package=htmltools</a>.
</div>
<div id="ref-INLA2016g" class="csl-entry">
De Coninck, Arne, Bernard De Baets, Drosos Kourounis, Fabio Verbosio,
Olaf Schenk, Steven Maenhout, and Jan Fostier. 2016.
<span><span>Needles</span>: Toward Large-Scale Genomic Prediction with
Marker-by-Environment Interaction.</span> <em>Genetics</em> 203 (1):
54355. <a
href="https://doi.org/10.1534/genetics.115.179887">https://doi.org/10.1534/genetics.115.179887</a>.
</div>
<div id="ref-OpenStreetMap" class="csl-entry">
Fellows, Ian, and using the JMapViewer library by Jan Peter Stotz. 2023.
<em><span>OpenStreetMap</span>: Access to Open Street Map Raster
Images</em>. <a
href="https://CRAN.R-project.org/package=OpenStreetMap">https://CRAN.R-project.org/package=OpenStreetMap</a>.
</div>
<div id="ref-viridis" class="csl-entry">
Garnier, Simon, Ross, Noam, Rudis, Robert, Camargo, et al. 2023.
<em><span class="nocase">viridis(Lite)</span> - Colorblind-Friendly
Color Maps for r</em>. <a
href="https://doi.org/10.5281/zenodo.4679423">https://doi.org/10.5281/zenodo.4679423</a>.
</div>
<div id="ref-plotrix" class="csl-entry">
J, Lemon. 2006. <span><span>Plotrix</span>: A Package in the Red Light
District of r.</span> <em>R-News</em> 6 (4): 812.
</div>
<div id="ref-ggmap" class="csl-entry">
Kahle, David, and Hadley Wickham. 2013. <span><span
class="nocase">ggmap</span>: Spatial Visualization with Ggplot2.</span>
<em>The R Journal</em> 5 (1): 14461. <a
href="https://journal.r-project.org/archive/2013-1/kahle-wickham.pdf">https://journal.r-project.org/archive/2013-1/kahle-wickham.pdf</a>.
</div>
<div id="ref-ggpubr" class="csl-entry">
Kassambara, Alboukadel. 2023. <em><span class="nocase">ggpubr</span>:
<span><span class="nocase">ggplot2</span></span> Based Publication
Ready Plots</em>. <a
href="https://CRAN.R-project.org/package=ggpubr">https://CRAN.R-project.org/package=ggpubr</a>.
</div>
<div id="ref-INLA2018i" class="csl-entry">
Kourounis, D., A. Fuchs, and O. Schenk. 2018. <span>Towards the Next
Generation of Multiperiod Optimal Power Flow Solvers.</span> <em>IEEE
Transactions on Power Systems</em> PP (99): 110. <a
href="https://doi.org/10.1109/TPWRS.2017.2789187">https://doi.org/10.1109/TPWRS.2017.2789187</a>.
</div>
<div id="ref-INLA2015d" class="csl-entry">
Lindgren, Finn, and Hvard Rue. 2015. <span>Bayesian Spatial Modelling
with <span>R</span>-<span>INLA</span>.</span> <em>Journal of
Statistical Software</em> 63 (19): 125. <a
href="http://www.jstatsoft.org/v63/i19/">http://www.jstatsoft.org/v63/i19/</a>.
</div>
<div id="ref-INLA2011c" class="csl-entry">
Lindgren, Finn, Hvard Rue, and Johan Lindstrm. 2011. <span>An
Explicit Link Between <span>Gaussian</span> Fields and
<span>Gaussian</span> <span>Markov</span> Random Fields: The Stochastic
Partial Differential Equation Approach (with Discussion).</span>
<em>Journal of the Royal Statistical Society B</em> 73 (4): 42398.
</div>
<div id="ref-INLA2013b" class="csl-entry">
Martins, Thiago G., Daniel Simpson, Finn Lindgren, and Hvard Rue. 2013.
<span>Bayesian Computing with <span>INLA</span>: <span>N</span>ew
Features.</span> <em>Computational Statistics and Data Analysis</em>
67: 6883.
</div>
<div id="ref-latex2exp" class="csl-entry">
Meschiari, Stefano. 2022. <em>Latex2exp: Use LaTeX Expressions in
Plots</em>. <a
href="https://CRAN.R-project.org/package=latex2exp">https://CRAN.R-project.org/package=latex2exp</a>.
</div>
<div id="ref-here" class="csl-entry">
Mller, Kirill. 2020. <em><span class="nocase">here</span>: A Simpler
Way to Find Your Files</em>. <a
href="https://CRAN.R-project.org/package=here">https://CRAN.R-project.org/package=here</a>.
</div>
<div id="ref-sf2018" class="csl-entry">
Pebesma, Edzer. 2018. <span><span class="nocase">Simple Features for R:
Standardized Support for Spatial Vector Data</span>.</span>
<em><span>The R Journal</span></em> 10 (1): 43946. <a
href="https://doi.org/10.32614/RJ-2018-009">https://doi.org/10.32614/RJ-2018-009</a>.
</div>
<div id="ref-sf2023" class="csl-entry">
Pebesma, Edzer, and Roger Bivand. 2023. <em><span class="nocase">Spatial
Data Science: With applications in R</span></em>. <span>Chapman and
Hall/CRC</span>. <a
href="https://doi.org/10.1201/9780429459016">https://doi.org/10.1201/9780429459016</a>.
</div>
<div id="ref-patchwork" class="csl-entry">
Pedersen, Thomas Lin. 2024. <em><span class="nocase">patchwork</span>:
The Composer of Plots</em>. <a
href="https://CRAN.R-project.org/package=patchwork">https://CRAN.R-project.org/package=patchwork</a>.
</div>
<div id="ref-base" class="csl-entry">
R Core Team. 2024. <em><span>R</span>: A Language and Environment for
Statistical Computing</em>. Vienna, Austria: R Foundation for
Statistical Computing. <a
href="https://www.R-project.org/">https://www.R-project.org/</a>.
</div>
<div id="ref-INLA2009a" class="csl-entry">
Rue, Hvard, Sara Martino, and Nicholas Chopin. 2009. <span>Approximate
<span>Bayesian</span> Inference for Latent <span>Gaussian</span> Models
Using Integrated Nested <span>Laplace</span> Approximations (with
Discussion).</span> <em>Journal of the Royal Statistical Society B</em>
71: 31992.
</div>
<div id="ref-INLA2017e" class="csl-entry">
Rue, Hvard, Andrea I. Riebler, Sigrunn H. Srbye, Janine B. Illian,
Daniel P. Simpson, and Finn K. Lindgren. 2017. <span>Bayesian Computing
with <span>INLA</span>: <span>A</span> Review.</span> <em>Annual
Reviews of Statistics and Its Applications</em> 4 (March): 395421. <a
href="http://arxiv.org/abs/1604.00860">http://arxiv.org/abs/1604.00860</a>.
</div>
<div id="ref-plotly" class="csl-entry">
Sievert, Carson. 2020. <em>Interactive Web-Based Data Visualization with
r, Plotly, and Shiny</em>. Chapman; Hall/CRC. <a
href="https://plotly-r.com">https://plotly-r.com</a>.
</div>
<div id="ref-INLA2017h" class="csl-entry">
Verbosio, Fabio, Arne De Coninck, Drosos Kourounis, and Olaf Schenk.
2017. <span>Enhancing the Scalability of Selected Inversion
Factorization Algorithms in Genomic Prediction.</span> <em>Journal of
Computational Science</em> 22 (Supplement C): 99108. <a
href="https://doi.org/10.1016/j.jocs.2017.08.013">https://doi.org/10.1016/j.jocs.2017.08.013</a>.
</div>
<div id="ref-reshape2" class="csl-entry">
Wickham, Hadley. 2007. <span>Reshaping Data with the <span
class="nocase">reshape</span> Package.</span> <em>Journal of
Statistical Software</em> 21 (12): 120. <a
href="http://www.jstatsoft.org/v21/i12/">http://www.jstatsoft.org/v21/i12/</a>.
</div>
<div id="ref-tidyverse" class="csl-entry">
Wickham, Hadley, Mara Averick, Jennifer Bryan, Winston Chang, Lucy
DAgostino McGowan, Romain Franois, Garrett Grolemund, et al. 2019.
<span>Welcome to the <span class="nocase">tidyverse</span>.</span>
<em>Journal of Open Source Software</em> 4 (43): 1686. <a
href="https://doi.org/10.21105/joss.01686">https://doi.org/10.21105/joss.01686</a>.
</div>
<div id="ref-scales" class="csl-entry">
Wickham, Hadley, Thomas Lin Pedersen, and Dana Seidel. 2023. <em><span
class="nocase">scales</span>: Scale Functions for Visualization</em>. <a
href="https://CRAN.R-project.org/package=scales">https://CRAN.R-project.org/package=scales</a>.
</div>
<div id="ref-cowplot" class="csl-entry">
Wilke, Claus O. 2024. <em><span class="nocase">cowplot</span>:
Streamlined Plot Theme and Plot Annotations for <span><span
class="nocase">ggplot2</span></span></em>. <a
href="https://CRAN.R-project.org/package=cowplot">https://CRAN.R-project.org/package=cowplot</a>.
</div>
<div id="ref-ggtext" class="csl-entry">
Wilke, Claus O., and Brenton M. Wiernik. 2022. <em><span
class="nocase">ggtext</span>: Improved Text Rendering Support for
<span><span class="nocase">ggplot2</span></span></em>. <a
href="https://CRAN.R-project.org/package=ggtext">https://CRAN.R-project.org/package=ggtext</a>.
</div>
<div id="ref-knitr2014" class="csl-entry">
Xie, Yihui. 2014. <span><span class="nocase">knitr</span>: A
Comprehensive Tool for Reproducible Research in <span>R</span>.</span>
In <em>Implementing Reproducible Computational Research</em>, edited by
Victoria Stodden, Friedrich Leisch, and Roger D. Peng. Chapman;
Hall/CRC.
</div>
<div id="ref-knitr2015" class="csl-entry">
. 2015. <em>Dynamic Documents with <span>R</span> and Knitr</em>. 2nd
ed. Boca Raton, Florida: Chapman; Hall/CRC. <a
href="https://yihui.org/knitr/">https://yihui.org/knitr/</a>.
</div>
<div id="ref-knitr2024" class="csl-entry">
. 2024. <em><span class="nocase">knitr</span>: A General-Purpose
Package for Dynamic Report Generation in r</em>. <a
href="https://yihui.org/knitr/">https://yihui.org/knitr/</a>.
</div>
<div id="ref-rmarkdown2018" class="csl-entry">
Xie, Yihui, J. J. Allaire, and Garrett Grolemund. 2018. <em>R Markdown:
The Definitive Guide</em>. Boca Raton, Florida: Chapman; Hall/CRC. <a
href="https://bookdown.org/yihui/rmarkdown">https://bookdown.org/yihui/rmarkdown</a>.
</div>
<div id="ref-rmarkdown2020" class="csl-entry">
Xie, Yihui, Christophe Dervieux, and Emily Riederer. 2020. <em>R
Markdown Cookbook</em>. Boca Raton, Florida: Chapman; Hall/CRC. <a
href="https://bookdown.org/yihui/rmarkdown-cookbook">https://bookdown.org/yihui/rmarkdown-cookbook</a>.
</div>
<div id="ref-inlabru2017" class="csl-entry">
Yuan, Yuan, Bachl, Fabian E., Lindgren, Finn, Borchers, et al. 2017.
<span>Point Process Models for Spatio-Temporal Distance Sampling Data
from a Large-Scale Survey of Blue Whales.</span> <em>Ann. Appl.
Stat.</em> 11 (4): 227097. <a
href="https://doi.org/10.1214/17-AOAS1078">https://doi.org/10.1214/17-AOAS1078</a>.
</div>
</div>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiUGVNUyAxLCBjb3ZhcmlhdGVzIGFuZCBwcmVwcm9jZXNzaW5nIgpkYXRlOiAiQ3JlYXRlZDogMDUtMDctMjAyNC4gTGFzdCBtb2RpZmllZDogYHIgZm9ybWF0KFN5cy50aW1lKCksICclZC0lbS0lWS4nKWAiCm91dHB1dDoKICBodG1sX2RvY3VtZW50OgogICAgbWF0aGpheDogImh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9ucG0vbWF0aGpheEAzL2VzNS90ZXgtbW1sLWNodG1sLmpzIgogICAgaGlnaGxpZ2h0OiBweWdtZW50cwogICAgdGhlbWU6IGZsYXRseQogICAgY29kZV9mb2xkaW5nOiBzaG93ICMgY2xhc3Muc291cmNlID0gImZvbGQtaGlkZSIgdG8gaGlkZSBjb2RlIGFuZCBhZGQgYSBidXR0b24gdG8gc2hvdyBpdAogICAgZGZfcHJpbnQ6IHBhZ2VkCiAgICB0b2M6IHRydWUKICAgIHRvY19mbG9hdDoKICAgICAgY29sbGFwc2VkOiB0cnVlCiAgICAgIHNtb290aF9zY3JvbGw6IHRydWUKICAgIG51bWJlcl9zZWN0aW9uczogZmFsc2UKICAgIGZpZ19jYXB0aW9uOiB0cnVlCiAgICBjb2RlX2Rvd25sb2FkOiB0cnVlCmFsd2F5c19hbGxvd19odG1sOiB0cnVlCmJpYmxpb2dyYXBoeTogCiAgLSByZWZlcmVuY2VzLmJpYgogIC0gZ3JhdGVmdWwtcmVmcy5iaWIKaGVhZGVyLWluY2x1ZGVzOgogIC0gXG5ld2NvbW1hbmR7XGFyfXtcbWF0aGJie1J9fQogIC0gXG5ld2NvbW1hbmR7XGxsYXZ9WzFde1xsZWZ0XHsjMVxyaWdodFx9fQogIC0gXG5ld2NvbW1hbmR7XHBhcmV9WzFde1xsZWZ0KCMxXHJpZ2h0KX0KICAtIFxuZXdjb21tYW5ke1xOY2FsfXtcbWF0aGNhbHtOfX0KICAtIFxuZXdjb21tYW5ke1xWY2FsfXtcbWF0aGNhbHtWfX0KICAtIFxuZXdjb21tYW5ke1xFY2FsfXtcbWF0aGNhbHtFfX0KICAtIFxuZXdjb21tYW5ke1xXY2FsfXtcbWF0aGNhbHtXfX0KLS0tCgpgYGB7ciB4YXJpbmdhbkV4dHJhLWNsaXBib2FyZCwgZWNobyA9IEZBTFNFfQpodG1sdG9vbHM6OnRhZ0xpc3QoCiAgeGFyaW5nYW5FeHRyYTo6dXNlX2NsaXBib2FyZCgKICAgIGJ1dHRvbl90ZXh0ID0gIjxpIGNsYXNzPVwiZmEtc29saWQgZmEtY2xpcGJvYXJkXCIgc3R5bGU9XCJjb2xvcjogIzAwMDA4QlwiPjwvaT4iLAogICAgc3VjY2Vzc190ZXh0ID0gIjxpIGNsYXNzPVwiZmEgZmEtY2hlY2tcIiBzdHlsZT1cImNvbG9yOiAjOTBCRTZEXCI+PC9pPiIsCiAgICBlcnJvcl90ZXh0ID0gIjxpIGNsYXNzPVwiZmEgZmEtdGltZXMtY2lyY2xlXCIgc3R5bGU9XCJjb2xvcjogI0Y5NDE0NFwiPjwvaT4iCiAgKSwKICBybWFya2Rvd246Omh0bWxfZGVwZW5kZW5jeV9mb250X2F3ZXNvbWUoKQopCmBgYAoKCmBgYHtjc3MsIGVjaG8gPSBGQUxTRX0KYm9keSAubWFpbi1jb250YWluZXIgewogIG1heC13aWR0aDogMTAwJSAhaW1wb3J0YW50OwogIHdpZHRoOiAxMDAlICFpbXBvcnRhbnQ7Cn0KYm9keSB7CiAgbWF4LXdpZHRoOiAxMDAlICFpbXBvcnRhbnQ7Cn0KCmJvZHksIHRkIHsKICAgZm9udC1zaXplOiAxNnB4Owp9CmNvZGUucnsKICBmb250LXNpemU6IDE0cHg7Cn0KcHJlIHsKICBmb250LXNpemU6IDE0cHgKfQouY3VzdG9tLWJveCB7CiAgYmFja2dyb3VuZC1jb2xvcjogI2Y1ZjdmYTsgLyogTGlnaHQgZ3JleS1ibHVlIGJhY2tncm91bmQgKi8KICBib3JkZXItY29sb3I6ICNlMWU4ZWQ7IC8qIExpZ2h0IGJvcmRlciBjb2xvciAqLwogIGNvbG9yOiAjMmMzZTUwOyAvKiBEYXJrIHRleHQgY29sb3IgKi8KICBwYWRkaW5nOiAxNXB4OyAvKiBQYWRkaW5nIGluc2lkZSB0aGUgYm94ICovCiAgYm9yZGVyLXJhZGl1czogNXB4OyAvKiBSb3VuZGVkIGNvcm5lcnMgKi8KICBtYXJnaW4tYm90dG9tOiAyMHB4OyAvKiBTcGFjaW5nIGJlbG93IHRoZSBib3ggKi8KfQouY2FwdGlvbiB7CiAgbWFyZ2luOiBhdXRvOwogIHRleHQtYWxpZ246IGNlbnRlcjsKICBtYXJnaW4tYm90dG9tOiAyMHB4OyAvKiBTcGFjaW5nIGJlbG93IHRoZSBib3ggKi8KfQpgYGAKCgpHbyBiYWNrIHRvIHRoZSBbQWJvdXQgcGFnZV0oYWJvdXQuaHRtbCkuCgoKOjo6IHsuY3VzdG9tLWJveH0KVGhpcyB2aWduZXR0ZSBwcm9jZXNzZXMgaGFsZiBvZiB0aGUgUGVNUyBkYXRhc2V0LCBzaG93cyBzb21lIGlsbHVzdHJhdGlvbnMsIGFuZCBwcm9kdWNlcyBbKipgcGVtc19yZXBsMV9kYXRhLlJEYXRhYCoqXShodHRwczovL2dpdGh1Yi5jb20vbGVuaW5yYWZhZWxyaWVyYXNlZ3VyYS9HV01GL2Jsb2IvbWFpbi9kYXRhX2ZpbGVzL3BlbXNfcmVwbDFfZGF0YS5SRGF0YSksIHdoaWNoIGlzIGEgZmlsZSB0aGF0IGNvbnRhaW5zIHRoZSBncmFwaCB3aXRoIGRhdGEgYW5kIGEgY292YXJpYXRlIGRlZmluZWQgb24gdGhlIG1lc2guIFRvIHNlZSBob3cgdGhlIGRhdGEgaXMgbW9kZWxlZCwgZ28gdG8gW3BlbXNfcmVwbDIuaHRtbF0ocGVtc19yZXBsMi5odG1sKS4KOjo6CgoKTGV0IHVzIHNldCBzb21lIGdsb2JhbCBvcHRpb25zIGZvciBhbGwgY29kZSBjaHVua3MgaW4gdGhpcyBkb2N1bWVudC4KCgpgYGB7cn0KIyBTZXQgc2VlZCBmb3IgcmVwcm9kdWNpYmlsaXR5CnNldC5zZWVkKDE5ODIpIAojIFNldCBnbG9iYWwgb3B0aW9ucyBmb3IgYWxsIGNvZGUgY2h1bmtzCmtuaXRyOjpvcHRzX2NodW5rJHNldCgKICAjIERpc2FibGUgbWVzc2FnZXMgcHJpbnRlZCBieSBSIGNvZGUgY2h1bmtzCiAgbWVzc2FnZSA9IEZBTFNFLCAgICAKICAjIERpc2FibGUgd2FybmluZ3MgcHJpbnRlZCBieSBSIGNvZGUgY2h1bmtzCiAgd2FybmluZyA9IEZBTFNFLCAgICAKICAjIFNob3cgUiBjb2RlIHdpdGhpbiBjb2RlIGNodW5rcyBpbiBvdXRwdXQKICBlY2hvID0gVFJVRSwgICAgICAgIAogICMgSW5jbHVkZSBib3RoIFIgY29kZSBhbmQgaXRzIHJlc3VsdHMgaW4gb3V0cHV0CiAgaW5jbHVkZSA9IFRSVUUsICAgICAKICAjIEV2YWx1YXRlIFIgY29kZSBjaHVua3MKICBldmFsID0gVFJVRSwgICAgICAgCiAgIyBFbmFibGUgY2FjaGluZyBvZiBSIGNvZGUgY2h1bmtzIGZvciBmYXN0ZXIgcmVuZGVyaW5nCiAgY2FjaGUgPSBGQUxTRSwgICAgICAKICAjIEFsaWduIGZpZ3VyZXMgaW4gdGhlIGNlbnRlciBvZiB0aGUgb3V0cHV0CiAgZmlnLmFsaWduID0gImNlbnRlciIsCiAgIyBFbmFibGUgcmV0aW5hIGRpc3BsYXkgZm9yIGhpZ2gtcmVzb2x1dGlvbiBmaWd1cmVzCiAgcmV0aW5hID0gMiwKICAjIFNob3cgZXJyb3JzIGluIHRoZSBvdXRwdXQgaW5zdGVhZCBvZiBzdG9wcGluZyByZW5kZXJpbmcKICBlcnJvciA9IFRSVUUsCiAgIyBEbyBub3QgY29sbGFwc2UgY29kZSBhbmQgb3V0cHV0IGludG8gYSBzaW5nbGUgYmxvY2sKICBjb2xsYXBzZSA9IEZBTFNFCikKYGBgCgpCZWxvdyB3ZSBsb2FkIHRoZSBuZWNlc3NhcnkgbGlicmFyaWVzLgoKYGBge3J9CmxpYnJhcnkoSU5MQSkKbGlicmFyeShpbmxhYnJ1KQpsaWJyYXJ5KHJTUERFKQpsaWJyYXJ5KE1ldHJpY0dyYXBoKQoKbGlicmFyeShkcGx5cikKbGlicmFyeShwbG90bHkpCmxpYnJhcnkoc2NhbGVzKQpsaWJyYXJ5KHBhdGNod29yaykKCmxpYnJhcnkoZ2dwbG90MikKbGlicmFyeShjb3dwbG90KQpsaWJyYXJ5KGdncHVicikgI2Fubm90YXRlX2ZpZ3VyZSgpCmxpYnJhcnkoZ3JpZCkgI3RleHRHcm9iKCkKbGlicmFyeShnZ21hcCkKCmxpYnJhcnkodmlyaWRpcykKbGlicmFyeShPcGVuU3RyZWV0TWFwKQoKCmxpYnJhcnkodGlkeXIpCmxpYnJhcnkoc2YpCgpsaWJyYXJ5KGhlcmUpCmxpYnJhcnkocm1hcmtkb3duKQpsaWJyYXJ5KGdyYXRlZnVsKSAjIENpdGUgYWxsIGxvYWRlZCBwYWNrYWdlcwpgYGAKCgpCZWxvdyB3ZSBkZWZpbmUgdGhlIGZ1bmN0aW9uIGBjYXB0aW9uZXIoKWAgdG8gZ2VuZXJhdGUgY2FwdGlvbnMgZm9yIHRoZSBmaWd1cmVzIGFuZCB0aGUgZnVuY3Rpb24gYGdldHNfc3VtbWFyeV9wYXJhbWV0ZXJzKClgIHRvIGV4dHJhY3QgdGhlIHN1bW1hcnkgb2YgdGhlIHBhcmFtZXRlcnMgb2YgdGhlIG1vZGVsLgoKPGRpdiBzdHlsZT0iY29sb3I6IGJsdWU7Ij4KKioqKioqKioKKipQcmVzcyB0aGUgU2hvdyBidXR0b24gYmVsb3cgdG8gcmV2ZWFsIHRoZSBjb2RlLioqCgoqKioqKioqKgo8L2Rpdj4KCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0KIyBTdGFydCB0aGUgZmlndXJlIGNvdW50ZXIKZmlnX2NvdW50IDwtIDAKIyBEZWZpbmUgdGhlIGNhcHRpb25lciBmdW5jdGlvbgpjYXB0aW9uZXIgPC0gZnVuY3Rpb24oY2FwdGlvbikgewogIGZpZ19jb3VudCA8PC0gZmlnX2NvdW50ICsgMQogIHBhc3RlMCgiRmlndXJlICIsIGZpZ19jb3VudCwgIjogIiwgY2FwdGlvbikKfQpnZXRzX3N1bW1hcnlfcGFyYW1ldGVycyA8LSBmdW5jdGlvbihmaXQsIG1vZGVsKSB7CiAgcGFyYW1fc3BkZSA8LSBzdW1tYXJ5KHJzcGRlLnJlc3VsdChmaXQsICJmaWVsZCIsIG1vZGVsLCBwYXJhbWV0ZXJpemF0aW9uID0gInNwZGUiKSkKICBwYXJhbV9tYXRlcm4gPC0gc3VtbWFyeShyc3BkZS5yZXN1bHQoZml0LCAiZmllbGQiLCBtb2RlbCwgcGFyYW1ldGVyaXphdGlvbiA9ICJtYXRlcm4iKSkKICBwYXJhbV9maXhlZCA8LSBmaXQkc3VtbWFyeS5maXhlZFssMTo2XQogIG1hcmdpbmFsLnBvc3Rlcmlvci5zaWdtYV9lID0gaW5sYS50bWFyZ2luYWwoCiAgICBmdW4gPSBmdW5jdGlvbih4KSBleHAoLXgvMiksIAogICAgbWFyZ2luYWwgPSBmaXRbWyJpbnRlcm5hbC5tYXJnaW5hbHMuaHlwZXJwYXIiXV1bWyJMb2cgcHJlY2lzaW9uIGZvciB0aGUgR2F1c3NpYW4gb2JzZXJ2YXRpb25zIl1dKQogIHF1YW50LnNpZ21hX2UgPC0gY2FwdHVyZS5vdXRwdXQoe3Jlc3VsdF90bXAgPC0gaW5sYS56bWFyZ2luYWwobWFyZ2luYWwucG9zdGVyaW9yLnNpZ21hX2UpfSwgZmlsZSA9ICIvZGV2L251bGwiKSAKICBxdWFudC5zaWdtYV9lIDwtIHJlc3VsdF90bXAKICBzdGF0aXN0aWNzLnNpZ21hX2UgPC0gdW5saXN0KHF1YW50LnNpZ21hX2UpW2MoMSwyLDMsNSw3KV0KICBtb2RlLnNpZ21hX2UgPC0gaW5sYS5tbWFyZ2luYWwobWFyZ2luYWwucG9zdGVyaW9yLnNpZ21hX2UpCiAgYWxscGFyYW1zIDwtIHJiaW5kKHBhcmFtX2ZpeGVkLCBwYXJhbV9zcGRlLCBwYXJhbV9tYXRlcm4sIGMoc3RhdGlzdGljcy5zaWdtYV9lLCBtb2RlLnNpZ21hX2UpKQogIHJvd25hbWVzKGFsbHBhcmFtcylbbnJvdyhhbGxwYXJhbXMpXSA8LSAic2lnbWFfZSIKICByZXR1cm4oYWxscGFyYW1zKQp9CmBgYAoKCgo8IS0tIE9iamVjdCBgcGVtc19yZXBsYCBiZWxvdyBpcyBhdmFpbGFibGUgYWZ0ZXIgbG9hZGluZyBgTWV0cmljR3JhcGhgIGxpYnJhcnkuIC0tPgoKPCEtLSBgYGB7cn0gLS0+CjwhLS0gIyBMb2FkIHRoZSBkYXRhIC0tPgo8IS0tIHBlbXNfZGF0YSA8LSBwZW1zX3JlcGwkZGF0YSAtLT4KPCEtLSAjIFNlbGVjdCB0aGUgbG9jYXRpb25zLCB3aGljaCBhcmUgY29tbW9uIGZvciBhbGwgcmVwbGljYXRlcyAtLT4KPCEtLSBQdEVfYWxsIDwtIHBlbXNfZGF0YVsxOjMxOSwgYygiZWRnZV9udW1iZXIiLCAiZGlzdGFuY2Vfb25fZWRnZSIpXSAtLT4KPCEtLSAjIFNlbGVjdCB0aGUgcmVzcG9uc2UgdmFyaWFibGUgYW5kIHRyYW5zZm9ybSBpdCB0byBhIG1hdHJpeCAtLT4KPCEtLSBZX2FsbCA8LSBtYXRyaXgocGVtc19kYXRhJHksIG5yb3cgPSAyNiwgbmNvbCA9IDMxOSwgYnlyb3cgPSBUUlVFKSAtLT4KPCEtLSAjIFJlbW92ZSBsb2NhdGlvbnMsIHRob3NlIHdpdGggdGhlIHNhbWUgdmFsdWUgaW4gdGhlIGZpcnN0IDEzIHJlcGxpY2F0ZXMgLS0+CjwhLS0gYWxsX3NhbWUgPC0gZnVuY3Rpb24oY29sKSB7bGVuZ3RoKHVuaXF1ZShjb2xbMToxM10pKSA9PSAxfSAtLT4KPCEtLSBjb2xzX3RvX2tlZXAgPC0gYXBwbHkoWV9hbGwsIDIsIGZ1bmN0aW9uKGNvbCkgIWFsbF9zYW1lKGNvbCkpIC0tPgo8IS0tIFlfbG9jIDwtIFlfYWxsWywgY29sc190b19rZWVwXSAtLT4KPCEtLSBQdEUgPC0gUHRFX2FsbFtjb2xzX3RvX2tlZXAsXSAtLT4KPCEtLSAjIENoZWNrIHRoZSBkaW1lbnNpb25zIC0tPgo8IS0tIFB0RSB8PiBkaW0oKSAtLT4KPCEtLSBZX2xvYyB8PiBkaW0oKSAtLT4KPCEtLSBgYGAgLS0+Cgo8IS0tIEhhbGYgb2YgdGhlIHJlcGxpY2F0ZXMgYXJlIHVzZWQgdG8gY29tcHV0ZSBzdW1tYXJ5IHN0YXRpc3RpY3MgKGBZX2xvZ3N0ZGAgYW5kIGBZX21lYW5gKSBhbmQgdGhlIG90aGVyIGhhbGYgKGBZYCkgYXJlIHVzZWQgdG8gZml0IHRoZSBtb2RlbC4gLS0+Cgo8IS0tIGBgYHtyfSAtLT4KPCEtLSAjIEZpcnN0IGhhbGYgb2YgdGhlIHJlcGxpY2F0ZXMgZm9yIHN1bW1hcnkgc3RhdGlzdGljcyAtLT4KPCEtLSBZX2Zvcl9zdW1tYXJ5IDwtIFlfbG9jWzE6MTMsXSAtLT4KPCEtLSAjIFJlc2VydmUgdGhlIHNlY29uZCBoYWxmIGZvciBmaXR0aW5nIHJlcGxpY2F0ZSBtb2RlbCAtLT4KPCEtLSBZIDwtIFlfbG9jWzE0OjI2LF0gLS0+CjwhLS0gIyBDb21wdXRlIHRoZSBsb2cgc3RhbmRhcmQgZGV2aWF0aW9uIGFuZCBtZWFuIC0tPgo8IS0tIFlfbG9nc3RkIDwtIGFwcGx5KFlfZm9yX3N1bW1hcnksIDIsIHNkKSB8PiBhcy52ZWN0b3IoKSB8PiBsb2coKSAtLT4KPCEtLSBZX21lYW4gPC0gYXBwbHkoWV9mb3Jfc3VtbWFyeSwgMiwgbWVhbikgfD4gYXMudmVjdG9yKCkgLS0+CjwhLS0gIyBDaGVjayB0aGUgZGltZW5zaW9ucyAtLT4KPCEtLSBZIHw+IGRpbSgpIC0tPgo8IS0tIGBgYCAtLT4KCgoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKgoKRm9sZGVyIGBkYXRhLnBlbXNgIHdhcyBkb3dubG9hZGVkIGZyb20gdGhpcyBbR2l0SHViIHJlcG9zaXRvcnldKGh0dHBzOi8vZ2l0aHViLmNvbS9kYXZpZGJvbGluL01ldHJpY0dyYXBoL3RyZWUvN2Y0YzkwMTcxYzQwYjliZjdlYTI5ZTliMDQ4YzkzZDg4NDc3YzVkMS9leGFtcGxlcy9kYXRhLnBlbXMpLgoKYGBge3J9CkxpbmVzIDwtIHJlYWRfc2YoaGVyZSgiZGF0YV9maWxlcy9kYXRhLnBlbXMvbGluZXMuc2hwIikpCmxpbmVzIDwtIGFzX1NwYXRpYWwoTGluZXMpCgpFdFYgPC0gcmVhZC5jc3YoaGVyZSgiZGF0YV9maWxlcy9kYXRhLnBlbXMvRS5jc3YiKSwgaGVhZGVyID0gVCwgcm93Lm5hbWVzID0gTlVMTCkKUHRFIDwtIHJlYWQuY3N2KGhlcmUoImRhdGFfZmlsZXMvZGF0YS5wZW1zL1B0RS5jc3YiKSwgaGVhZGVyID0gVCwgcm93Lm5hbWVzID0gTlVMTCkKUHRFWywxXSA8LSBQdEVbLDFdICsgMQpZIDwtIHJlYWQuY3N2KGhlcmUoImRhdGFfZmlsZXMvZGF0YS5wZW1zL1kuY3N2IiksIGhlYWRlciA9IFQsIHJvdy5uYW1lcyA9IE5VTEwpClkgPC0gYXMubWF0cml4KFlbLC0xXSkKZWRnZV9sZW5ndGhfbSA8LSBFdFZbLDRdClB0RVssMl0gPSBQdEVbLDJdL2VkZ2VfbGVuZ3RoX21bUHRFWywxXV0KYGBgCgpNYXRyaXggYFlgIGhhcyBkaW1lbnNpb24gYHIgZGltKFkpYC4gRWFjaCByb3cgb2YgYFlgIGNvcnJlc3BvbmRzIHRvIGEgcmVwbGljYXRlIChgciBkaW0oWSlbMV1gIHJlcGxpY2F0ZXMgaW4gdG90YWwpIGFuZCBlYWNoIGNvbHVtbiBjb3JyZXNwb25kcyB0byBhIGxvY2F0aW9uIChgciBkaW0oWSlbMl1gIGxvY2F0aW9ucyBpbiB0b3RhbCkgb24gdGhlIG5ldHdvcmsuCgoKYGBge3J9CnBsb3QobGluZXMpClB0RSB8PiBoZWFkKDUpIHw+IHBhZ2VkX3RhYmxlKCkKUHRFIHw+IGRpbSgpClkgfD4gYXMuZGF0YS5mcmFtZSgpIHw+IGhlYWQoNSkgfD4gcGFnZWRfdGFibGUoKQpZIHw+IGRpbSgpCmBgYAoKCldlIHJlbW92ZSBjb2x1bW5zIGluIGBZYCwgdGhvc2Ugd2l0aCB0aGUgc2FtZSB2YWx1ZSBpbiB0aGUgZmlyc3QgMTMgcmVwbGljYXRlcy4gV2UgYWxzbyByZW1vdmUgdGhlIGNvcnJlc3BvbmRpbmcgcm93cyBpbiBgUHRFYC4KCmBgYHtyfQphbGxfc2FtZSA8LSBmdW5jdGlvbihjb2wpIHsKICBsZW5ndGgodW5pcXVlKGNvbFsxOjEzXSkpID09IDEKfQpjb2xzX3RvX2tlZXAgPC0gYXBwbHkoWSwgMiwgZnVuY3Rpb24oY29sKSAhYWxsX3NhbWUoY29sKSkKClkgPC0gWVssIGNvbHNfdG9fa2VlcF0KUHRFIDwtIFB0RVtjb2xzX3RvX2tlZXAsXQpQdEUgfD4gZGltKCkKWSB8PiBkaW0oKQpgYGAKCgpIYWxmIG9mIHRoZSByZXBsaWNhdGVzIChgWV9mb3Jfc3VtbWFyeWApIGFyZSB1c2VkIHRvIGNvbXB1dGUgYFlfbG9nc3RkYCBhbmQgYFlfbWVhbmAsIGFuZCB0aGUgb3RoZXIgaGFsZiAoYFlgIGFnYWluICkgYXJlIHVzZWQgdG8gZml0IGEgcmVwbGljYXRlIG1vZGVsIGluIFtwZW1zX3JlcGwyLmh0bWxdKHBlbXNfcmVwbDIuaHRtbCkuCgpgYGB7cn0Kc2FtcGxlZF9udW1iZXJzIDwtIDE6MTMKbm90X3NhbXBsZWRfbnVtYmVycyA8LSAxNDoyNgpZX2Zvcl9zdW1tYXJ5IDwtIFlbc2FtcGxlZF9udW1iZXJzLF0KWV9sb2dzdGQgPC0gYXBwbHkoWV9mb3Jfc3VtbWFyeSwgMiwgc2QpIHw+IGFzLnZlY3RvcigpIHw+IGxvZygpCllfbWVhbiA8LSBhcHBseShZX2Zvcl9zdW1tYXJ5LCAyLCBtZWFuKSB8PiBhcy52ZWN0b3IoKQpZIDwtIFlbbm90X3NhbXBsZWRfbnVtYmVycyxdClkgfD4gZGltKCkKYGBgCgoKKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioKCgpPYnNlcnZlIHRoYXQgYFlfbG9nc3RkYCBjb3JyZXNwb25kcyB0byAkXGxvZyQgb2YgdGhlIHN0YW5kYXJkIGRldmlhdGlvbiBhdCBlYWNoIGxvY2F0aW9uLgoKQmVsb3cgd2UgYnVpbGQgdGhlIGdyYXBoIHVzaW5nIHRoZSBsaXN0IGVsZW1lbnQgYGVkZ2VzYCBvYmplY3QgZnJvbSBgcGVtc19yZXBsYC4KCmBgYHtyfQojIEJ1aWxkIHRoZSBncmFwaApncmFwaCA8LSBtZXRyaWNfZ3JhcGgkbmV3KGVkZ2VzID0gcGVtc19yZXBsJGVkZ2VzLCBsb25nbGF0ID0gVFJVRSkKIyBBZGQgdGhlIG9ic2VydmF0aW9ucwpncmFwaCRhZGRfb2JzZXJ2YXRpb25zKGRhdGEgPSBkYXRhLmZyYW1lKHkgPSBZX2xvZ3N0ZCwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWRnZV9udW1iZXIgPSBQdEVbLDFdLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXN0YW5jZV9vbl9lZGdlID0gUHRFWywyXSksIAogICAgICAgICAgICAgICAgICAgICAgIG5vcm1hbGl6ZWQgPSBUUlVFLCAKICAgICAgICAgICAgICAgICAgICAgICBjbGVhcl9vYnMgPSBUUlVFKQojIEJ1aWxkIHRoZSBtZXNoCmdyYXBoJGJ1aWxkX21lc2goaCA9IDAuMDUpIApgYGAKCkJlbG93IHdlIGZpdCAkXGxvZyhcbWF0aHJte3NkfShzX2kpKVxzaW0gTihcYmV0YV8wK3Uoc19pKSwgXHNpZ21hX2VeMikkLgoKCjxkaXYgc3R5bGU9ImNvbG9yOiBibHVlOyI+CioqKioqKioqCioqUHJlc3MgdGhlIFNob3cgYnV0dG9uIGJlbG93IHRvIHJldmVhbCB0aGUgY29kZS4qKgoKKioqKioqKioKPC9kaXY+CgpgYGB7ciwgY2xhc3Muc291cmNlID0gImZvbGQtaGlkZSJ9CiMgQnVpbGQgdGhlIG1vZGVsCnJzcGRlX21vZGVsX3N0YXQgPC0gcnNwZGUubWV0cmljX2dyYXBoKGdyYXBoLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJhbWV0ZXJpemF0aW9uID0gInNwZGUiKQojIFByZXBhcmUgdGhlIGRhdGEgZm9yIGZpdHRpbmcKZGF0YV9yc3BkZV9icnVfc3RhdCA8LSBncmFwaF9kYXRhX3JzcGRlKHJzcGRlX21vZGVsX3N0YXQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NfbmFtZSA9ICJsb2MiKQojIERlZmluZSB0aGUgY29tcG9uZW50CmNtcF9zdGF0IDwtIHkgfiAtMSArCiAgSW50ZXJjZXB0KDEpICsKICBmaWVsZChsb2MsIG1vZGVsID0gcnNwZGVfbW9kZWxfc3RhdCkKIyBGaXQgdGhlIG1vZGVsCnJzcGRlX2ZpdF9zdGF0IDwtCiAgYnJ1KGNtcF9zdGF0LAogICAgICBkYXRhID0gZGF0YV9yc3BkZV9icnVfc3RhdFtbImRhdGEiXV0sCiAgICAgIGZhbWlseSA9ICJnYXVzc2lhbiIsCiAgICAgIG9wdGlvbnMgPSBsaXN0KHZlcmJvc2UgPSBGQUxTRSkKICApCiMgU3VtbWFyaXplIHRoZSByZXN1bHRzCnN1bW1hcnkocnNwZGVfZml0X3N0YXQpCmdldHNfc3VtbWFyeV9wYXJhbWV0ZXJzKHJzcGRlX2ZpdF9zdGF0LCByc3BkZV9tb2RlbF9zdGF0KQpgYGAKCldlIG5vdyBjb21wdXRlIHRoZSBrcmlnaW5nIHByZWRpY3RvciAkRSh1KHNfaSl8XGxvZyhcbWF0aHJte3NkfShzX2kpKSkkIChkZW5vdGVkIGFzIGBjb3ZgIGJlbG93KSBhbmQgc3RhbmRhcmRpemUgaXQuCgpgYGB7cn0KIyBQcmVkaWN0aW9uIGxvY2F0aW9ucwpkYXRhX3ByZF9saXN0X21lc2ggPC0gZ3JhcGgkZ2V0X21lc2hfbG9jYXRpb25zKGJydSA9IFRSVUUsIGxvYyA9ICJsb2MiKQojIENvbXB1dGUgdGhlIGtyaWdpbmcgcHJlZGljdG9yCnlfcHJlZCA8LSBwcmVkaWN0KHJzcGRlX21vZGVsX3N0YXQsIGNtcF9zdGF0LCByc3BkZV9maXRfc3RhdCwgbmV3ZGF0YSA9IGRhdGFfcHJkX2xpc3RfbWVzaCwgfkludGVyY2VwdCArIGZpZWxkKQpjb3ZfYWxtb3N0IDwtIHlfcHJlZCRwcmVkJG1lYW4KIyBTdGFuZGFyZGl6ZSB0aGUga3JpZ2luZyBwcmVkaWN0b3Igb2YgdGhlIGxvZyBzdGFuZGFyZCBkZXZpYXRpb24KY292IDwtIChjb3ZfYWxtb3N0IC0gbWVhbihjb3ZfYWxtb3N0KSkvc2QoY292X2FsbW9zdCkKYGBgCgpCZWxvdyB3ZSBwbG90IHRoZSByZXN1bHRzLiBXZSBmaXJzdCBnZW5lcmF0ZSB0d28gbWFwcywgb25lIGZvciB6b29tIGxldmVsIDEyIGFuZCB0aGUgb3RoZXIgZm9yIHpvb20gbGV2ZWwgMTMuIAoKCjxkaXYgc3R5bGU9ImNvbG9yOiBibHVlOyI+CioqKioqKioqCioqUHJlc3MgdGhlIFNob3cgYnV0dG9uIGJlbG93IHRvIHJldmVhbCB0aGUgY29kZS4qKgoKKioqKioqKioKPC9kaXY+CgoKYGBge3IsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUifQojIEV4dHJhY3QgdGhlIEV1Y2xpZGVhbiBjb29yZGluYXRlcyBvZiB0aGUgbWVzaCBwb2ludHMKeHlwb2ludHMgPC0gZ3JhcGgkbWVzaCRWCiMgRXh0cmFjdCB0aGUgcmFuZ2Ugb2YgdGhlIGNvb3JkaW5hdGVzIAp4X2xlZnQgPC0gcmFuZ2UoeHlwb2ludHNbLDFdKVsxXQp4X3JpZ2h0IDwtIHJhbmdlKHh5cG9pbnRzWywxXSlbMl0KeV9ib3R0b20gPC0gcmFuZ2UoeHlwb2ludHNbLDJdKVsxXQp5X3RvcCA8LSByYW5nZSh4eXBvaW50c1ssMl0pWzJdCiMgRGVmaW5lIGNvb3JkaW5hdGVzIGZvciBzbWFsbCB3aW5kb3dzCmNvb3JkeF9sd3IxIDwtIC0xMjEuODc4CmNvb3JkeF91cHIxIDwtIC0xMjEuODI4CmNvb3JkeV9sd3IxIDwtIDM3LjMxNQpjb29yZHlfdXByMSA8LSAzNy4zNjUKCmNvb3JkeF9sd3IyPC0gLTEyMi4wNzUKY29vcmR4X3VwcjIgPC0gLTEyMi4wMjUKY29vcmR5X2x3cjIgPC0gMzcuMzY1CmNvb3JkeV91cHIyIDwtIDM3LjQxNQojIERlZmluZSB0aGUgY29sb3JzIGZvciB0aGUgd2luZG93cwpsb3dlcl9jb2xvciA8LSAiZGFya3JlZCIgICAjIERhcmsgcHVycGxlCnVwcGVyX2NvbG9yIDwtICJkYXJrYmx1ZSIgICMgWWVsbG93CiMgU2V0IHRoZSBzdHlsZSBvZiB0aGUgbWFwCnN0eWxlX3ZlY3RvciA8LSBjKGMoZmVhdHVyZSA9ICJyb2FkIiwgZWxlbWVudCA9ICJnZW9tZXRyeSIsIHZpc2liaWxpdHkgPSAib24iKSwKICAgICAgICAgICAgICAgICAgYygiJnN0eWxlPSIsIGZlYXR1cmUgPSAicG9pIiwgZWxlbWVudCA9ICJsYWJlbHMiLCB2aXNpYmlsaXR5ID0gIm9mZiIpLAogICAgICAgICAgICAgICAgICBjKCImc3R5bGU9IiwgZmVhdHVyZSA9ICJyb2FkIiwgZWxlbWVudCA9ICJsYWJlbHMiLCB2aXNpYmlsaXR5ID0gIm9mZiIpLAogICAgICAgICAgICAgICAgICBjKCImc3R5bGU9IiwgZmVhdHVyZSA9ICJhZG1pbmlzdHJhdGl2ZSIsIGVsZW1lbnQgPSAibGFiZWxzIiwgdmlzaWJpbGl0eSA9ICJvZmYiKSwgI25hbWUgb2YgcGxhY2VzCiAgICAgICAgICAgICAgICAgIGMoIiZzdHlsZT0iLCBmZWF0dXJlID0gInRyYW5zaXQiLCBlbGVtZW50ID0gImxhYmVscyIsIHZpc2liaWxpdHkgPSAib2ZmIiksCiAgICAgICAgICAgICAgICAgIGMoIiZzdHlsZT0iLCBmZWF0dXJlID0gImxhbmRzY2FwZSIsIGVsZW1lbnQgPSAiZ2VvbWV0cnkiLCB2aXNpYmlsaXR5ID0gIm9uIiksCiAgICAgICAgICAgICAgICAgIGMoIiZzdHlsZT0iLCBmZWF0dXJlID0gIndhdGVyIiwgZWxlbWVudCA9ICJnZW9tZXRyeSIsIHZpc2liaWxpdHkgPSAib24iKSkgCiMgT2J0YWluIHRoZSBtYXBzCnAxMiA8LSBnZ21hcChnZXRfc3RhZGlhbWFwKGJib3ggPSBjKGxlZnQgPSB4X2xlZnQsIGJvdHRvbSA9IHlfYm90dG9tLCByaWdodCA9IHhfcmlnaHQsIHRvcCA9IHlfdG9wKSwKICAgICAgICAgICAgICB6b29tID0gMTIsCiAgICAgICAgICAgICAgbWFwdHlwZSA9ICJzdGFtZW5fdG9uZXJfbGl0ZSIsIAogICAgICAgICAgICAgIHNjYWxlID0yLAogICAgICAgICAgICAgIHN0eWxlID0gc3R5bGVfdmVjdG9yLAogICAgICAgICAgICAgIGNvbG9yID0gImNvbG9yIikpICsgeGxhYihOVUxMKSArIHlsYWIoTlVMTCkKcDEzIDwtIGdnbWFwKGdldF9zdGFkaWFtYXAoYmJveCA9IGMobGVmdCA9IHhfbGVmdCwgYm90dG9tID0geV9ib3R0b20sIHJpZ2h0ID0geF9yaWdodCwgdG9wID0geV90b3ApLAogICAgICAgICAgICAgIHpvb20gPSAxMywKICAgICAgICAgICAgICBtYXB0eXBlID0gInN0YW1lbl90b25lcl9saXRlIiwgCiAgICAgICAgICAgICAgc2NhbGUgPTIsCiAgICAgICAgICAgICAgc3R5bGUgPSBzdHlsZV92ZWN0b3IsCiAgICAgICAgICAgICAgY29sb3IgPSAiY29sb3IiKSkgKyB4bGFiKE5VTEwpICsgeWxhYihOVUxMKQpgYGAKCmBgYHtyLCBldmFsID0gRkFMU0UsIGVjaG8gPSBGQUxTRX0Kc2F2ZShwMTIsIHAxMywgZmlsZSA9IGhlcmUoImRhdGFfZmlsZXMvbWFwc196b29tMTJhbmQxM2Zyb21fc3RhZGlhLlJEYXRhIikpCmBgYAoKCgpCZWxvdyB3ZSBwbG90IHRoZSBmaWVsZCBvbiB0b3Agb2YgdGhlIG1hcC4gV2UgYWxzbyBhZGQgdGhlIHBvaW50IHZhbHVlcyBvZiB0aGUgc3RhbmRhcmQgZGV2aWF0aW9uIG9mIHRoZSBsb2cgc3RhbmRhcmQgZGV2aWF0aW9uIHRvIHRoZSBncmFwaCBzbyB3ZSBjYW4gcGxvdCBpdCBvbiB0b3Agb2YgdGhlIG1hcCBhbmQgdGhlIGZpZWxkLgoKYGBge3IsIGZpZy53aWR0aCA9IDExLjIsIGZpZy5oZWlnaHQgPSA1LjQzLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIiwgZmlnLmNhcCA9IGNhcHRpb25lcigiU3RhbmRhcmRpemVkIGxvZ2FyaXRobSBvZiB0aGUgc3RhbmRhcmQgZGV2aWF0aW9uIG9mIHRoZSBmaXJzdCBwYXJ0IG9mIHRoZSBkYXRhLiBQb2ludHMgcmVwcmVzZW50IHRoZSBwb2ludCB2YWx1ZSBhdCBlYWNoIGF2YWlsYWJsZSBsb2NhdGlvbiwgYW5kIGVkZ2VzIHJlcHJlc2VudCB0aGUgJFxcbWF0aHJte3N0ZC5jb3Z9KHMpJCBjb3ZhcmlhdGUuIil9CiMgUGxvdCB0aGUgZmllbGQgb24gdG9wIG9mIHRoZSBtYXAKZjEyIDwtIGdyYXBoJHBsb3RfZnVuY3Rpb24oWCA9IGNvdiwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgdmVydGV4X3NpemUgPSAwLCAKICAgICAgICAgICAgICAgICAgICAgICAgICBwID0gcDEyLAogICAgICAgICAgICAgICAgICAgICAgICAgIGVkZ2Vfd2lkdGggPSAwLjUpICsgCiAgdGhlbWVfbWluaW1hbCgpICsgCiAgdGhlbWUodGV4dCA9IGVsZW1lbnRfdGV4dChmYW1pbHkgPSAiUGFsYXRpbm8iKSwgCiAgICAgICAgYXhpcy50ZXh0ID0gZWxlbWVudF90ZXh0KHNpemUgPSA4KSwKICAgICAgICBsZWdlbmQudGV4dCA9IGVsZW1lbnRfdGV4dChzaXplID0gOCksCiAgICAgICAgcGxvdC5tYXJnaW4gPSB1bml0KC0wLjQqYygxLDAsMSwxKSwgImNtIikKICAgICAgICApICsKICBsYWJzKGNvbG9yID0gIiIsIHggPSAiIiwgeSA9ICIiKSArCiAgeGxpbSh4X2xlZnQsIHhfcmlnaHQpICsgCiAgeWxpbSh5X2JvdHRvbSwgeV90b3ApCiMgUGxvdCB0aGUgZmllbGQgb24gdG9wIG9mIHRoZSBtYXAKZjEzIDwtIGdyYXBoJHBsb3RfZnVuY3Rpb24oWCA9IGNvdiwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgdmVydGV4X3NpemUgPSAwLCAKICAgICAgICAgICAgICAgICAgICAgICAgICBwID0gcDEzLAogICAgICAgICAgICAgICAgICAgICAgICAgIGVkZ2Vfd2lkdGggPSAwLjUpICsgCiAgdGhlbWVfbWluaW1hbCgpICsgCiAgdGhlbWUodGV4dCA9IGVsZW1lbnRfdGV4dChmYW1pbHkgPSAiUGFsYXRpbm8iKSwgCiAgICAgICAgYXhpcy50ZXh0ID0gZWxlbWVudF90ZXh0KHNpemUgPSA4KSwKICAgICAgICBsZWdlbmQudGV4dCA9IGVsZW1lbnRfdGV4dChzaXplID0gOCksCiAgICAgICAgcGxvdC5tYXJnaW4gPSB1bml0KC0wLjQqYygxLDAsMSwxKSwgImNtIikKICAgICAgICApICsKICBsYWJzKGNvbG9yID0gIiIsIHggPSAiIiwgeSA9ICIiKSArCiAgeGxpbSh4X2xlZnQsIHhfcmlnaHQpICsgCiAgeWxpbSh5X2JvdHRvbSwgeV90b3ApCgojIFdlIGFkZCB0aGUgcG9pbnQgdmFsdWVzIG9mIHN0YW5kYXJkIGRldmlhdGlvbiBvZiB0aGUgbG9nIHN0YW5kYXJkIGRldmlhdGlvbiB0byB0aGUgZ3JhcGggc28gd2UgY2FuIHBsb3QgaXQKc3RhbmRhcmRpemVkX1lfbG9nc3RkIDwtIChZX2xvZ3N0ZCAtIG1lYW4oWV9sb2dzdGQpKS9zZChZX2xvZ3N0ZCkKZ3JhcGgkYWRkX29ic2VydmF0aW9ucyhkYXRhID0gZGF0YS5mcmFtZSh5ID0gc3RhbmRhcmRpemVkX1lfbG9nc3RkLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlZGdlX251bWJlciA9IFB0RVssMV0sIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc3RhbmNlX29uX2VkZ2UgPSBQdEVbLDJdKSwgCiAgICAgICAgICAgICAgICAgICAgICAgbm9ybWFsaXplZCA9IFRSVUUsIAogICAgICAgICAgICAgICAgICAgICAgIGNsZWFyX29icyA9IFRSVUUpCmcxMiA8LSBncmFwaCRwbG90KGRhdGEgPSAieSIsIHZlcnRleF9zaXplID0gMCwgcCA9IGYxMiwgZWRnZV93aWR0aCA9IDAsIGRhdGFfc2l6ZSA9IDEpICsgCiAgbGFicyhjb2xvciA9ICIiLCB4ID0gIiIsIHkgPSAiIikgKyAKICBhbm5vdGF0ZSgic2VnbWVudCIsIHggPSBjb29yZHhfbHdyMSwgeSA9IGNvb3JkeV9sd3IxLCB4ZW5kID0gY29vcmR4X3VwcjEsIHllbmQgPSBjb29yZHlfbHdyMSwgCiAgICAgICAgICAgbGluZXdpZHRoID0gMC40LCBjb2xvciA9IHVwcGVyX2NvbG9yKSArICAjIEJvdHRvbSBsaW5lCiAgYW5ub3RhdGUoInNlZ21lbnQiLCB4ID0gY29vcmR4X2x3cjEsIHkgPSBjb29yZHlfdXByMSwgeGVuZCA9IGNvb3JkeF91cHIxLCB5ZW5kID0gY29vcmR5X3VwcjEsIAogICAgICAgICAgIGxpbmV3aWR0aCA9IDAuNCwgY29sb3IgPSB1cHBlcl9jb2xvcikgKyAgIyBUb3AgbGluZQogIGFubm90YXRlKCJzZWdtZW50IiwgeCA9IGNvb3JkeF9sd3IxLCB5ID0gY29vcmR5X2x3cjEsIHhlbmQgPSBjb29yZHhfbHdyMSwgeWVuZCA9IGNvb3JkeV91cHIxLCAKICAgICAgICAgICBsaW5ld2lkdGggPSAwLjQsIGNvbG9yID0gdXBwZXJfY29sb3IpICsgICMgTGVmdCBsaW5lCiAgYW5ub3RhdGUoInNlZ21lbnQiLCB4ID0gY29vcmR4X3VwcjEsIHkgPSBjb29yZHlfbHdyMSwgeGVuZCA9IGNvb3JkeF91cHIxLCB5ZW5kID0gY29vcmR5X3VwcjEsIAogICAgICAgICAgIGxpbmV3aWR0aCA9IDAuNCwgY29sb3IgPSB1cHBlcl9jb2xvcikgKyAgIyBSaWdodCBsaW5lCiAgYW5ub3RhdGUoInNlZ21lbnQiLCB4ID0gY29vcmR4X2x3cjIsIHkgPSBjb29yZHlfbHdyMiwgeGVuZCA9IGNvb3JkeF91cHIyLCB5ZW5kID0gY29vcmR5X2x3cjIsIAogICAgICAgICAgIGxpbmV3aWR0aCA9IDAuNCwgY29sb3IgPSBsb3dlcl9jb2xvcikgKyAgCiAgYW5ub3RhdGUoInNlZ21lbnQiLCB4ID0gY29vcmR4X2x3cjIsIHkgPSBjb29yZHlfdXByMiwgeGVuZCA9IGNvb3JkeF91cHIyLCB5ZW5kID0gY29vcmR5X3VwcjIsIAogICAgICAgICAgIGxpbmV3aWR0aCA9IDAuNCwgY29sb3IgPSBsb3dlcl9jb2xvcikgKyAgCiAgYW5ub3RhdGUoInNlZ21lbnQiLCB4ID0gY29vcmR4X2x3cjIsIHkgPSBjb29yZHlfbHdyMiwgeGVuZCA9IGNvb3JkeF9sd3IyLCB5ZW5kID0gY29vcmR5X3VwcjIsIAogICAgICAgICAgIGxpbmV3aWR0aCA9IDAuNCwgY29sb3IgPSBsb3dlcl9jb2xvcikgKyAgCiAgYW5ub3RhdGUoInNlZ21lbnQiLCB4ID0gY29vcmR4X3VwcjIsIHkgPSBjb29yZHlfbHdyMiwgeGVuZCA9IGNvb3JkeF91cHIyLCB5ZW5kID0gY29vcmR5X3VwcjIsIAogICAgICAgICAgIGxpbmV3aWR0aCA9IDAuNCwgY29sb3IgPSBsb3dlcl9jb2xvcikKZzEzIDwtIGdyYXBoJHBsb3QoZGF0YSA9ICJ5IiwgdmVydGV4X3NpemUgPSAwLCBwID0gZjEzLCBlZGdlX3dpZHRoID0gMCwgZGF0YV9zaXplID0gMSkgKyAKICBsYWJzKGNvbG9yID0gIiIsIHggPSAiIiwgeSA9ICIiKSArIAogIGFubm90YXRlKCJzZWdtZW50IiwgeCA9IGNvb3JkeF9sd3IxLCB5ID0gY29vcmR5X2x3cjEsIHhlbmQgPSBjb29yZHhfdXByMSwgeWVuZCA9IGNvb3JkeV9sd3IxLCAKICAgICAgICAgICBsaW5ld2lkdGggPSAwLjQsIGNvbG9yID0gdXBwZXJfY29sb3IpICsgICMgQm90dG9tIGxpbmUKICBhbm5vdGF0ZSgic2VnbWVudCIsIHggPSBjb29yZHhfbHdyMSwgeSA9IGNvb3JkeV91cHIxLCB4ZW5kID0gY29vcmR4X3VwcjEsIHllbmQgPSBjb29yZHlfdXByMSwgCiAgICAgICAgICAgbGluZXdpZHRoID0gMC40LCBjb2xvciA9IHVwcGVyX2NvbG9yKSArICAjIFRvcCBsaW5lCiAgYW5ub3RhdGUoInNlZ21lbnQiLCB4ID0gY29vcmR4X2x3cjEsIHkgPSBjb29yZHlfbHdyMSwgeGVuZCA9IGNvb3JkeF9sd3IxLCB5ZW5kID0gY29vcmR5X3VwcjEsIAogICAgICAgICAgIGxpbmV3aWR0aCA9IDAuNCwgY29sb3IgPSB1cHBlcl9jb2xvcikgKyAgIyBMZWZ0IGxpbmUKICBhbm5vdGF0ZSgic2VnbWVudCIsIHggPSBjb29yZHhfdXByMSwgeSA9IGNvb3JkeV9sd3IxLCB4ZW5kID0gY29vcmR4X3VwcjEsIHllbmQgPSBjb29yZHlfdXByMSwgCiAgICAgICAgICAgbGluZXdpZHRoID0gMC40LCBjb2xvciA9IHVwcGVyX2NvbG9yKSArICAjIFJpZ2h0IGxpbmUKICBhbm5vdGF0ZSgic2VnbWVudCIsIHggPSBjb29yZHhfbHdyMiwgeSA9IGNvb3JkeV9sd3IyLCB4ZW5kID0gY29vcmR4X3VwcjIsIHllbmQgPSBjb29yZHlfbHdyMiwgCiAgICAgICAgICAgbGluZXdpZHRoID0gMC40LCBjb2xvciA9IGxvd2VyX2NvbG9yKSArICAKICBhbm5vdGF0ZSgic2VnbWVudCIsIHggPSBjb29yZHhfbHdyMiwgeSA9IGNvb3JkeV91cHIyLCB4ZW5kID0gY29vcmR4X3VwcjIsIHllbmQgPSBjb29yZHlfdXByMiwgCiAgICAgICAgICAgbGluZXdpZHRoID0gMC40LCBjb2xvciA9IGxvd2VyX2NvbG9yKSArICAKICBhbm5vdGF0ZSgic2VnbWVudCIsIHggPSBjb29yZHhfbHdyMiwgeSA9IGNvb3JkeV9sd3IyLCB4ZW5kID0gY29vcmR4X2x3cjIsIHllbmQgPSBjb29yZHlfdXByMiwgCiAgICAgICAgICAgbGluZXdpZHRoID0gMC40LCBjb2xvciA9IGxvd2VyX2NvbG9yKSArICAKICBhbm5vdGF0ZSgic2VnbWVudCIsIHggPSBjb29yZHhfdXByMiwgeSA9IGNvb3JkeV9sd3IyLCB4ZW5kID0gY29vcmR4X3VwcjIsIHllbmQgPSBjb29yZHlfdXByMiwgCiAgICAgICAgICAgbGluZXdpZHRoID0gMC40LCBjb2xvciA9IGxvd2VyX2NvbG9yKSAKCnIxIDwtIGcxMyArIHhsaW0oY29vcmR4X2x3cjEsIGNvb3JkeF91cHIxKSArIAogICAgICAgICAgICAgICAgICAgIHlsaW0oY29vcmR5X2x3cjEsIGNvb3JkeV91cHIxKSArIAogIHRoZW1lKGxlZ2VuZC5wb3NpdGlvbiA9ICJub25lIiwgCiAgICAgICAgcGxvdC5tYXJnaW4gPSB1bml0KC0wLjIqYygxLDEsMSwxKSwgImNtIikpCgpyMiA8LSBnMTMgKyB4bGltKGNvb3JkeF9sd3IyLCBjb29yZHhfdXByMikgKyAKICAgICAgICAgICAgICAgICAgICB5bGltKGNvb3JkeV9sd3IyLCBjb29yZHlfdXByMikgKyAKICB0aGVtZShsZWdlbmQucG9zaXRpb24gPSAibm9uZSIsIAogICAgICAgIHBsb3QubWFyZ2luID0gdW5pdCgtMC4yKmMoMSwxLDEsMSksICJjbSIpKQoKIyBBcnJhbmdlIHAyIGFuZCBwMyBob3Jpem9udGFsbHkKbGVmdF9jb2wgPC0gcGxvdF9ncmlkKHIyLCByMSwgbGFiZWxzID0gTlVMTCwgbmNvbCA9IDEsIG5yb3cgPSAyLCByZWxfaGVpZ2h0cyA9IGMoMSwxKSkKCiMgQ29tYmluZSB0aGUgdG9wIHJvdyB3aXRoIHAxIGluIGEgZ3JpZApjb21iaW5lZF9wbG90IDwtIHBsb3RfZ3JpZChsZWZ0X2NvbCwgZzEyLCBsYWJlbHMgPSBOVUxMLCBuY29sID0gMiwgcmVsX3dpZHRocyA9IGMoMSwyKSkgCmZpbmFsX3Bsb3QgPC0gYW5ub3RhdGVfZmlndXJlKGNvbWJpbmVkX3Bsb3QsIGxlZnQgPSB0ZXh0R3JvYigiTGF0aXR1ZGUiLCByb3QgPSA5MCwgdmp1c3QgPSAxLCBncCA9IGdwYXIoY2V4ID0gMC44KSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvdHRvbSA9IHRleHRHcm9iKCJMb25naXR1ZGUiLCB2anVzdCA9IC0wLjUsIGdwID0gZ3BhcihjZXggPSAwLjgpKSkKZ2dzYXZlKGhlcmUoImRhdGFfZmlsZXMvc3RhbmRfbG9nX3NpZ21hXzMucG5nIiksIHdpZHRoID0gMTEuMiwgaGVpZ2h0ID0gNS40MywgcGxvdCA9IGZpbmFsX3Bsb3QsIGRwaSA9IDUwMCkKIyBQcmludCB0aGUgY29tYmluZWQgcGxvdApwcmludChmaW5hbF9wbG90KQpgYGAKCldlIHJlcGVhdCB0aGUgc2FtZSBwcm9jZXNzICBidXQgbm93IGZvciBgWV9tZWFuYC4gV2UgZmlyc3QgYWRkIHRoZSBvYnNlcnZhdGlvbnMgdG8gdGhlIGdyYXBoLgoKYGBge3J9CmdyYXBoJGFkZF9vYnNlcnZhdGlvbnMoZGF0YSA9IGRhdGEuZnJhbWUoeSA9IFlfbWVhbiwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWRnZV9udW1iZXIgPSBQdEVbLDFdLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXN0YW5jZV9vbl9lZGdlID0gUHRFWywyXSksCiAgICAgICAgICAgICAgICAgICAgICAgbm9ybWFsaXplZCA9IFRSVUUsIAogICAgICAgICAgICAgICAgICAgICAgIGNsZWFyX29icyA9IFRSVUUpCmBgYAoKV2UgZml0IHRoZSBtb2RlbCAkXG1hdGhybXttZWFufShzX2kpXHNpbSBOKFxiZXRhXzArdShzX2kpLCBcc2lnbWFfZV4yKSQuCgoKPGRpdiBzdHlsZT0iY29sb3I6IGJsdWU7Ij4KKioqKioqKioKKipQcmVzcyB0aGUgU2hvdyBidXR0b24gYmVsb3cgdG8gcmV2ZWFsIHRoZSBjb2RlLioqCgoqKioqKioqKgo8L2Rpdj4KCmBgYHtyLCBjbGFzcy5zb3VyY2UgPSAiZm9sZC1oaWRlIn0KIyBCdWlsZCB0aGUgbW9kZWwKcnNwZGVfbW9kZWxfc3RhdCA8LSByc3BkZS5tZXRyaWNfZ3JhcGgoZ3JhcGgsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtZXRlcml6YXRpb24gPSAic3BkZSIpCiMgUHJlcGFyZSB0aGUgZGF0YSBmb3IgZml0dGluZwpkYXRhX3JzcGRlX2JydV9zdGF0IDwtIGdyYXBoX2RhdGFfcnNwZGUocnNwZGVfbW9kZWxfc3RhdCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY19uYW1lID0gImxvYyIpCiMgRGVmaW5lIHRoZSBjb21wb25lbnQKY21wX3N0YXQgPC0geSB+IC0xICsKICBJbnRlcmNlcHQoMSkgKwogIGZpZWxkKGxvYywgbW9kZWwgPSByc3BkZV9tb2RlbF9zdGF0KQojIEZpdCB0aGUgbW9kZWwKcnNwZGVfZml0X3N0YXQgPC0KICBicnUoY21wX3N0YXQsCiAgICAgIGRhdGEgPSBkYXRhX3JzcGRlX2JydV9zdGF0W1siZGF0YSJdXSwKICAgICAgZmFtaWx5ID0gImdhdXNzaWFuIiwKICAgICAgb3B0aW9ucyA9IGxpc3QodmVyYm9zZSA9IEZBTFNFKQogICkKIyBTdW1tYXJpemUgdGhlIHJlc3VsdHMKc3VtbWFyeShyc3BkZV9maXRfc3RhdCkKZ2V0c19zdW1tYXJ5X3BhcmFtZXRlcnMocnNwZGVfZml0X3N0YXQsIHJzcGRlX21vZGVsX3N0YXQpCmBgYAoKCkJlbG93IHdlIGNvbXB1dGUgdGhlIHByZWRpY3Rpb25zIGZvciB0aGUgbWVzaCBhbmQgdGhlIGRhdGEgbG9jYXRpb24uCgpgYGB7cn0KbWVhbl9vbl9tZXNoX3ByZWQgPC0gcHJlZGljdChyc3BkZV9tb2RlbF9zdGF0LCBjbXBfc3RhdCwgcnNwZGVfZml0X3N0YXQsIG5ld2RhdGEgPSBkYXRhX3ByZF9saXN0X21lc2gsIH5JbnRlcmNlcHQgKyBmaWVsZCkKY292X2Zvcl9tZWFuX3RvX3Bsb3QgPC0gbWVhbl9vbl9tZXNoX3ByZWQkcHJlZCRtZWFuCgptZWFuX29uX2xvY19wcmVkIDwtIHByZWRpY3QocnNwZGVfbW9kZWxfc3RhdCwgY21wX3N0YXQsIHJzcGRlX2ZpdF9zdGF0LCBuZXdkYXRhID0gbGlzdChsb2MgPSBQdEUpLCB+SW50ZXJjZXB0ICsgZmllbGQpCmNvdl9mb3JfbWVhbiA8LSBtZWFuX29uX2xvY19wcmVkJHByZWQkbWVhbgpgYGAKCkJlbG93IHdlIGNoZWNrIHRoYXQgdGhlIHByZWRpY3RlZCBtZWFuIGlzIGNsb3NlIHRvIHRoZSBvYnNlcnZlZCBtZWFuLgoKYGBge3IsIGZpZy53aWR0aCA9IDI0LCBmaWcuaGVpZ2h0ID0gNCwgZmlnLmNhcCA9IGNhcHRpb25lcigiUHJlZGljdGVkIG1lYW4gYW5kIG9ic2VydmVkIG1lYW4uIil9CnBsb3QoWV9tZWFuLCB0eXBlID0gImwiLCBjb2wgPSAiZGFya2JsdWUiKQpsaW5lcyhjb3ZfZm9yX21lYW4sIGNvbCA9ICJkYXJrcmVkIikKYGBgCgpCZWxvdyB3ZSBwbG90IHRoZSByZXN1bHRzIGFzIHdlIGRpZCBiZWZvcmUuCgoKPGRpdiBzdHlsZT0iY29sb3I6IGJsdWU7Ij4KKioqKioqKioKKipQcmVzcyB0aGUgU2hvdyBidXR0b24gYmVsb3cgdG8gcmV2ZWFsIHRoZSBjb2RlLioqCgoqKioqKioqKgo8L2Rpdj4KCmBgYHtyLCBmaWcud2lkdGggPSAxMS4yLCBmaWcuaGVpZ2h0ID0gNS40MywgY2xhc3Muc291cmNlID0gImZvbGQtaGlkZSIsIGZpZy5jYXAgPSBjYXB0aW9uZXIoIkF2ZXJhZ2Ugc3BlZWRzIG9mIHRoZSBmaXJzdCBwYXJ0IG9mIHRoZSBkYXRhLiBQb2ludHMgcmVwcmVzZW50IHRoZSBwb2ludCB2YWx1ZSBhdCBlYWNoIGF2YWlsYWJsZSBsb2NhdGlvbiwgYW5kIGVkZ2VzIHJlcHJlc2VudCB0aGUgJFxcbWF0aHJte21lYW4uY292fShzKSQgY292YXJpYXRlLiIpfQojIFBsb3QgdGhlIGZpZWxkIG9uIHRvcCBvZiB0aGUgbWFwCmYxMiA8LSBncmFwaCRwbG90X2Z1bmN0aW9uKFggPSBjb3ZfZm9yX21lYW5fdG9fcGxvdCwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgdmVydGV4X3NpemUgPSAwLCAKICAgICAgICAgICAgICAgICAgICAgICAgICBwID0gcDEyLAogICAgICAgICAgICAgICAgICAgICAgICAgIGVkZ2Vfd2lkdGggPSAwLjUpICsgCiAgdGhlbWVfbWluaW1hbCgpICsgCiAgdGhlbWUodGV4dCA9IGVsZW1lbnRfdGV4dChmYW1pbHkgPSAiUGFsYXRpbm8iKSwgCiAgICAgICAgYXhpcy50ZXh0ID0gZWxlbWVudF90ZXh0KHNpemUgPSA4KSwKICAgICAgICBsZWdlbmQudGV4dCA9IGVsZW1lbnRfdGV4dChzaXplID0gOCksCiAgICAgICAgcGxvdC5tYXJnaW4gPSB1bml0KC0wLjQqYygxLDAsMSwxKSwgImNtIikKICAgICAgICApICsKICBsYWJzKGNvbG9yID0gIiIsIHggPSAiIiwgeSA9ICIiKSArCiAgeGxpbSh4X2xlZnQsIHhfcmlnaHQpICsgCiAgeWxpbSh5X2JvdHRvbSwgeV90b3ApCiMgUGxvdCB0aGUgZmllbGQgb24gdG9wIG9mIHRoZSBtYXAKZjEzIDwtIGdyYXBoJHBsb3RfZnVuY3Rpb24oWCA9IGNvdl9mb3JfbWVhbl90b19wbG90LCAKICAgICAgICAgICAgICAgICAgICAgICAgICB2ZXJ0ZXhfc2l6ZSA9IDAsIAogICAgICAgICAgICAgICAgICAgICAgICAgIHAgPSBwMTMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgZWRnZV93aWR0aCA9IDAuNSkgKyAKICB0aGVtZV9taW5pbWFsKCkgKyAKICB0aGVtZSh0ZXh0ID0gZWxlbWVudF90ZXh0KGZhbWlseSA9ICJQYWxhdGlubyIpLCAKICAgICAgICBheGlzLnRleHQgPSBlbGVtZW50X3RleHQoc2l6ZSA9IDgpLAogICAgICAgIGxlZ2VuZC50ZXh0ID0gZWxlbWVudF90ZXh0KHNpemUgPSA4KSwKICAgICAgICBwbG90Lm1hcmdpbiA9IHVuaXQoLTAuNCpjKDEsMCwxLDEpLCAiY20iKQogICAgICAgICkgKwogIGxhYnMoY29sb3IgPSAiIiwgeCA9ICIiLCB5ID0gIiIpICsKICB4bGltKHhfbGVmdCwgeF9yaWdodCkgKyAKICB5bGltKHlfYm90dG9tLCB5X3RvcCkKCmcxMiA8LSBncmFwaCRwbG90KGRhdGEgPSAieSIsIHZlcnRleF9zaXplID0gMCwgcCA9IGYxMiwgZWRnZV93aWR0aCA9IDAsIGRhdGFfc2l6ZSA9IDEpICsgCiAgbGFicyhjb2xvciA9ICIiLCB4ID0gIiIsIHkgPSAiIikgKyAKICBhbm5vdGF0ZSgic2VnbWVudCIsIHggPSBjb29yZHhfbHdyMSwgeSA9IGNvb3JkeV9sd3IxLCB4ZW5kID0gY29vcmR4X3VwcjEsIHllbmQgPSBjb29yZHlfbHdyMSwgCiAgICAgICAgICAgbGluZXdpZHRoID0gMC40LCBjb2xvciA9IHVwcGVyX2NvbG9yKSArICAjIEJvdHRvbSBsaW5lCiAgYW5ub3RhdGUoInNlZ21lbnQiLCB4ID0gY29vcmR4X2x3cjEsIHkgPSBjb29yZHlfdXByMSwgeGVuZCA9IGNvb3JkeF91cHIxLCB5ZW5kID0gY29vcmR5X3VwcjEsIAogICAgICAgICAgIGxpbmV3aWR0aCA9IDAuNCwgY29sb3IgPSB1cHBlcl9jb2xvcikgKyAgIyBUb3AgbGluZQogIGFubm90YXRlKCJzZWdtZW50IiwgeCA9IGNvb3JkeF9sd3IxLCB5ID0gY29vcmR5X2x3cjEsIHhlbmQgPSBjb29yZHhfbHdyMSwgeWVuZCA9IGNvb3JkeV91cHIxLCAKICAgICAgICAgICBsaW5ld2lkdGggPSAwLjQsIGNvbG9yID0gdXBwZXJfY29sb3IpICsgICMgTGVmdCBsaW5lCiAgYW5ub3RhdGUoInNlZ21lbnQiLCB4ID0gY29vcmR4X3VwcjEsIHkgPSBjb29yZHlfbHdyMSwgeGVuZCA9IGNvb3JkeF91cHIxLCB5ZW5kID0gY29vcmR5X3VwcjEsIAogICAgICAgICAgIGxpbmV3aWR0aCA9IDAuNCwgY29sb3IgPSB1cHBlcl9jb2xvcikgKyAgIyBSaWdodCBsaW5lCiAgYW5ub3RhdGUoInNlZ21lbnQiLCB4ID0gY29vcmR4X2x3cjIsIHkgPSBjb29yZHlfbHdyMiwgeGVuZCA9IGNvb3JkeF91cHIyLCB5ZW5kID0gY29vcmR5X2x3cjIsIAogICAgICAgICAgIGxpbmV3aWR0aCA9IDAuNCwgY29sb3IgPSBsb3dlcl9jb2xvcikgKyAgCiAgYW5ub3RhdGUoInNlZ21lbnQiLCB4ID0gY29vcmR4X2x3cjIsIHkgPSBjb29yZHlfdXByMiwgeGVuZCA9IGNvb3JkeF91cHIyLCB5ZW5kID0gY29vcmR5X3VwcjIsIAogICAgICAgICAgIGxpbmV3aWR0aCA9IDAuNCwgY29sb3IgPSBsb3dlcl9jb2xvcikgKyAgCiAgYW5ub3RhdGUoInNlZ21lbnQiLCB4ID0gY29vcmR4X2x3cjIsIHkgPSBjb29yZHlfbHdyMiwgeGVuZCA9IGNvb3JkeF9sd3IyLCB5ZW5kID0gY29vcmR5X3VwcjIsIAogICAgICAgICAgIGxpbmV3aWR0aCA9IDAuNCwgY29sb3IgPSBsb3dlcl9jb2xvcikgKyAgCiAgYW5ub3RhdGUoInNlZ21lbnQiLCB4ID0gY29vcmR4X3VwcjIsIHkgPSBjb29yZHlfbHdyMiwgeGVuZCA9IGNvb3JkeF91cHIyLCB5ZW5kID0gY29vcmR5X3VwcjIsIAogICAgICAgICAgIGxpbmV3aWR0aCA9IDAuNCwgY29sb3IgPSBsb3dlcl9jb2xvcikKZzEzIDwtIGdyYXBoJHBsb3QoZGF0YSA9ICJ5IiwgdmVydGV4X3NpemUgPSAwLCBwID0gZjEzLCBlZGdlX3dpZHRoID0gMCwgZGF0YV9zaXplID0gMSkgKyAKICBsYWJzKGNvbG9yID0gIiIsIHggPSAiIiwgeSA9ICIiKSArIAogIGFubm90YXRlKCJzZWdtZW50IiwgeCA9IGNvb3JkeF9sd3IxLCB5ID0gY29vcmR5X2x3cjEsIHhlbmQgPSBjb29yZHhfdXByMSwgeWVuZCA9IGNvb3JkeV9sd3IxLCAKICAgICAgICAgICBsaW5ld2lkdGggPSAwLjQsIGNvbG9yID0gdXBwZXJfY29sb3IpICsgICMgQm90dG9tIGxpbmUKICBhbm5vdGF0ZSgic2VnbWVudCIsIHggPSBjb29yZHhfbHdyMSwgeSA9IGNvb3JkeV91cHIxLCB4ZW5kID0gY29vcmR4X3VwcjEsIHllbmQgPSBjb29yZHlfdXByMSwgCiAgICAgICAgICAgbGluZXdpZHRoID0gMC40LCBjb2xvciA9IHVwcGVyX2NvbG9yKSArICAjIFRvcCBsaW5lCiAgYW5ub3RhdGUoInNlZ21lbnQiLCB4ID0gY29vcmR4X2x3cjEsIHkgPSBjb29yZHlfbHdyMSwgeGVuZCA9IGNvb3JkeF9sd3IxLCB5ZW5kID0gY29vcmR5X3VwcjEsIAogICAgICAgICAgIGxpbmV3aWR0aCA9IDAuNCwgY29sb3IgPSB1cHBlcl9jb2xvcikgKyAgIyBMZWZ0IGxpbmUKICBhbm5vdGF0ZSgic2VnbWVudCIsIHggPSBjb29yZHhfdXByMSwgeSA9IGNvb3JkeV9sd3IxLCB4ZW5kID0gY29vcmR4X3VwcjEsIHllbmQgPSBjb29yZHlfdXByMSwgCiAgICAgICAgICAgbGluZXdpZHRoID0gMC40LCBjb2xvciA9IHVwcGVyX2NvbG9yKSArICAjIFJpZ2h0IGxpbmUKICBhbm5vdGF0ZSgic2VnbWVudCIsIHggPSBjb29yZHhfbHdyMiwgeSA9IGNvb3JkeV9sd3IyLCB4ZW5kID0gY29vcmR4X3VwcjIsIHllbmQgPSBjb29yZHlfbHdyMiwgCiAgICAgICAgICAgbGluZXdpZHRoID0gMC40LCBjb2xvciA9IGxvd2VyX2NvbG9yKSArICAKICBhbm5vdGF0ZSgic2VnbWVudCIsIHggPSBjb29yZHhfbHdyMiwgeSA9IGNvb3JkeV91cHIyLCB4ZW5kID0gY29vcmR4X3VwcjIsIHllbmQgPSBjb29yZHlfdXByMiwgCiAgICAgICAgICAgbGluZXdpZHRoID0gMC40LCBjb2xvciA9IGxvd2VyX2NvbG9yKSArICAKICBhbm5vdGF0ZSgic2VnbWVudCIsIHggPSBjb29yZHhfbHdyMiwgeSA9IGNvb3JkeV9sd3IyLCB4ZW5kID0gY29vcmR4X2x3cjIsIHllbmQgPSBjb29yZHlfdXByMiwgCiAgICAgICAgICAgbGluZXdpZHRoID0gMC40LCBjb2xvciA9IGxvd2VyX2NvbG9yKSArICAKICBhbm5vdGF0ZSgic2VnbWVudCIsIHggPSBjb29yZHhfdXByMiwgeSA9IGNvb3JkeV9sd3IyLCB4ZW5kID0gY29vcmR4X3VwcjIsIHllbmQgPSBjb29yZHlfdXByMiwgCiAgICAgICAgICAgbGluZXdpZHRoID0gMC40LCBjb2xvciA9IGxvd2VyX2NvbG9yKSAKCnIxIDwtIGcxMyArIHhsaW0oY29vcmR4X2x3cjEsIGNvb3JkeF91cHIxKSArIAogICAgICAgICAgICAgICAgICAgIHlsaW0oY29vcmR5X2x3cjEsIGNvb3JkeV91cHIxKSArIAogIHRoZW1lKGxlZ2VuZC5wb3NpdGlvbiA9ICJub25lIiwgCiAgICAgICAgcGxvdC5tYXJnaW4gPSB1bml0KC0wLjIqYygxLDEsMSwxKSwgImNtIikpCgpyMiA8LSBnMTMgKyB4bGltKGNvb3JkeF9sd3IyLCBjb29yZHhfdXByMikgKyAKICAgICAgICAgICAgICAgICAgICB5bGltKGNvb3JkeV9sd3IyLCBjb29yZHlfdXByMikgKyAKICB0aGVtZShsZWdlbmQucG9zaXRpb24gPSAibm9uZSIsIAogICAgICAgIHBsb3QubWFyZ2luID0gdW5pdCgtMC4yKmMoMSwxLDEsMSksICJjbSIpKQoKIyBBcnJhbmdlIHAyIGFuZCBwMyBob3Jpem9udGFsbHkKbGVmdF9jb2wgPC0gcGxvdF9ncmlkKHIyLCByMSwgbGFiZWxzID0gTlVMTCwgbmNvbCA9IDEsIG5yb3cgPSAyLCByZWxfaGVpZ2h0cyA9IGMoMSwxKSkKCiMgQ29tYmluZSB0aGUgdG9wIHJvdyB3aXRoIHAxIGluIGEgZ3JpZApjb21iaW5lZF9wbG90IDwtIHBsb3RfZ3JpZChsZWZ0X2NvbCwgZzEyLCBsYWJlbHMgPSBOVUxMLCBuY29sID0gMiwgcmVsX3dpZHRocyA9IGMoMSwyKSkgCmZpbmFsX3Bsb3QgPC0gYW5ub3RhdGVfZmlndXJlKGNvbWJpbmVkX3Bsb3QsIGxlZnQgPSB0ZXh0R3JvYigiTGF0aXR1ZGUiLCByb3QgPSA5MCwgdmp1c3QgPSAxLCBncCA9IGdwYXIoY2V4ID0gMC44KSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvdHRvbSA9IHRleHRHcm9iKCJMb25naXR1ZGUiLCB2anVzdCA9IC0wLjUsIGdwID0gZ3BhcihjZXggPSAwLjgpKSkKZ2dzYXZlKGhlcmUoImRhdGFfZmlsZXMvbWVhbl9iZXR0ZXJfMy5wbmciKSwgd2lkdGggPSAxMS4yLCBoZWlnaHQgPSA1LjQzLCBwbG90ID0gZmluYWxfcGxvdCwgZHBpID0gNTAwKQojIFByaW50IHRoZSBjb21iaW5lZCBwbG90CnByaW50KGZpbmFsX3Bsb3QpCmBgYAoKV2UgZmluYWxseSBhZGQgdGhlIHJlbWFpbmluZyBoYWxmIG9mIHRoZSByZXBsaWNhdGVzIHRvIHRoZSBncmFwaCBhbmQgcGxvdCBvbmUgb2YgdGhlbS4KCmBgYHtyfQpkZl9yZXAgPC0gbGFwcGx5KDE6bnJvdyhZKSwgZnVuY3Rpb24oaSl7ZGF0YS5mcmFtZSh5ID0gWVtpLF0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lYW5fdmFsdWUgPSBjb3ZfZm9yX21lYW4sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVkZ2VfbnVtYmVyID0gUHRFWywxXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzdGFuY2Vfb25fZWRnZSA9IFB0RVssMl0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcGwgPSBpKX0pCmRmX3JlcCA8LSBkby5jYWxsKHJiaW5kLCBkZl9yZXApCgpncmFwaCRhZGRfb2JzZXJ2YXRpb25zKGRhdGEgPSBkZl9yZXAsIG5vcm1hbGl6ZWQgPSBUUlVFLCBjbGVhcl9vYnMgPSBUUlVFLCBncm91cCA9ICJyZXBsIikKYGBgCgpCZWxvdyB3ZSBwbG90IHJlcGxpY2F0ZSAxNC4KCjxkaXYgc3R5bGU9ImNvbG9yOiBibHVlOyI+CioqKioqKioqCioqUHJlc3MgdGhlIFNob3cgYnV0dG9uIGJlbG93IHRvIHJldmVhbCB0aGUgY29kZS4qKgoKKioqKioqKioKPC9kaXY+CgpgYGB7ciwgZmlnLndpZHRoID0gMTEuMiwgZmlnLmhlaWdodCA9IDUuNDMsIGNsYXNzLnNvdXJjZSA9ICJmb2xkLWhpZGUiLCBmaWcuY2FwID0gY2FwdGlvbmVyKCJTcGVlZCBvYnNlcnZhdGlvbnMgKGluIG1waCkgb24gdGhlIGhpZ2h3YXkgbmV0d29yayBvZiB0aGUgY2l0eSBvZiBTYW4gSm9zZSBpbiBDYWxpZm9ybmlhLCByZWNvcmRlZCBvbiBBcHJpbCAzLCAyMDE3LiBUaGUgbGVmdCBwYW5lbHMgYXJlIHpvb21lZC1pbiBhcmVhcyBvZiB0aGUgcGFuZWwgdG8gdGhlIHJpZ2h0LiIpfQpnMTIgPC0gZ3JhcGgkcGxvdChkYXRhID0gInkiLCAKICAgICAgICAgICAgICAgICBwID0gcDEyLAogICAgICAgICAgICAgICAgIGdyb3VwID0gMSwgCiAgICAgICAgICAgICAgICAgdmVydGV4X3NpemUgPSAwLCAKICAgICAgICAgICAgICAgICBkYXRhX3NpemUgPSAxKSArIAogIHRoZW1lX21pbmltYWwoKSArIAogIHRoZW1lKHRleHQgPSBlbGVtZW50X3RleHQoZmFtaWx5ID0gIlBhbGF0aW5vIiksIAogICAgICAgIGF4aXMudGV4dCA9IGVsZW1lbnRfdGV4dChzaXplID0gOCksCiAgICAgICAgbGVnZW5kLnRleHQgPSBlbGVtZW50X3RleHQoc2l6ZSA9IDgpLAogICAgICAgIHBsb3QubWFyZ2luID0gdW5pdCgtMC40KmMoMSwwLDEsMSksICJjbSIpKSArCiAgbGFicyhjb2xvciA9ICIiLCB4ID0gIiIsIHkgPSAiIikgKwogIHhsaW0oeF9sZWZ0LCB4X3JpZ2h0KSArIAogIHlsaW0oeV9ib3R0b20sIHlfdG9wKSArCiAgYW5ub3RhdGUoInNlZ21lbnQiLCB4ID0gY29vcmR4X2x3cjEsIHkgPSBjb29yZHlfbHdyMSwgeGVuZCA9IGNvb3JkeF91cHIxLCB5ZW5kID0gY29vcmR5X2x3cjEsIAogICAgICAgICAgIGxpbmV3aWR0aCA9IDAuNCwgY29sb3IgPSB1cHBlcl9jb2xvcikgKyAgIyBCb3R0b20gbGluZQogIGFubm90YXRlKCJzZWdtZW50IiwgeCA9IGNvb3JkeF9sd3IxLCB5ID0gY29vcmR5X3VwcjEsIHhlbmQgPSBjb29yZHhfdXByMSwgeWVuZCA9IGNvb3JkeV91cHIxLCAKICAgICAgICAgICBsaW5ld2lkdGggPSAwLjQsIGNvbG9yID0gdXBwZXJfY29sb3IpICsgICMgVG9wIGxpbmUKICBhbm5vdGF0ZSgic2VnbWVudCIsIHggPSBjb29yZHhfbHdyMSwgeSA9IGNvb3JkeV9sd3IxLCB4ZW5kID0gY29vcmR4X2x3cjEsIHllbmQgPSBjb29yZHlfdXByMSwgCiAgICAgICAgICAgbGluZXdpZHRoID0gMC40LCBjb2xvciA9IHVwcGVyX2NvbG9yKSArICAjIExlZnQgbGluZQogIGFubm90YXRlKCJzZWdtZW50IiwgeCA9IGNvb3JkeF91cHIxLCB5ID0gY29vcmR5X2x3cjEsIHhlbmQgPSBjb29yZHhfdXByMSwgeWVuZCA9IGNvb3JkeV91cHIxLCAKICAgICAgICAgICBsaW5ld2lkdGggPSAwLjQsIGNvbG9yID0gdXBwZXJfY29sb3IpICsgICMgUmlnaHQgbGluZQogIGFubm90YXRlKCJzZWdtZW50IiwgeCA9IGNvb3JkeF9sd3IyLCB5ID0gY29vcmR5X2x3cjIsIHhlbmQgPSBjb29yZHhfdXByMiwgeWVuZCA9IGNvb3JkeV9sd3IyLCAKICAgICAgICAgICBsaW5ld2lkdGggPSAwLjQsIGNvbG9yID0gbG93ZXJfY29sb3IpICsgIAogIGFubm90YXRlKCJzZWdtZW50IiwgeCA9IGNvb3JkeF9sd3IyLCB5ID0gY29vcmR5X3VwcjIsIHhlbmQgPSBjb29yZHhfdXByMiwgeWVuZCA9IGNvb3JkeV91cHIyLCAKICAgICAgICAgICBsaW5ld2lkdGggPSAwLjQsIGNvbG9yID0gbG93ZXJfY29sb3IpICsgIAogIGFubm90YXRlKCJzZWdtZW50IiwgeCA9IGNvb3JkeF9sd3IyLCB5ID0gY29vcmR5X2x3cjIsIHhlbmQgPSBjb29yZHhfbHdyMiwgeWVuZCA9IGNvb3JkeV91cHIyLCAKICAgICAgICAgICBsaW5ld2lkdGggPSAwLjQsIGNvbG9yID0gbG93ZXJfY29sb3IpICsgIAogIGFubm90YXRlKCJzZWdtZW50IiwgeCA9IGNvb3JkeF91cHIyLCB5ID0gY29vcmR5X2x3cjIsIHhlbmQgPSBjb29yZHhfdXByMiwgeWVuZCA9IGNvb3JkeV91cHIyLCAKICAgICAgICAgICBsaW5ld2lkdGggPSAwLjQsIGNvbG9yID0gbG93ZXJfY29sb3IpCgpnMTMgPC0gZ3JhcGgkcGxvdChkYXRhID0gInkiLCAKICAgICAgICAgICAgICAgICBwID0gcDEzLAogICAgICAgICAgICAgICAgIGdyb3VwID0gMSwgCiAgICAgICAgICAgICAgICAgdmVydGV4X3NpemUgPSAwLCAKICAgICAgICAgICAgICAgICBkYXRhX3NpemUgPSAxKSArIAogIHRoZW1lX21pbmltYWwoKSArIAogIHRoZW1lKHRleHQgPSBlbGVtZW50X3RleHQoZmFtaWx5ID0gIlBhbGF0aW5vIiksIAogICAgICAgIGF4aXMudGV4dCA9IGVsZW1lbnRfdGV4dChzaXplID0gOCksCiAgICAgICAgbGVnZW5kLnRleHQgPSBlbGVtZW50X3RleHQoc2l6ZSA9IDgpLAogICAgICAgIHBsb3QubWFyZ2luID0gdW5pdCgtMC40KmMoMSwwLDEsMSksICJjbSIpKSArCiAgbGFicyhjb2xvciA9ICJzcGVlZCIsIHggPSAiIiwgeSA9ICIiKSArCiAgeGxpbSh4X2xlZnQsIHhfcmlnaHQpICsgCiAgeWxpbSh5X2JvdHRvbSwgeV90b3ApICsKICBhbm5vdGF0ZSgic2VnbWVudCIsIHggPSBjb29yZHhfbHdyMSwgeSA9IGNvb3JkeV9sd3IxLCB4ZW5kID0gY29vcmR4X3VwcjEsIHllbmQgPSBjb29yZHlfbHdyMSwgCiAgICAgICAgICAgbGluZXdpZHRoID0gMC40LCBjb2xvciA9IHVwcGVyX2NvbG9yKSArICAjIEJvdHRvbSBsaW5lCiAgYW5ub3RhdGUoInNlZ21lbnQiLCB4ID0gY29vcmR4X2x3cjEsIHkgPSBjb29yZHlfdXByMSwgeGVuZCA9IGNvb3JkeF91cHIxLCB5ZW5kID0gY29vcmR5X3VwcjEsIAogICAgICAgICAgIGxpbmV3aWR0aCA9IDAuNCwgY29sb3IgPSB1cHBlcl9jb2xvcikgKyAgIyBUb3AgbGluZQogIGFubm90YXRlKCJzZWdtZW50IiwgeCA9IGNvb3JkeF9sd3IxLCB5ID0gY29vcmR5X2x3cjEsIHhlbmQgPSBjb29yZHhfbHdyMSwgeWVuZCA9IGNvb3JkeV91cHIxLCAKICAgICAgICAgICBsaW5ld2lkdGggPSAwLjQsIGNvbG9yID0gdXBwZXJfY29sb3IpICsgICMgTGVmdCBsaW5lCiAgYW5ub3RhdGUoInNlZ21lbnQiLCB4ID0gY29vcmR4X3VwcjEsIHkgPSBjb29yZHlfbHdyMSwgeGVuZCA9IGNvb3JkeF91cHIxLCB5ZW5kID0gY29vcmR5X3VwcjEsIAogICAgICAgICAgIGxpbmV3aWR0aCA9IDAuNCwgY29sb3IgPSB1cHBlcl9jb2xvcikgKyAgIyBSaWdodCBsaW5lCiAgYW5ub3RhdGUoInNlZ21lbnQiLCB4ID0gY29vcmR4X2x3cjIsIHkgPSBjb29yZHlfbHdyMiwgeGVuZCA9IGNvb3JkeF91cHIyLCB5ZW5kID0gY29vcmR5X2x3cjIsIAogICAgICAgICAgIGxpbmV3aWR0aCA9IDAuNCwgY29sb3IgPSBsb3dlcl9jb2xvcikgKyAgCiAgYW5ub3RhdGUoInNlZ21lbnQiLCB4ID0gY29vcmR4X2x3cjIsIHkgPSBjb29yZHlfdXByMiwgeGVuZCA9IGNvb3JkeF91cHIyLCB5ZW5kID0gY29vcmR5X3VwcjIsIAogICAgICAgICAgIGxpbmV3aWR0aCA9IDAuNCwgY29sb3IgPSBsb3dlcl9jb2xvcikgKyAgCiAgYW5ub3RhdGUoInNlZ21lbnQiLCB4ID0gY29vcmR4X2x3cjIsIHkgPSBjb29yZHlfbHdyMiwgeGVuZCA9IGNvb3JkeF9sd3IyLCB5ZW5kID0gY29vcmR5X3VwcjIsIAogICAgICAgICAgIGxpbmV3aWR0aCA9IDAuNCwgY29sb3IgPSBsb3dlcl9jb2xvcikgKyAgCiAgYW5ub3RhdGUoInNlZ21lbnQiLCB4ID0gY29vcmR4X3VwcjIsIHkgPSBjb29yZHlfbHdyMiwgeGVuZCA9IGNvb3JkeF91cHIyLCB5ZW5kID0gY29vcmR5X3VwcjIsIAogICAgICAgICAgIGxpbmV3aWR0aCA9IDAuNCwgY29sb3IgPSBsb3dlcl9jb2xvcikKCnIxIDwtIGcxMyArIHhsaW0oY29vcmR4X2x3cjEsIGNvb3JkeF91cHIxKSArIAogICAgICAgICAgICAgICAgICAgIHlsaW0oY29vcmR5X2x3cjEsIGNvb3JkeV91cHIxKSArIAogIHRoZW1lKGxlZ2VuZC5wb3NpdGlvbiA9ICJub25lIiwgCiAgICAgICAgcGxvdC5tYXJnaW4gPSB1bml0KC0wLjIqYygxLDEsMSwxKSwgImNtIikpCgpyMiA8LSBnMTMgKyB4bGltKGNvb3JkeF9sd3IyLCBjb29yZHhfdXByMikgKyAKICAgICAgICAgICAgICAgICAgICB5bGltKGNvb3JkeV9sd3IyLCBjb29yZHlfdXByMikgKyAKICB0aGVtZShsZWdlbmQucG9zaXRpb24gPSAibm9uZSIsIAogICAgICAgIHBsb3QubWFyZ2luID0gdW5pdCgtMC4yKmMoMSwxLDEsMSksICJjbSIpKQoKIyBBcnJhbmdlIHAyIGFuZCBwMyBob3Jpem9udGFsbHkKbGVmdF9jb2wgPC0gcGxvdF9ncmlkKHIyLCByMSwgbGFiZWxzID0gTlVMTCwgbmNvbCA9IDEsIG5yb3cgPSAyLCByZWxfaGVpZ2h0cyA9IGMoMSwxKSkKCiMgQ29tYmluZSB0aGUgdG9wIHJvdyB3aXRoIHAxIGluIGEgZ3JpZApjb21iaW5lZF9wbG90IDwtIHBsb3RfZ3JpZChsZWZ0X2NvbCwgZzEyLCBsYWJlbHMgPSBOVUxMLCBuY29sID0gMiwgcmVsX3dpZHRocyA9IGMoMSwyKSkgCmZpbmFsX3Bsb3QgPC0gYW5ub3RhdGVfZmlndXJlKGNvbWJpbmVkX3Bsb3QsIGxlZnQgPSB0ZXh0R3JvYigiTGF0aXR1ZGUiLCByb3QgPSA5MCwgdmp1c3QgPSAxLCBncCA9IGdwYXIoY2V4ID0gMC44KSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvdHRvbSA9IHRleHRHcm9iKCJMb25naXR1ZGUiLCB2anVzdCA9IC0wLjUsIGdwID0gZ3BhcihjZXggPSAwLjgpKSkKZ2dzYXZlKGhlcmUoImRhdGFfZmlsZXMvcmVwbGljYXRlMTRfMy5wbmciKSwgd2lkdGggPSAxMS4yLCBoZWlnaHQgPSA1LjQzLCBwbG90ID0gZmluYWxfcGxvdCwgZHBpID0gNTAwKQojIFByaW50IHRoZSBjb21iaW5lZCBwbG90CnByaW50KGZpbmFsX3Bsb3QpCmBgYAoKCmBgYHtyfQpzYXZlKGdyYXBoLCBjb3YsIGNvdl9mb3JfbWVhbl90b19wbG90LCBkYXRhX3ByZF9saXN0X21lc2gsIGZpbGUgPSBoZXJlKCJkYXRhX2ZpbGVzL3BlbXNfcmVwbDFfZGF0YS5SRGF0YSIpKQpgYGAKCiMgUmVmZXJlbmNlcwoKYGBge3J9CmNpdGVfcGFja2FnZXMob3V0cHV0ID0gInBhcmFncmFwaCIsIG91dC5kaXIgPSAiLiIpCmBgYAoKCg==</div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("pems_repl1.Rmd");
  window.initializeCodeFolding("show" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
